{
    "contents" : "# Note: this is only a toy example demonstrating how to program rejection sampling\n# this is not a good sampling scheme for gamma distribution. \n# Do not use it for serious applications that demand high efficiency. \n\n\n#log of a function which is always above the Gamma density function  \n# alpha must be > 2\nlog_g_gamma <- function(x, alpha)\n{\n   (alpha-1) * (log(alpha-1) - 1) - log( 1 + (x-(alpha-1))^2 / (2*alpha-1) )  \n}\n\n## look at the approximating functionn\nxvec <- seq (0, 3, by = 0.0001)\nalpha <- 2.1\nlog_g_gamma_val <- log_g_gamma(xvec, alpha = alpha)\nlog_gamma_val <- dgamma (xvec, shape = alpha, log =T)\nylim <- range (log_g_gamma_val, log_gamma_val, finite = T)\nplot (xvec, log_g_gamma_val, col = \"black\", type = \"l\", ylim = ylim )\npoints (xvec,log_gamma_val, col = \"red\",type = \"l\")\n## note that we see that g isn't above dgamma all the time when alpha < 2\n\n#sampling from Gamma distribution with rejection sampling\nsample_gamma_rej <- function(n,alpha)\n{  sample_gamma <- rep(0,n)\n   no.draw <- 0  \n   for(i in 1:n)\n   {   rejected <- TRUE\n       \n       while(rejected)\n       {  sample_gamma[i] <- rcauchy(1) * sqrt(2*alpha-1) + (alpha -1)\n          no.draw <- no.draw + 1\n          U <- runif(1)\n          rejected <- (log(U) > dgamma(sample_gamma[i],shape=alpha,log=TRUE) - \n\t                            log_g_gamma(sample_gamma[i],alpha) )\n       }\n   }\n   attr(sample_gamma, \"accept.rate\") <- n/no.draw\n   sample_gamma\n}\n\n\n# a test\nalpha <- 4.3\ngammarn <- sample_gamma_rej (2000,alpha); attr (gammarn, \"accept.rate\")\nhist (gammarn)\nqqplot(gammarn, rgamma (2000, alpha))\n## we see that when alpha is larger than 2, the overall acceptance rate is very low\n\n\n## if you requires highly efficient gamma random numbers generators, \n## read a paper in Computational Statistics and Data Analysis (2007)\n## http://www.sciencedirect.com/science/article/pii/S0167947306003616 \n\n## or type ?rgamma in R to see which generator R uses. \n\n\n",
    "created" : 1478100672419.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2281799806",
    "id" : "A9B71940",
    "lastKnownWriteTime" : 1478276543,
    "path" : "T:/ownCloud/files/teaching/stat812-1609/rdemo/gamma-rej.R",
    "project_path" : "gamma-rej.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}