<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.9.16">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Likelihood-based Hypothesis Testing – Statistical Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./expofam.html" rel="next">
<link href="./bayesian.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-792aea850e7e5573310f85939a37799b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626f3934168f9f9886e6e52fc8b5c96a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link rel="stylesheet" href="resources/bookstyles.css">
<script src="resources/num_eq.js"></script>
<script src="resources/merge-toc.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./hypothesis.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Likelihood-based Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Inference</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introstatinf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Decision Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Likelihood-based Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./expofam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exponential Families</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./umvue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sufficient Statistic and Minimum Variance Estimators</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#formulation-for-hypothesis-testing" id="toc-formulation-for-hypothesis-testing" class="nav-link active" data-scroll-target="#formulation-for-hypothesis-testing"><span class="header-section-number">4.1</span> Formulation for Hypothesis Testing</a>
  <ul>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis"><span class="header-section-number">4.1.1</span> Hypothesis</a></li>
  <li><a href="#test-functions" id="toc-test-functions" class="nav-link" data-scroll-target="#test-functions"><span class="header-section-number">4.1.2</span> Test Functions</a></li>
  <li><a href="#size" id="toc-size" class="nav-link" data-scroll-target="#size"><span class="header-section-number">4.1.3</span> Size</a></li>
  <li><a href="#power" id="toc-power" class="nav-link" data-scroll-target="#power"><span class="header-section-number">4.1.4</span> Power</a></li>
  </ul></li>
  <li><a href="#the-neyman-pearson-lemma" id="toc-the-neyman-pearson-lemma" class="nav-link" data-scroll-target="#the-neyman-pearson-lemma"><span class="header-section-number">4.2</span> The Neyman-Pearson Lemma</a>
  <ul>
  <li><a href="#neyman-pearson-lemma" id="toc-neyman-pearson-lemma" class="nav-link" data-scroll-target="#neyman-pearson-lemma"><span class="header-section-number">4.2.1</span> Neyman-Pearson Lemma</a></li>
  <li><a href="#a-derivation-with-the-lagrange-multiplier-approach" id="toc-a-derivation-with-the-lagrange-multiplier-approach" class="nav-link" data-scroll-target="#a-derivation-with-the-lagrange-multiplier-approach"><span class="header-section-number">4.2.2</span> A Derivation with The Lagrange Multiplier Approach</a></li>
  <li><a href="#proof-of-np-lemma" id="toc-proof-of-np-lemma" class="nav-link" data-scroll-target="#proof-of-np-lemma"><span class="header-section-number">4.2.3</span> Proof of NP Lemma</a></li>
  </ul></li>
  <li><a href="#uniformly-most-powerful-ump-tests" id="toc-uniformly-most-powerful-ump-tests" class="nav-link" data-scroll-target="#uniformly-most-powerful-ump-tests"><span class="header-section-number">4.3</span> Uniformly Most Powerful (UMP) Tests</a></li>
  <li><a href="#monotone-likelihood-ratio-mlr" id="toc-monotone-likelihood-ratio-mlr" class="nav-link" data-scroll-target="#monotone-likelihood-ratio-mlr"><span class="header-section-number">4.4</span> Monotone Likelihood Ratio (MLR)</a>
  <ul>
  <li><a href="#karlin-rubin-theorem" id="toc-karlin-rubin-theorem" class="nav-link" data-scroll-target="#karlin-rubin-theorem"><span class="header-section-number">4.4.1</span> Karlin-Rubin Theorem</a></li>
  <li><a href="#non-existence-of-ump-for-two-sided-hypotheses" id="toc-non-existence-of-ump-for-two-sided-hypotheses" class="nav-link" data-scroll-target="#non-existence-of-ump-for-two-sided-hypotheses"><span class="header-section-number">4.4.2</span> Non-Existence of UMP for Two-Sided Hypotheses</a></li>
  </ul></li>
  <li><a href="#wilks-theorem-for-general-likelihood-ratio-tests" id="toc-wilks-theorem-for-general-likelihood-ratio-tests" class="nav-link" data-scroll-target="#wilks-theorem-for-general-likelihood-ratio-tests"><span class="header-section-number">4.5</span> Wilks’ Theorem for General Likelihood Ratio Tests</a>
  <ul>
  <li><a href="#wilks-theorem" id="toc-wilks-theorem" class="nav-link" data-scroll-target="#wilks-theorem"><span class="header-section-number">4.5.1</span> Wilks’ Theorem</a></li>
  </ul></li>
  <li><a href="#historical-notes-neyman-pearson-wilks-and-karlin-rubin" id="toc-historical-notes-neyman-pearson-wilks-and-karlin-rubin" class="nav-link" data-scroll-target="#historical-notes-neyman-pearson-wilks-and-karlin-rubin"><span class="header-section-number">4.6</span> Historical Notes: Neyman-Pearson, Wilks, and Karlin-Rubin</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Likelihood-based Hypothesis Testing</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<section id="formulation-for-hypothesis-testing" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="formulation-for-hypothesis-testing"><span class="header-section-number">4.1</span> Formulation for Hypothesis Testing</h2>
<section id="hypothesis" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="hypothesis"><span class="header-section-number">4.1.1</span> Hypothesis</h3>
<p>We formulate the problem of hypothesis testing as deciding between two competing claims about a parameter <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[
H_0: \theta \in \Theta_0 \quad \text{(Null Hypothesis)}
\]</span></p>
<p><span class="math display">\[
H_1: \theta \in \Theta_1 \quad \text{(Alternative Hypothesis)}
\]</span></p>
<div id="def-simple-composite" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.1 (Simple and Composite Hypotheses)</strong></span> A hypothesis is called <strong>simple</strong> if it specifies a single value for the parameter (e.g., <span class="math inline">\(\Theta_0\)</span> contains only one point). It is called <strong>composite</strong> if it specifies more than one value.</p>
</div>
<div id="exm-normal-hypotheses" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.1 (Normal Mean Test)</strong></span> Let <span class="math inline">\(X_1, \dots, X_n \overset{iid}{\sim} N(\mu, \sigma^2)\)</span>.</p>
<ul>
<li>If <span class="math inline">\(\sigma^2\)</span> is known, <span class="math inline">\(H_0: \mu = \mu_0\)</span> is a simple hypothesis.</li>
<li>If <span class="math inline">\(\sigma^2\)</span> is unknown, <span class="math inline">\(H_0: \mu = \mu_0\)</span> is a composite hypothesis (since <span class="math inline">\(\sigma^2\)</span> can vary).</li>
</ul>
</div>
</section>
<section id="test-functions" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="test-functions"><span class="header-section-number">4.1.2</span> Test Functions</h3>
<p>A test is defined by a <strong>critical region</strong> <span class="math inline">\(C_\alpha\)</span> such that we reject <span class="math inline">\(H_0\)</span> if the data <span class="math inline">\(x \in C_\alpha\)</span>. Equivalently, we can define a <strong>test function</strong> <span class="math inline">\(\phi(x)\)</span> representing the probability of rejecting <span class="math inline">\(H_0\)</span> given data <span class="math inline">\(x\)</span>.</p>
<ul>
<li>A <strong>non-randomized</strong> test is given as follows:</li>
</ul>
<p><span class="math display">\[
\phi(x) = I(x \in C_\alpha) = \begin{cases} 1 &amp; \text{if } x \in C_\alpha \text{ (Reject } H_0 \text{)} \\ 0 &amp; \text{otherwise} \end{cases}
\]</span></p>
<ul>
<li><p>A <strong>randomized</strong> test, <span class="math inline">\(\phi(x)\)</span> can take values in <span class="math inline">\([0, 1]\)</span>, which can be expressed typically as follows:</p>
<p><span class="math display">\[
\phi(x) = \begin{cases}
1 &amp; \text{if } x \in C_1 \\
\gamma &amp; \text{if } x \in C_* \\
0 &amp; \text{otherwise}
\end{cases}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(C_1\)</span> is the region where we strictly reject <span class="math inline">\(H_0\)</span>.</li>
<li><span class="math inline">\(C_*\)</span> is the boundary region (often where <span class="math inline">\(T(x) = k\)</span>) where we reject <span class="math inline">\(H_0\)</span> with probability <span class="math inline">\(\gamma\)</span>.</li>
</ul></li>
<li><p>More generally, <span class="math inline">\(\phi(x)\)</span> is just a function of <span class="math inline">\(x\)</span> with values in <span class="math inline">\([0,1]\)</span>, which represents the probability that we will reject <span class="math inline">\(H_0\)</span>.</p></li>
</ul>
<div id="exm-randomized-test" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.2 (Randomized Test for Binomial)</strong></span> Let <span class="math inline">\(X \sim \text{Bin}(n=10, \theta)\)</span>. Consider testing <span class="math inline">\(H_0: \theta = 1/2\)</span> vs <span class="math inline">\(H_1: \theta &gt; 1/2\)</span> with target size <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Suppose we choose a critical region <span class="math inline">\(X \ge k\)</span>.</p>
<ul>
<li>If <span class="math inline">\(k=9\)</span>, <span class="math inline">\(P(X \ge 9 | \theta=0.5) \approx 0.0107\)</span>.</li>
<li>If <span class="math inline">\(k=8\)</span>, <span class="math inline">\(P(X \ge 8 | \theta=0.5) \approx 0.0547\)</span>.</li>
</ul>
<p>Since we cannot achieve exactly 0.05 with a non-randomized test (the survival function jumps over 0.05), we must use a randomized test function.</p>
<p>The randomized test is defined as:</p>
<p><span class="math display">\[
\phi(x) = \begin{cases}
1 &amp; \text{if } x \in C_1 \text{ (i.e., } x \ge 9) \\
\gamma &amp; \text{if } x \in C_* \text{ (i.e., } x = 8) \\
0 &amp; \text{otherwise}
\end{cases}
\]</span></p>
<p>From the figure, we see that <span class="math inline">\(\alpha = 0.05\)</span> lies between <span class="math inline">\(P(X \ge 9)\)</span> and <span class="math inline">\(P(X \ge 8)\)</span>. We always reject the “tail” where probabilities are strictly less than <span class="math inline">\(\alpha\)</span> (here <span class="math inline">\(x \ge 9\)</span>). At the boundary <span class="math inline">\(x=8\)</span>, we cannot reject with probability 1 (which would give total size 0.0547), nor with probability 0 (which would give total size 0.0107).</p>
<p>We choose <span class="math inline">\(\gamma\)</span> to bridge this gap:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha &amp;= P(X \ge 9) + \gamma \cdot P(X = 8) \\
0.05 &amp;= 0.01074 + \gamma \cdot (P(X \ge 8) - P(X \ge 9)) \\
0.05 &amp;= 0.01074 + \gamma \cdot (0.05469 - 0.01074)
\end{aligned}
\]</span></p>
<p>Solving for <span class="math inline">\(\gamma\)</span>:</p>
<p><span class="math display">\[
\gamma = \frac{0.05 - 0.01074}{0.04395} \approx \frac{39}{44} \approx 0.89
\]</span></p>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-binomial-survival-zoom" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" style="width: 90% !important;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-binomial-survival-zoom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hypothesis_files/figure-html/fig-binomial-survival-zoom-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width: 90% !important;" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binomial-survival-zoom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Survival Function P(X &gt;= k) with randomization detail
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="size" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="size"><span class="header-section-number">4.1.3</span> Size</h3>
<div id="def-test-size" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.2 (Size of a Test)</strong></span> The <strong>size</strong> of a test <span class="math inline">\(\phi(x)\)</span> is the maximum probability of rejecting the null hypothesis when it is true:</p>
<p><span class="math display">\[
\text{Size}(\phi) = \sup_{\theta \in \Theta_0} W_\phi(\theta) = \sup_{\theta \in \Theta_0} E_\theta[\phi(X)]
\]</span></p>
</div>
</section>
<section id="power" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="power"><span class="header-section-number">4.1.4</span> Power</h3>
<p>We distinguish between the power function varying over parameters and the power metric of a specific test.</p>
<ol type="1">
<li><strong>Power Function (<span class="math inline">\(W_\phi(\theta)\)</span>)</strong> The probability of rejecting <span class="math inline">\(H_0\)</span> as a function of the parameter <span class="math inline">\(\theta\)</span>:</li>
</ol>
<p><span class="math display">\[
W_\phi(\theta) = E_\theta[\phi(X)]
\]</span></p>
<ol start="2" type="1">
<li><strong>Power of the Test (<span class="math inline">\(\text{Power}(\phi)\)</span>)</strong> In the context of a specific alternative hypothesis (e.g., <span class="math inline">\(H_1: \theta = \theta_1\)</span>), we define the power as a scalar functional of <span class="math inline">\(\phi\)</span>:</li>
</ol>
<p><span class="math display">\[
\text{Power}(\phi) = E_{\theta_1}[\phi(X)]
\]</span></p>
<p>Ideally, we want:</p>
<ul>
<li><span class="math inline">\(W_\phi(\theta) \le \text{Size}(\phi)\)</span> for all <span class="math inline">\(\theta \in \Theta_0\)</span> (Control Type I error).</li>
<li><span class="math inline">\(\text{Power}(\phi)\)</span> to be as large as possible (Maximize sensitivity to <span class="math inline">\(H_1\)</span>).</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Define Parameters</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>c_val <span class="ot">&lt;-</span> <span class="fl">1.5</span>      <span class="co"># Critical value</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>gamma_val <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Randomization constant</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Scaling Constants</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>max_dens <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(mu0, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y_limit <span class="ot">&lt;-</span> max_dens <span class="sc">*</span> <span class="fl">1.1</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>phi_scale <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="sc">*</span> y_limit</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Define the Test Function phi(x) (Single Test)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step function: 0 -&gt; 1 at c_val</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>df_phi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_start =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, c_val),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_end   =</span> <span class="fu">c</span>(c_val, <span class="dv">6</span>),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_start =</span> <span class="fu">c</span>(<span class="dv">0</span>, phi_scale),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_end   =</span> <span class="fu">c</span>(<span class="dv">0</span>, phi_scale)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 1: Densities (Solid Lines, No Fill) ---</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># H0: Normal(0, 1) - Blue (Cool)</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma), </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># H1: Normal(3, 1) - Red (Hot)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu1, <span class="at">sd =</span> sigma), </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 2: Test Function phi(x) (Thick Pink Line) ---</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The horizontal segments</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df_phi, </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x_start, <span class="at">xend =</span> x_end, <span class="at">y =</span> y_start, <span class="at">yend =</span> y_end), </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"deeppink"</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The vertical threshold line</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> c_val, <span class="at">xend =</span> c_val, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> phi_scale), </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"deeppink"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Points at discontinuity</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> c_val, <span class="at">y =</span> gamma_val <span class="sc">*</span> phi_scale), </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"deeppink"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> c_val, <span class="at">y =</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"deeppink"</span>) <span class="sc">+</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> c_val, <span class="at">y =</span> phi_scale), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"deeppink"</span>) <span class="sc">+</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 3: Annotations ---</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gamma label</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> c_val <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> gamma_val <span class="sc">*</span> phi_scale, </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(gamma), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"deeppink"</span>) <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># H0 / H1 Labels</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mu0, <span class="at">y =</span> max_dens <span class="sc">*</span> <span class="fl">0.9</span>, </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(H[<span class="dv">0</span>]), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mu1, <span class="at">y =</span> max_dens <span class="sc">*</span> <span class="fl">0.9</span>, </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(H[<span class="dv">1</span>]), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Critical Value Label</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> c_val, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">label =</span> <span class="st">"c"</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 4: Scales ---</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Density f(x)"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.02</span>, y_limit),</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary Axis for phi</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">/</span> phi_scale, </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">phi</span>(x)),</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>                        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Observation x"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-test-function-size-power" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-test-function-size-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hypothesis_files/figure-html/fig-test-function-size-power-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-test-function-size-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Illustration of a Test Function <span class="math inline">\(\phi(x)\)</span> (Pink) relative to Size (<span class="math inline">\(H_0\)</span>, Blue) and Power (<span class="math inline">\(H_1\)</span>, Red).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="the-neyman-pearson-lemma" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-neyman-pearson-lemma"><span class="header-section-number">4.2</span> The Neyman-Pearson Lemma</h2>
<p>Consider testing a simple null against a simple alternative: <span class="math inline">\(H_0: \theta = \theta_0\)</span> vs <span class="math inline">\(H_1: \theta = \theta_1\)</span>.</p>
<p>We define the <strong>Likelihood Ratio</strong> <span class="math inline">\(\Lambda(x)\)</span> as:</p>
<p><span class="math display">\[
\Lambda(x) = \frac{f_1(x)}{f_0(x)} = \frac{f(x; \theta_1)}{f(x; \theta_0)}
\]</span></p>
<div id="def-lrt" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.3 (Likelihood Ratio Test (LRT))</strong></span> A test <span class="math inline">\(\phi(x)\)</span> is a Likelihood Ratio Test if it has the form:</p>
<p><span class="math display">\[
\phi_{\text{LRT}}(x) = \begin{cases}
1 &amp; \text{if } \Lambda(x) &gt; k \\
\gamma(x) &amp; \text{if } \Lambda(x) = k \\
0 &amp; \text{if } \Lambda(x) &lt; k
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(k \ge 0\)</span> is a constant and <span class="math inline">\(0 \le \gamma(x) \le 1\)</span>.</p>
</div>
<section id="neyman-pearson-lemma" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="neyman-pearson-lemma"><span class="header-section-number">4.2.1</span> Neyman-Pearson Lemma</h3>
<div id="thm-neyman-pearson" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.1 (Neyman-Pearson Lemma)</strong></span> &nbsp;</p>
<ol type="a">
<li><p><strong>Optimality:</strong> For any <span class="math inline">\(k\)</span> and <span class="math inline">\(\gamma(x)\)</span>, the LRT <span class="math inline">\(\phi_0(x)\)</span> defined above has maximum power among all tests whose size is less than or equal to the size of <span class="math inline">\(\phi_0(x)\)</span>.</p></li>
<li><p><strong>Existence:</strong> Given <span class="math inline">\(\alpha \in (0, 1)\)</span>, there exist constants <span class="math inline">\(k\)</span> and <span class="math inline">\(\gamma_0\)</span> such that the LRT defined by this <span class="math inline">\(k\)</span> and <span class="math inline">\(\gamma(x) = \gamma_0\)</span> has size exactly <span class="math inline">\(\alpha\)</span>.</p></li>
<li><p><strong>Uniqueness:</strong> If a test <span class="math inline">\(\phi\)</span> has size <span class="math inline">\(\alpha\)</span> and is of maximum power among all tests of size <span class="math inline">\(\alpha\)</span>, then <span class="math inline">\(\phi\)</span> is necessarily an LRT, except possibly on a set of measure zero under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>.</p></li>
</ol>
</div>
</section>
<section id="a-derivation-with-the-lagrange-multiplier-approach" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="a-derivation-with-the-lagrange-multiplier-approach"><span class="header-section-number">4.2.2</span> A Derivation with The Lagrange Multiplier Approach</h3>
<p>To make the optimality of the Likelihood Ratio Test (LRT) intuitive, we can frame the search for the best test function <span class="math inline">\(\phi(x)\)</span> as a constrained optimization problem.</p>
<p>We want to maximize the power of the test:</p>
<p><span class="math display">\[
\text{Power}(\phi) = \int \phi(x) f_1(x) dx
\]</span></p>
<p>subject to the constraint on the size of the test <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\text{Size}(\phi) = \int \phi(x) f_0(x) dx = \alpha
\]</span></p>
<p>Using the method of Lagrange multipliers, we define the objective function <span class="math inline">\(L\)</span> with a multiplier <span class="math inline">\(k\)</span>:</p>
<p><span class="math display">\[
L(\phi, k) = \int \phi(x) f_1(x) dx - k \left( \int \phi(x) f_0(x) dx - \alpha \right)
\]</span></p>
<p>Rearranging the terms inside the integral, we get:</p>
<p><span class="math display">\[
L(\phi, k) = \int \phi(x) [f_1(x) - k f_0(x)] dx + k\alpha
\]</span></p>
<p>To maximize <span class="math inline">\(L\)</span> with respect to <span class="math inline">\(\phi(x)\)</span>, we look at the integrand. Since <span class="math inline">\(0 \le \phi(x) \le 1\)</span>, we should choose <span class="math inline">\(\phi(x)\)</span> to be as large as possible whenever its coefficient is positive, and as small as possible whenever its coefficient is negative:</p>
<ul>
<li>If <span class="math inline">\(f_1(x) - k f_0(x) &gt; 0\)</span>, set <span class="math inline">\(\phi(x) = 1\)</span>.</li>
<li>If <span class="math inline">\(f_1(x) - k f_0(x) &lt; 0\)</span>, set <span class="math inline">\(\phi(x) = 0\)</span>.</li>
<li>If <span class="math inline">\(f_1(x) - k f_0(x) = 0\)</span>, the value of <span class="math inline">\(\phi(x)\)</span> does not affect the integral (this is where <span class="math inline">\(\gamma\)</span> comes in).</li>
</ul>
<p>This decision rule is equivalent to:</p>
<p><span class="math display">\[
\phi(x) =
\begin{cases}
1 &amp; \text{if } \frac{f_1(x)}{f_0(x)} &gt; k \\
0 &amp; \text{if } \frac{f_1(x)}{f_0(x)} &lt; k
\end{cases}
\]</span></p>
<p>This is precisely the form of the Likelihood Ratio Test. The “shadow price” or Lagrange multiplier <span class="math inline">\(k\)</span> represents the critical threshold that balances the gain in power against the cost of increasing the Type I error.</p>
</section>
<section id="proof-of-np-lemma" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="proof-of-np-lemma"><span class="header-section-number">4.2.3</span> Proof of NP Lemma</h3>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><strong>Proof of (a) Optimality:</strong> Let <span class="math inline">\(\phi_{\text{LRT}}\)</span> be the LRT with size <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(\phi\)</span> be any other test with size <span class="math inline">\(\le \alpha\)</span>. Define the function <span class="math inline">\(U(x)\)</span> as the difference in test functions weighted by the linear combination of densities:</p>
<p><span class="math display">\[
U(x) = (\phi_{}(x) - \phi(x))(f_1(x) - k f_0(x))
\]</span></p>
<p>We analyze the sign of <span class="math inline">\(U(x)\)</span> by looking at the sign of its two factors in three cases:</p>
<ul>
<li><p>If <span class="math inline">\(f_1(x) - k f_0(x) &gt; 0\)</span> (implies <span class="math inline">\(\Lambda(x) &gt; k\)</span>). Since <span class="math inline">\(\phi_{\text{LRT}}(x) = 1\)</span> and <span class="math inline">\(\phi(x) \le 1\)</span>, we have:</p>
<p><span class="math display">\[
  \begin{aligned}
  \phi_{\text{LRT}}(x) - \phi(x) &amp;\ge 0 \\
  U(x) = (\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x)) &amp;\ge 0
  \end{aligned}
  \]</span></p></li>
<li><p>If <span class="math inline">\(f_1(x) - k f_0(x) &lt; 0\)</span> (implies <span class="math inline">\(\Lambda(x) &lt; k\)</span>). Since <span class="math inline">\(\phi_{\text{LRT}}(x) = 0\)</span> and <span class="math inline">\(\phi(x) \ge 0\)</span>, we have:</p>
<p><span class="math display">\[
  \begin{aligned}
  \phi_{\text{LRT}}(x) - \phi(x) &amp;\le 0 \\
  U(x) = (\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x)) &amp;\ge 0
  \end{aligned}
  \]</span></p></li>
<li><p>If <span class="math inline">\(f_1(x) - k f_0(x) = 0\)</span>. The product is zero regardless of the test functions.</p>
<p><span class="math display">\[
  U(x) = 0
  \]</span></p></li>
</ul>
<p>Combining these cases, we conclude that the product is non-negative for all <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
U(x) = (\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x)) \ge 0
\]</span></p>
<p>Therefore, integrating <span class="math inline">\(U(x)\)</span> over the entire domain:</p>
<p><span class="math display">\[
\int U(x) dx = \int (\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x)) dx \ge 0
\]</span></p>
<p>Expanding the integral:</p>
<p><span class="math display">\[
\int \phi_{\text{LRT}}(x) f_1(x) \, dx - \int \phi(x) f_1(x) \, dx - k \left( \int \phi_{\text{LRT}}(x) f_0(x) \, dx - \int \phi(x) f_0(x) \, dx \right) \ge 0
\]</span> Converting to expectations:</p>
<p><span class="math display">\[
E_{\theta_1}[\phi_{\text{LRT}}] - E_{\theta_1}[\phi] \ge k (E_{\theta_0}[\phi_{\text{LRT}}] - E_{\theta_0}[\phi])  
\]</span></p>
<p>Since <span class="math inline">\(E_{\theta_0}[\phi_{\text{LRT}}] =\text{Size}(\phi_{\text{LRT}})= \alpha\)</span> and we require that <span class="math inline">\(E_{\theta_0}[\phi] = \text{Size}(\phi)\le \alpha\)</span>,<br>
<span class="math display">\[
E_{\theta_0}[\phi_{\text{LRT}}] - E_{\theta_0}[\phi] \ge 0
\]</span></p>
<p>Thereore, given that <span class="math inline">\(k \ge 0\)</span>:</p>
<p><span class="math display">\[
\text{Power}(\phi_{\text{LRT}}) \ge \text{Power}(\phi)
\]</span></p>
<p><strong>Proof of (b) Existence:</strong></p>
<p>Let <span class="math inline">\(G(k) = P_{\theta_0}(\Lambda(X) \le k)\)</span>. <span class="math inline">\(G(k)\)</span> is the cumulative distribution function of the random variable <span class="math inline">\(\Lambda(X)\)</span>, so it is non-decreasing. We seek <span class="math inline">\(k_0\)</span> such that <span class="math inline">\(1 - G(k_0) \approx \alpha\)</span>. Because of discrete jumps, we might not hit <span class="math inline">\(\alpha\)</span> exactly. We choose <span class="math inline">\(k_0\)</span> such that:</p>
<p><span class="math display">\[
P_{\theta_0}(\Lambda(X) &gt; k_0) \le \alpha \le P_{\theta_0}(\Lambda(X) \ge k_0)
\]</span></p>
<p>Set <span class="math inline">\(\gamma_0 = \frac{\alpha - P_{\theta_0}(\Lambda(X) &gt; k_0)}{P_{\theta_0}(\Lambda(X) = k_0)}\)</span>.</p>
<p><strong>Proof of (c) Uniqueness</strong></p>
<p>Let <span class="math inline">\(\phi_{\text{LRT}}\)</span> be the LRT of size <span class="math inline">\(\alpha\)</span>. Suppose there exists another test <span class="math inline">\(\phi\)</span> that is also Most Powerful (MP) with size <span class="math inline">\(\le \alpha\)</span>. We wish to show that <span class="math inline">\(\phi(x) = \phi_{\text{LRT}}(x)\)</span> for almost all <span class="math inline">\(x\)</span> where <span class="math inline">\(f_1(x) \ne k f_0(x)\)</span>.</p>
<p>As established in the optimality proof, the function: <span class="math display">\[
U(x) = (\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x))
\]</span> is non-negative for all <span class="math inline">\(x\)</span>. Since both tests are MP, they have the same power: <span class="math inline">\(E_{\theta_1}[\phi_{\text{LRT}}] = E_{\theta_1}[\phi]\)</span>.</p>
<p>From the integral of <span class="math inline">\(U(x)\)</span>, we have: <span class="math display">\[
0 \le \int U(x) dx = (E_{\theta_1}[\phi_{\text{LRT}}] - E_{\theta_1}[\phi]) - k(E_{\theta_0}[\phi_{\text{LRT}}] - E_{\theta_0}[\phi])
\]</span></p>
<p>Substituting the equality of power: <span class="math display">\[
0 \le -k(\alpha - E_{\theta_0}[\phi])
\]</span></p>
<p>Since <span class="math inline">\(k &gt; 0\)</span> and <span class="math inline">\(E_{\theta_0}[\phi] \le \alpha\)</span>, the term <span class="math inline">\(-k(\alpha - E_{\theta_0}[\phi])\)</span> is <span class="math inline">\(\le 0\)</span>. The only way for the integral of a non-negative function <span class="math inline">\(U(x)\)</span> to be <span class="math inline">\(\le 0\)</span> is if the integral is exactly zero: <span class="math display">\[
\int (\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x)) \, dx = 0
\]</span></p>
<p>For the integral of a non-negative function to be zero, the integrand must be zero almost everywhere: <span class="math display">\[
(\phi_{\text{LRT}}(x) - \phi(x))(f_1(x) - k f_0(x)) = 0 \quad \text{a.e.}
\]</span></p>
<p>This implies that for any <span class="math inline">\(x\)</span> where <span class="math inline">\(f_1(x) - k f_0(x) \ne 0\)</span>, we must have: <span class="math display">\[
\phi_{\text{LRT}}(x) - \phi(x) = 0 \implies \phi(x) = \phi_{\text{LRT}}(x)
\]</span></p>
<p>Thus, the test is unique except possibly on the boundary set <span class="math inline">\(\{x : f_1(x) = k f_0(x)\}\)</span>. If <span class="math inline">\(P_{\theta_0}(\Lambda(X) = k) = 0\)</span> (as in continuous distributions like the Normal), the MP test is unique almost everywhere.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Define Parameters</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>c_lrt <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>gamma_val <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaling constants</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>max_dens <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(mu0, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>y_limit <span class="ot">&lt;-</span> max_dens <span class="sc">*</span> <span class="fl">1.1</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>phi_scale <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="sc">*</span> y_limit</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define Test Functions Data</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>df_lrt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_start =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, c_lrt),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_end   =</span> <span class="fu">c</span>(c_lrt, <span class="dv">6</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_val   =</span> <span class="fu">c</span>(<span class="dv">0</span>, phi_scale),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test    =</span> <span class="st">"phi[LRT]"</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df_other <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_start =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_end   =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">3</span>,<span class="dv">6</span>),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_val   =</span> <span class="fu">c</span>(<span class="dv">0</span>, phi_scale, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test    =</span> <span class="st">"phi"</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 1: Densities (Solid Lines, No Fill) ---</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0, <span class="at">sd =</span> sigma), </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu1, <span class="at">sd =</span> sigma), </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 2: Test Functions (Segments) ---</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2a. LRT Segments (Thick, Transparent Pink)</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df_lrt,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x_start, <span class="at">xend =</span> x_end, </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y_val, <span class="at">yend =</span> y_val, </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> Test, <span class="at">linetype =</span> Test, <span class="at">size =</span> Test),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vertical connector for LRT</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> c_lrt, <span class="at">xend =</span> c_lrt, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> phi_scale),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"deeppink"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2b. Other Test Segments (Thin Black Opaque)</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df_other,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x_start, <span class="at">xend =</span> x_end, </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y_val, <span class="at">yend =</span> y_val, </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> Test, <span class="at">linetype =</span> Test, <span class="at">size =</span> Test)) <span class="sc">+</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vertical connectors for Other Test</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> phi_scale),</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> phi_scale),</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 3: Annotations ---</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># LRT Gamma Point (Pink)</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> c_lrt, <span class="at">y =</span> gamma_val <span class="sc">*</span> phi_scale), </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"deeppink"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Density Labels</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mu0, <span class="at">y =</span> max_dens <span class="sc">*</span> <span class="fl">0.9</span>, </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(H[<span class="dv">0</span>]), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mu1, <span class="at">y =</span> max_dens <span class="sc">*</span> <span class="fl">0.9</span>, </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(H[<span class="dv">1</span>]), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- Layer 4: Scales and Legend ---</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Density f(x)"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.02</span>, y_limit), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">/</span> phi_scale, <span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">phi</span>(x)), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Observation x"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manual Legend Controls (FIXED using named vectors for labels)</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Test Function"</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"phi[LRT]"</span> <span class="ot">=</span> <span class="st">"deeppink"</span>, <span class="st">"phi"</span> <span class="ot">=</span> <span class="st">"black"</span>),</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"phi[LRT]"</span> <span class="ot">=</span> <span class="fu">expression</span>(phi[LRT]), <span class="st">"phi"</span> <span class="ot">=</span> <span class="fu">expression</span>(phi))) <span class="sc">+</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"Test Function"</span>,</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"phi[LRT]"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"phi"</span> <span class="ot">=</span> <span class="st">"solid"</span>),</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"phi[LRT]"</span> <span class="ot">=</span> <span class="fu">expression</span>(phi[LRT]), <span class="st">"phi"</span> <span class="ot">=</span> <span class="fu">expression</span>(phi))) <span class="sc">+</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">name =</span> <span class="st">"Test Function"</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"phi[LRT]"</span> <span class="ot">=</span> <span class="dv">4</span>,   <span class="co"># Extra Thick</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"phi"</span> <span class="ot">=</span> <span class="dv">1</span>), <span class="co"># Thin</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"phi[LRT]"</span> <span class="ot">=</span> <span class="fu">expression</span>(phi[LRT]), <span class="st">"phi"</span> <span class="ot">=</span> <span class="fu">expression</span>(phi))) <span class="sc">+</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-NPlemma-proof" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-NPlemma-proof-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hypothesis_files/figure-html/fig-NPlemma-proof-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-NPlemma-proof-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Visualizing the NP Lemma. The thick, transparent pink line is <span class="math inline">\(\phi_{ ext{LRT}}\)</span>. The thin solid black line is <span class="math inline">\(\phi\)</span>. Overlap is visible as a black line inside pink.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="uniformly-most-powerful-ump-tests" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="uniformly-most-powerful-ump-tests"><span class="header-section-number">4.3</span> Uniformly Most Powerful (UMP) Tests</h2>
<p>When the alternative hypothesis is composite (<span class="math inline">\(H_1: \theta \in \Theta_1\)</span>), we seek a test that is “best” for <em>all</em> <span class="math inline">\(\theta \in \Theta_1\)</span>.</p>
<div id="def-ump" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.4 (Uniformly Most Powerful Test)</strong></span> A test <span class="math inline">\(\phi_0(x)\)</span> of size <span class="math inline">\(\alpha\)</span> is <strong>Uniformly Most Powerful (UMP)</strong> if:</p>
<ol type="1">
<li><span class="math inline">\(E_{\theta}[\phi_0(X)] \le \alpha\)</span> for all <span class="math inline">\(\theta \in \Theta_0\)</span>.</li>
<li>For any other test <span class="math inline">\(\phi(x)\)</span> satisfying (1), <span class="math inline">\(E_{\theta}[\phi_0(X)] \ge E_{\theta}[\phi(X)]\)</span> for all <span class="math inline">\(\theta \in \Theta_1\)</span>.</li>
</ol>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ump-power" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" style="width: 80% !important;">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ump-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hypothesis_files/figure-html/fig-ump-power-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width: 80% !important;" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ump-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: Diagram of UMP Tests
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="monotone-likelihood-ratio-mlr" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="monotone-likelihood-ratio-mlr"><span class="header-section-number">4.4</span> Monotone Likelihood Ratio (MLR)</h2>
<div id="def-mlr" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.5 (Monotone Likelihood Ratio)</strong></span> A family of densities <span class="math inline">\(\{f(x; \theta)\}\)</span> has a <strong>Monotone Likelihood Ratio (MLR)</strong> with respect to a statistic <span class="math inline">\(T(x)\)</span> if for any <span class="math inline">\(\theta_1 &gt; \theta_0\)</span>, the ratio:</p>
<p><span class="math display">\[
\frac{f(x; \theta_1)}{f(x; \theta_0)}
\]</span></p>
<p>is a non-decreasing function of <span class="math inline">\(T(x)\)</span>.</p>
</div>
<p>Common examples include the one-parameter Exponential Family: <span class="math inline">\(f(x; \theta) = h(x) c(\theta) \exp\{w(\theta) T(x)\}\)</span>. If <span class="math inline">\(w(\theta)\)</span> is increasing, the family has MLR w.r.t <span class="math inline">\(T(x)\)</span>.</p>
<div id="exm-mlr-gamma" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.3</strong></span> Let <span class="math inline">\(X_1, \dots, X_n \overset{iid}{\sim} \text{Exp}(\theta)\)</span> with pdf <span class="math inline">\(f(x) = \frac{1}{\theta} e^{-x/\theta}\)</span>. Test <span class="math display">\[H_0: \theta = \theta_0 \text{ vs } H_1: \theta &gt; \theta_0.\]</span></p>
<p>The Likelihood Ratio for <span class="math inline">\(\theta_1 &gt; \theta_0\)</span> is:</p>
<p><span class="math display">\[
\frac{L(\theta_1)}{L(\theta_0)} = \frac{\theta_1^{-n} e^{-\sum x_i / \theta_1}}{\theta_0^{-n} e^{-\sum x_i / \theta_0}} = \left(\frac{\theta_0}{\theta_1}\right)^n \exp \left\{ \left( \frac{1}{\theta_0} - \frac{1}{\theta_1} \right) \sum x_i \right\}
\]</span></p>
<p>Since <span class="math inline">\(\theta_1 &gt; \theta_0\)</span>, the term <span class="math inline">\((\frac{1}{\theta_0} - \frac{1}{\theta_1})\)</span> is positive. Thus, <span class="math inline">\(\Lambda(x)\)</span> is an increasing function of the sum <span class="math inline">\(T (x) = \sum x_i\)</span>.</p>
<p>Rejecting for large <span class="math inline">\(\Lambda(x)\)</span> is equivalent to rejecting for <span class="math inline">\(T(x)=\sum x_i &gt; C\)</span>.</p>
<p>Under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(X_i \sim \text{Exp}(\theta_0)\)</span>, which is equivalent to <span class="math inline">\(\text{Gamma}(1, \theta_0)\)</span>. By the reproductive property of the Gamma distribution:</p>
<p><span class="math display">\[T = \sum_{i=1}^n X_i \sim \text{Gamma}(n, \theta_0)\]</span></p>
<p>Alternatively, using the relationship with the Chi-square distribution:</p>
<p><span class="math display">\[\frac{2T}{\theta_0} \sim \chi^2_{2n}\]</span></p>
<p>To find <span class="math inline">\(C\)</span> for a significance level <span class="math inline">\(\alpha\)</span>, we set <span class="math inline">\(P(T &gt; C | \theta_0) = \alpha\)</span>. Using the <span class="math inline">\(\chi^2\)</span> transformation:</p>
<p><span class="math display">\[P\left(\frac{2T}{\theta_0} &gt; \frac{2C}{\theta_0}\right) = \alpha \implies \frac{2C}{\theta_0} = \chi^2_{2n, \alpha}\]</span></p>
<p>Thus, the critical value is:</p>
<p><span class="math display">\[C = \frac{\theta_0}{2} \chi^2_{2n, \alpha}\]</span></p>
<p>where <span class="math inline">\(\chi^2_{2n, \alpha}\)</span> is the upper-<span class="math inline">\(\alpha\)</span> quantile of a Chi-square distribution with <span class="math inline">\(2n\)</span> degrees of freedom.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We note that the value <span class="math inline">\(C\)</span> does not depend on <span class="math inline">\(\theta_1\)</span>.</p>
</div>
</div>
</div>
<section id="karlin-rubin-theorem" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="karlin-rubin-theorem"><span class="header-section-number">4.4.1</span> Karlin-Rubin Theorem</h3>
<div id="thm-chebyshev-covariance" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.2 (Chebyshev’s Association Inequality)</strong></span> Let <span class="math inline">\(X\)</span> be a random variable, and let <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> be two functions that are both non-decreasing (or both non-increasing). Then: <span class="math display">\[
E[f(X)g(X)] \ge E[f(X)] \cdot E[g(X)]
\]</span> Equivalently, the covariance is non-negative: <span class="math inline">\(\text{Cov}(f(X), g(X)) \ge 0\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(Y\)</span> be an independent copy of <span class="math inline">\(X\)</span> (i.e., <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are i.i.d.). Consider the quantity: <span class="math display">\[
\Delta = (f(X) - f(Y))(g(X) - g(Y))
\]</span></p>
<p>Since <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are both non-decreasing (or both non-increasing), the terms <span class="math inline">\((f(X) - f(Y))\)</span> and <span class="math inline">\((g(X) - g(Y))\)</span> always share the same sign. Thus, their product is always non-negative: <span class="math display">\[
\Delta \ge 0
\]</span></p>
<p>Taking the expectation: <span class="math display">\[
E[(f(X) - f(Y))(g(X) - g(Y))] \ge 0
\]</span></p>
<p>Expanding the product and using linearity of expectation: <span class="math display">\[
E[f(X)g(X)] - E[f(X)g(Y)] - E[f(Y)g(X)] + E[f(Y)g(Y)] \ge 0
\]</span></p>
<p>Since <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are i.i.d.:</p>
<ol type="1">
<li><span class="math inline">\(E[f(Y)g(Y)] = E[f(X)g(X)]\)</span></li>
<li><span class="math inline">\(E[f(X)g(Y)] = E[f(X)]E[g(Y)] = E[f(X)]E[g(X)]\)</span> (Independence)</li>
<li><span class="math inline">\(E[f(Y)g(X)] = E[f(Y)]E[g(X)] = E[f(X)]E[g(X)]\)</span> (Independence)</li>
</ol>
<p>Substituting these back yields: <span class="math display">\[
2E[f(X)g(X)] - 2E[f(X)]E[g(X)] \ge 0
\]</span></p>
<p>Dividing by 2 proves the inequality: <span class="math display">\[
E[f(X)g(X)] \ge E[f(X)]E[g(X)]
\]</span></p>
</div>
<div id="thm-karlin-rubin" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.3 (Karlin-Rubin Theorem)</strong></span> Suppose <span class="math inline">\(X\)</span> has a distribution from a family with MLR with respect to <span class="math inline">\(T(X)\)</span>, and the distribution of <span class="math inline">\(T(X)\)</span> is continuous. Consider testing <span class="math inline">\(H_0: \theta \le \theta_0\)</span> vs <span class="math inline">\(H_1: \theta &gt; \theta_0\)</span>.</p>
<p>The test:</p>
<p><span class="math display">\[
\phi(x) = \begin{cases}
1 &amp; \text{if } T(x) &gt; t_0 \\
0 &amp; \text{if } T(x) \le t_0
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(t_0\)</span> is determined by <span class="math inline">\(P_{\theta_0}(T(X) &gt; t_0) = \alpha\)</span>, is the UMP size <span class="math inline">\(\alpha\)</span> test.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><strong>The Test:</strong> Define the test <span class="math inline">\(\phi_0(x)\)</span> as:</p>
<p><span class="math display">\[
\phi_0(x) = \begin{cases}
1 &amp; \text{if } T(x) &gt; t_0 \\
0 &amp; \text{if } T(x) \le t_0
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(t_0\)</span> is determined such that the power at the boundary is <span class="math inline">\(\alpha\)</span>, i.e., <span class="math inline">\(W_{\phi_0}(\theta_0) = \alpha\)</span>.</p>
<ol type="1">
<li><p><strong>Monotonicity of the Power Function</strong></p>
<p>We first establish that <span class="math inline">\(W_{\phi_0}(\theta)\)</span> is non-decreasing. Let <span class="math inline">\(\theta_1 &gt; \theta_0\)</span>. Define the test indicator function <span class="math inline">\(h(t) = \mathbb{I}(t &gt; t_0)\)</span> and the likelihood ratio <span class="math inline">\(\Lambda(t) = \frac{f_{\theta_1}(t)}{f_{\theta_0}(t)}\)</span>.</p>
<p>Because of the Monotone Likelihood Ratio (MLR) property, <span class="math inline">\(\Lambda(t)\)</span> is a non-decreasing function of <span class="math inline">\(t\)</span>. The indicator function <span class="math inline">\(h(t)\)</span> is clearly non-decreasing.</p>
<p>The power at <span class="math inline">\(\theta_1\)</span> can be written as an integral involving the density under <span class="math inline">\(\theta_0\)</span>: <span class="math display">\[
W_{\phi_0}(\theta_1) = \int_{-\infty}^{\infty} h(t) f_{\theta_1}(t) \, dt = \int_{-\infty}^{\infty} h(t) \frac{f_{\theta_1}(t)}{f_{\theta_0}(t)} f_{\theta_0}(t) \, dt = \int_{-\infty}^{\infty} h(t) \Lambda(t) f_{\theta_0}(t) \, dt
\]</span></p>
<p>This integral is the expectation <span class="math inline">\(E_{\theta_0}[h(T) \Lambda(T)]\)</span>. By Chebyshev’s Association Inequality (Covariance Inequality), since both <span class="math inline">\(h(t)\)</span> and <span class="math inline">\(\Lambda(t)\)</span> are non-decreasing, the expectation of their product is at least the product of their expectations: <span class="math display">\[
\int_{-\infty}^{\infty} h(t) \Lambda(t) f_{\theta_0}(t) \, dt \ge \left( \int_{-\infty}^{\infty} h(t) f_{\theta_0}(t) \, dt \right) \left( \int_{-\infty}^{\infty} \Lambda(t) f_{\theta_0}(t) \, dt \right)
\]</span></p>
<p>We evaluate the two integrals on the right-hand side:</p>
<ol type="1">
<li>The first term is the power at <span class="math inline">\(\theta_0\)</span>: <span class="math inline">\(\int h(t) f_{\theta_0}(t) \, dt = W_{\phi_0}(\theta_0)\)</span>.</li>
<li>The second term integrates the likelihood ratio: <span class="math inline">\(\int \frac{f_{\theta_1}(t)}{f_{\theta_0}(t)} f_{\theta_0}(t) \, dt = \int f_{\theta_1}(t) \, dt = 1\)</span>.</li>
</ol>
<p>Substituting these back, we get: <span class="math display">\[
W_{\phi_0}(\theta_1) \ge W_{\phi_0}(\theta_0) \cdot 1
\]</span> Thus, <span class="math inline">\(W_{\phi_0}(\theta)\)</span> is non-decreasing.</p></li>
<li><p><strong>Size Control</strong></p>
<p>For the composite null <span class="math inline">\(H_0: \theta \le \theta_0\)</span>, we require the size to be at most <span class="math inline">\(\alpha\)</span>. Since <span class="math inline">\(W_{\phi_0}(\theta)\)</span> is non-decreasing (from Step 1) and we explicitly set <span class="math inline">\(W_{\phi_0}(\theta_0) = \alpha\)</span>:</p>
<p><span class="math display">\[
W_{\phi_0}(\theta) \le W_{\phi_0}(\theta_0) = \alpha \quad \text{for all } \theta \le \theta_0
\]</span></p>
<p>This confirms <span class="math inline">\(\phi_0\)</span> is a valid level-<span class="math inline">\(\alpha\)</span> test.</p></li>
<li><p><strong>Uniformly Most Powerful (UMP) via Neyman-Pearson Lemma</strong></p>
<p>Let <span class="math inline">\(\phi'(x)\)</span> be any other valid test of size <span class="math inline">\(\alpha\)</span> for <span class="math inline">\(H_0\)</span>. This implies <span class="math inline">\(W_{\phi'}(\theta_0) \le \alpha\)</span>.</p>
<p>Consider any specific alternative <span class="math inline">\(\theta_1 &gt; \theta_0\)</span>. Because the family has MLR, the likelihood ratio <span class="math inline">\(\Lambda(x)\)</span> is increasing in <span class="math inline">\(T(x)\)</span>. Therefore, the test <span class="math inline">\(\phi_0\)</span> (which rejects for large <span class="math inline">\(T\)</span>) is identified by the Neyman-Pearson Lemma as the Most Powerful (MP) test for the simple hypothesis <span class="math inline">\(\theta_0\)</span> vs <span class="math inline">\(\theta_1\)</span>.</p>
<p>Comparing the power of <span class="math inline">\(\phi_0\)</span> and <span class="math inline">\(\phi'\)</span> at this specific <span class="math inline">\(\theta_1\)</span>: <span class="math display">\[
W_{\phi_0}(\theta_1) \ge W_{\phi'}(\theta_1)
\]</span> Since <span class="math inline">\(\theta_1\)</span> was arbitrary, this inequality holds for all <span class="math inline">\(\theta &gt; \theta_0\)</span>. Thus, <span class="math inline">\(\phi_0\)</span> is the UMP test.</p></li>
</ol>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-monotone-power-MLR" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-monotone-power-MLR-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hypothesis_files/figure-html/fig-monotone-power-MLR-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-monotone-power-MLR-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Visualizing Monotonicity of Power Function <span class="math inline">\(W(\theta)\)</span> for MLR Distributions
</figcaption>
</figure>
</div>
</div>
</div>
<div id="exm-ump-gamma" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.4 (UMP Test for Exponential/Gamma)</strong></span> Let <span class="math inline">\(X_1, \dots, X_n \overset{iid}{\sim} \text{Exp}(\theta)\)</span> with pdf <span class="math inline">\(f(x) = \frac{1}{\theta} e^{-x/\theta}\)</span>. Test <span class="math inline">\(H_0: \theta = \theta_0\)</span> vs <span class="math inline">\(H_1: \theta &gt; \theta_0\)</span>. The sum <span class="math inline">\(T = \sum X_i\)</span> is a sufficient statistic, and <span class="math inline">\(T \sim \text{Gamma}(n, \theta)\)</span>.</p>
<p>The Likelihood Ratio for <span class="math inline">\(\theta_1 &gt; \theta_0\)</span> is:</p>
<p><span class="math display">\[
\frac{L(\theta_1)}{L(\theta_0)} = \frac{\theta_1^{-n} e^{-\sum x_i / \theta_1}}{\theta_0^{-n} e^{-\sum x_i / \theta_0}} = \left(\frac{\theta_0}{\theta_1}\right)^n \exp \left\{ \left( \frac{1}{\theta_0} - \frac{1}{\theta_1} \right) \sum x_i \right\}
\]</span></p>
<p>Since <span class="math inline">\(\theta_1 &gt; \theta_0\)</span>, the term <span class="math inline">\((\frac{1}{\theta_0} - \frac{1}{\theta_1})\)</span> is positive. Thus, <span class="math inline">\(\Lambda(x)\)</span> is an increasing function of <span class="math inline">\(\sum x_i\)</span>.</p>
<p>Rejecting for large <span class="math inline">\(\Lambda(x)\)</span> is equivalent to rejecting for <span class="math inline">\(\sum x_i &gt; C\)</span>.</p>
<p><span class="math inline">\(T \sim \text{Gamma}(n, \theta)\)</span></p>
<p>This test form does not depend on the specific <span class="math inline">\(\theta_1\)</span>, so it is UMP for all <span class="math inline">\(\theta &gt; \theta_0\)</span>.</p>
</div>
</section>
<section id="non-existence-of-ump-for-two-sided-hypotheses" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="non-existence-of-ump-for-two-sided-hypotheses"><span class="header-section-number">4.4.2</span> Non-Existence of UMP for Two-Sided Hypotheses</h3>
<p>For testing a point null hypothesis <span class="math inline">\(H_0: \theta = \theta_0\)</span> against a two-sided alternative <span class="math inline">\(H_1: \theta \neq \theta_0\)</span> in a family with a monotone likelihood ratio (e.g., Normal, Exponential), a Uniformly Most Powerful (UMP) test generally <strong>does not exist</strong>. The non-existence proof relies on the uniqueness of the Most Powerful (MP) test derived from the Neyman-Pearson Lemma:</p>
<ol type="1">
<li><p><strong>Conflict of Optimal Regions:</strong> Consider a specific alternative <span class="math inline">\(\theta_1 &gt; \theta_0\)</span>. By the Neyman-Pearson Lemma, the MP test <span class="math inline">\(\phi_1\)</span> rejects <span class="math inline">\(H_0\)</span> for large values of the sufficient statistic <span class="math inline">\(T(\mathbf{X}) &gt; k_1\)</span>. Conversely, consider an alternative <span class="math inline">\(\theta_2 &lt; \theta_0\)</span>. The MP test <span class="math inline">\(\phi_2\)</span> rejects <span class="math inline">\(H_0\)</span> for small values of the statistic <span class="math inline">\(T(\mathbf{X}) &lt; k_2\)</span>.</p></li>
<li><p><strong>Failure of Uniformity:</strong> A UMP test <span class="math inline">\(\phi^*\)</span> would need to be the MP test for <em>every</em> <span class="math inline">\(\theta \in H_1\)</span>.</p>
<ul>
<li>For <span class="math inline">\(\phi^*\)</span> to be most powerful against <span class="math inline">\(\theta_1\)</span>, it must be equivalent to <span class="math inline">\(\phi_1\)</span> (rejecting in the right tail).</li>
<li>For <span class="math inline">\(\phi^*\)</span> to be most powerful against <span class="math inline">\(\theta_2\)</span>, it must be equivalent to <span class="math inline">\(\phi_2\)</span> (rejecting in the left tail).</li>
</ul></li>
<li><p><strong>Biased Power Function:</strong> The MP test <span class="math inline">\(\phi_1\)</span> (Right-Sided) has a power function that drops below the size <span class="math inline">\(\alpha\)</span> for values <span class="math inline">\(\theta &lt; \theta_0\)</span>. Therefore, it cannot be the most powerful test for <span class="math inline">\(\theta_2\)</span>, as there exists a valid test (e.g., <span class="math inline">\(\phi_2\)</span>) with power strictly greater than <span class="math inline">\(\alpha\)</span> at <span class="math inline">\(\theta_2\)</span>.</p></li>
</ol>
<p>Since no single critical region can simultaneously maximize power for both <span class="math inline">\(\theta &gt; \theta_0\)</span> and <span class="math inline">\(\theta &lt; \theta_0\)</span>, no UMP test exists. We typically restrict our search to <strong>Unbiased</strong> tests (UMPU) to resolve this.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-two-powers-normal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-two-powers-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hypothesis_files/figure-html/fig-two-powers-normal-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-two-powers-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: Illustration of Non-existence of UMP Tests for Two-sided Tests
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="wilks-theorem-for-general-likelihood-ratio-tests" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="wilks-theorem-for-general-likelihood-ratio-tests"><span class="header-section-number">4.5</span> Wilks’ Theorem for General Likelihood Ratio Tests</h2>
<p>The Likelihood Ratio Test (LRT) provides a unified approach for constructing hypothesis tests for parametric models. Let <span class="math inline">\(X_1, \dots, X_n\)</span> be a random sample with joint probability density function <span class="math inline">\(L(\theta; \mathbf{x})\)</span>, where <span class="math inline">\(\theta \in \Theta\)</span>. We consider the general hypothesis testing problem: <span class="math display">\[H_0: \theta \in \Theta_0 \quad \text{vs} \quad H_1: \theta \in \Theta \setminus \Theta_0\]</span></p>
<p>The <strong>Likelihood Ratio Statistic</strong> is defined as the ratio of the maximum likelihood achievable under the null hypothesis to the maximum likelihood achievable under the full parameter space:</p>
<p><span class="math display">\[\Lambda(\mathbf{x}) = \frac{\sup_{\theta \in \Theta_0} L(\theta; \mathbf{x})}{\sup_{\theta \in \Theta} L(\theta; \mathbf{x})} = \frac{L(\hat{\theta}_0)}{L(\hat{\theta})}\]</span></p>
<p>where <span class="math inline">\(\hat{\theta}_0\)</span> is the restricted MLE and <span class="math inline">\(\hat{\theta}\)</span> is the unrestricted (global) MLE. By definition, the likelihood ratio is bounded by <span class="math inline">\(0 \le \Lambda(\mathbf{x}) \le 1\)</span>. The Likelihood Ratio Test (LRT) is defined by the decision function:</p>
<p><span class="math display">\[
\phi(\mathbf{x}) = \begin{cases}
1 &amp; \text{if } \Lambda(\mathbf{x}) \le c \quad (\text{Reject } H_0) \\
0 &amp; \text{if } \Lambda(\mathbf{x}) &gt; c \quad (\text{Fail to reject } H_0)
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(c \in (0, 1)\)</span> is a critical value determined by the significance level <span class="math inline">\(\alpha\)</span>. This rejection region <span class="math inline">\(\{\mathbf{x} : \Lambda(\mathbf{x}) \le c\}\)</span> corresponds to cases where the restricted likelihood (under <span class="math inline">\(H_0\)</span>) is significantly smaller than the unrestricted likelihood.</p>
<section id="wilks-theorem" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="wilks-theorem"><span class="header-section-number">4.5.1</span> Wilks’ Theorem</h3>
<p>The asymptotic distribution of the Likelihood Ratio Test statistic is given by the celebrated result from Wilks (1938). This theorem allows us to construct hypothesis tests without deriving the exact distribution of <span class="math inline">\(\Lambda\)</span> for every specific model.</p>
<div id="thm-wilks" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.4 (Wilks’ Theorem)</strong></span> Let <span class="math inline">\(X_1, \dots, X_n\)</span> be an i.i.d. sample from a regular family of distributions with parameters <span class="math inline">\(\theta \in \Theta \subseteq \mathbb{R}^{p_1}\)</span>. Consider the test: <span class="math display">\[ H_0: \theta \in \Theta_0 \quad \text{vs} \quad H_1: \theta \in \Theta \setminus \Theta_0 \]</span> where <span class="math inline">\(\Theta_0\)</span> is a smooth subset of <span class="math inline">\(\Theta\)</span> with dimension <span class="math inline">\(p_0 &lt; p_1\)</span>. Let <span class="math inline">\(\Lambda_n\)</span> be the likelihood ratio statistic. Under <span class="math inline">\(H_0\)</span>, as <span class="math inline">\(n \to \infty\)</span>: <span class="math display">\[ -2 \ln \Lambda_n \xrightarrow{d} \chi^2_{k} \]</span> where the degrees of freedom <span class="math inline">\(k = p_1 - p_0\)</span> is the difference in the number of free parameters between the full model and the null model.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><strong>Sketch of Proof:</strong></p>
<p>The proof relies on the Taylor expansion of the log-likelihood function <span class="math inline">\(\ell(\theta)\)</span> around the unrestricted MLE <span class="math inline">\(\hat{\theta}\)</span>.</p>
<ol type="1">
<li><p><strong>Quadratic Approximation:</strong> For large <span class="math inline">\(n\)</span>, <span class="math inline">\(\hat{\theta}\)</span> is close to the true parameter <span class="math inline">\(\theta_0\)</span>. We expand <span class="math inline">\(\ell(\theta_0)\)</span> around <span class="math inline">\(\hat{\theta}\)</span>: <span class="math display">\[ \ell(\theta_0) \approx \ell(\hat{\theta}) + (\theta_0 - \hat{\theta})^T \nabla \ell(\hat{\theta}) + \frac{1}{2}(\theta_0 - \hat{\theta})^T \nabla^2 \ell(\hat{\theta}) (\theta_0 - \hat{\theta}) \]</span> Since <span class="math inline">\(\hat{\theta}\)</span> is the MLE, the score vector <span class="math inline">\(\nabla \ell(\hat{\theta}) = 0\)</span>. The Hessian <span class="math inline">\(\nabla^2 \ell(\hat{\theta}) \approx -n I(\theta_0)\)</span>, where <span class="math inline">\(I(\theta_0)\)</span> is the Fisher Information matrix. Thus: <span class="math display">\[ 2[\ell(\hat{\theta}) - \ell(\theta_0)] \approx n(\hat{\theta} - \theta_0)^T I(\theta_0) (\hat{\theta} - \theta_0) \]</span> From the asymptotic normality of the MLE, <span class="math inline">\(\sqrt{n}(\hat{\theta} - \theta_0) \xrightarrow{d} N(0, I(\theta_0)^{-1})\)</span>. Therefore, the quadratic form converges to a Chi-square variable with <span class="math inline">\(p_1\)</span> degrees of freedom: <span class="math display">\[ 2[\ell(\hat{\theta}) - \ell(\theta_0)] \xrightarrow{d} \chi^2_{p_1} \]</span></p></li>
<li><p><strong>Decomposition of the Statistic:</strong> The LRT statistic is <span class="math inline">\(D = -2 \ln \Lambda = 2[\ell(\hat{\theta}) - \ell(\hat{\theta}_0)]\)</span>. We can rewrite this by adding and subtracting the true log-likelihood <span class="math inline">\(\ell(\theta_0)\)</span>: <span class="math display">\[ 2[\ell(\hat{\theta}) - \ell(\hat{\theta}_0)] = \underbrace{2[\ell(\hat{\theta}) - \ell(\theta_0)]}_{\approx \chi^2_{p_1}} - \underbrace{2[\ell(\hat{\theta}_0) - \ell(\theta_0)]}_{\approx \chi^2_{p_0}} \]</span> The term <span class="math inline">\(2[\ell(\hat{\theta}_0) - \ell(\theta_0)]\)</span> represents the deviation of the <em>restricted</em> MLE from the truth. Since <span class="math inline">\(\Theta_0\)</span> has dimension <span class="math inline">\(p_0\)</span>, this term converges to <span class="math inline">\(\chi^2_{p_0}\)</span>.</p></li>
<li><p><strong>Result via Cochran’s Theorem Logic:</strong> Geometrically, this is analogous to projecting the data vector onto orthogonal subspaces (like in ANOVA). The difference of two nested Chi-square variables (where one represents a subspace of the other) is itself Chi-square distributed with degrees of freedom equal to the difference in dimensions: <span class="math display">\[ D \xrightarrow{d} \chi^2_{p_1} - \chi^2_{p_0} \sim \chi^2_{p_1 - p_0} = \chi^2_k \]</span></p></li>
</ol>
</div>
<div id="exm-lrt-normal" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.5</strong></span> <strong>LRT for Normal Mean with Unknown Variance</strong></p>
<p>Let <span class="math inline">\(X_1, \dots, X_n \overset{i.i.d.}{\sim} N(\mu, \sigma^2)\)</span> where both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are unknown. The parameter vector is <span class="math inline">\(\theta = (\mu, \sigma^2)\)</span>. We wish to test: <span class="math display">\[H_0: \mu = \mu_0 \quad \text{vs} \quad H_1: \mu \neq \mu_0\]</span></p>
<ol type="1">
<li><p><strong>Find the Maximum Likelihood Estimators</strong></p>
<p>The log-likelihood function is <span class="math inline">\(\ell(\mu, \sigma^2) = -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n (x_i - \mu)^2\)</span>.</p>
<ul>
<li><p><strong>Unrestricted MLEs (<span class="math inline">\(\hat{\theta}\)</span>):</strong> Maximizing over <span class="math inline">\(\mathbb{R} \times (0, \infty)\)</span> yields the sample mean and the biased sample variance: <span class="math display">\[\hat{\mu} = \bar{X}, \quad \hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^n (X_i - \bar{X})^2\]</span></p></li>
<li><p><strong>Restricted MLEs (<span class="math inline">\(\hat{\theta}_0\)</span>):</strong> Under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\mu\)</span> is fixed at <span class="math inline">\(\mu_0\)</span>. Maximizing with respect to <span class="math inline">\(\sigma^2\)</span> yields: <span class="math display">\[\hat{\mu}_0 = \mu_0, \quad \hat{\sigma}_0^2 = \frac{1}{n}\sum_{i=1}^n (X_i - \mu_0)^2\]</span></p></li>
</ul></li>
<li><p><strong>Construct the Likelihood Ratio <span class="math inline">\(\Lambda(\mathbf{x})\)</span></strong></p>
<p>Evaluating the likelihood function <span class="math inline">\(L(\theta) \propto (\sigma^2)^{-n/2} \exp\left( -\frac{1}{2\sigma^2} \sum (x_i - \mu)^2 \right)\)</span> at the estimators: <span class="math display">\[L(\hat{\mu}, \hat{\sigma}^2) \propto (\hat{\sigma}^2)^{-n/2} e^{-n/2}\]</span> <span class="math display">\[L(\hat{\mu}_0, \hat{\sigma}_0^2) \propto (\hat{\sigma}_0^2)^{-n/2} e^{-n/2}\]</span></p>
<p>The ratio simplifies to a function of the variances: <span class="math display">\[\Lambda(\mathbf{x}) = \frac{(\hat{\sigma}_0^2)^{-n/2}}{(\hat{\sigma}^2)^{-n/2}} = \left( \frac{\hat{\sigma}^2}{\hat{\sigma}_0^2} \right)^{n/2}\]</span></p></li>
<li><p><strong>Relate to the t-statistic</strong></p>
<p>We use the decomposition of the sum of squares <span class="math inline">\(\sum (X_i - \mu_0)^2 = \sum (X_i - \bar{X})^2 + n(\bar{X} - \mu_0)^2\)</span>. Dividing by <span class="math inline">\(n\)</span> gives <span class="math inline">\(\hat{\sigma}_0^2 = \hat{\sigma}^2 + (\bar{X} - \mu_0)^2\)</span>.</p>
<p>Substituting this into the ratio: <span class="math display">\[\Lambda(\mathbf{x}) = \left( \frac{\hat{\sigma}^2}{\hat{\sigma}^2 + (\bar{X} - \mu_0)^2} \right)^{n/2} = \left( \frac{1}{1 + \frac{(\bar{X} - \mu_0)^2}{\hat{\sigma}^2}} \right)^{n/2}\]</span></p>
<p>Recall the t-statistic <span class="math inline">\(T = \frac{\bar{X} - \mu_0}{S/\sqrt{n}}\)</span>, where <span class="math inline">\(S^2 = \frac{n}{n-1}\hat{\sigma}^2\)</span>. The term in the denominator can be rewritten as: <span class="math display">\[\frac{(\bar{X} - \mu_0)^2}{\hat{\sigma}^2} = \frac{(\bar{X} - \mu_0)^2}{\frac{n-1}{n} S^2} = \frac{T^2}{n-1}\]</span></p>
<p>Thus, the LRT statistic is a monotone function of <span class="math inline">\(T^2\)</span>: <span class="math display">\[\Lambda(\mathbf{x}) = \left( 1 + \frac{T^2}{n-1} \right)^{-n/2}\]</span></p>
<p>Rejecting <span class="math inline">\(H_0\)</span> for small <span class="math inline">\(\Lambda\)</span> is equivalent to rejecting for large values of <span class="math inline">\(T^2\)</span> (or <span class="math inline">\(|T|\)</span>). Therefore, in this case, the LRT is equivalent to the classic <strong>Two-Sample t-test</strong>.</p></li>
<li><p><strong>Asymptotic Distribution (Wilks’ Theorem)</strong></p>
<p>According to Wilks’ Theorem, <span class="math inline">\(-2 \ln \Lambda \xrightarrow{d} \chi^2_1\)</span>. We can verify this relationship using the Taylor expansion <span class="math inline">\(\ln(1+x) \approx x\)</span>: <span class="math display">\[-2 \ln \Lambda = n \ln\left( 1 + \frac{T^2}{n-1} \right) \approx n \left( \frac{T^2}{n-1} \right) \approx T^2\]</span> Since <span class="math inline">\(T \xrightarrow{d} Z\)</span> as <span class="math inline">\(n \to \infty\)</span>, <span class="math inline">\(T^2 \xrightarrow{d} \chi^2_1\)</span>.</p></li>
</ol>
</div>
</section>
</section>
<section id="historical-notes-neyman-pearson-wilks-and-karlin-rubin" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="historical-notes-neyman-pearson-wilks-and-karlin-rubin"><span class="header-section-number">4.6</span> Historical Notes: Neyman-Pearson, Wilks, and Karlin-Rubin</h2>
<ol type="1">
<li><p><strong>The Foundation: Neyman &amp; Pearson (1928, 1933)</strong></p>
<p>In <strong>1928</strong>, Jerzy Neyman and Egon Pearson published <em>On the Use and Interpretation of Certain Test Criteria for Purposes of Statistical Inference</em>. In this landmark paper, they introduced the likelihood ratio <span class="math inline">\(\lambda\)</span> as a general principle for constructing tests. However, at this stage, they relied on ad-hoc methods to find the distribution of <span class="math inline">\(\lambda\)</span> for specific cases (like the t-test or F-test) and merely conjectured that it might follow a Chi-square distribution in the limit.</p>
<p>In <strong>1933</strong>, they published their most famous work, <em>On the Problem of the Most Efficient Tests of Statistical Hypotheses</em>. This paper established the <strong>Neyman-Pearson Lemma</strong>, proving that for testing a <strong>simple</strong> null against a <strong>simple</strong> alternative (no unknown nuisance parameters), the Likelihood Ratio test is Uniformly Most Powerful (UMP).</p></li>
<li><p><strong>The Gap: The Problem of Composite Hypotheses</strong></p>
<p>While Neyman and Pearson proved that the LR test was “optimal” for simple cases, two major problems remained for <strong>composite hypotheses</strong> (cases where parameters are free or tested as inequalities, e.g., <span class="math inline">\(H_0: \theta \le \theta_0\)</span>):</p>
<ul>
<li><strong>Distributional:</strong> How do we find critical values when nuisance parameters are present?</li>
<li><strong>Optimality:</strong> Does a UMP test even exist when the alternative is not a single point?</li>
</ul></li>
<li><p><strong>The Asymptotic Solution: S.S. Wilks (1938)</strong></p>
<p>Five years after the NP Lemma, <strong>Samuel S. Wilks</strong> published <em>The Large-Sample Distribution of the Likelihood Ratio for Testing Composite Hypotheses</em> (1938).</p>
<p>Wilks, a student of Henryietz Rietz influenced by Neyman and Pearson, provided the general solution for the <strong>distributional</strong> problem. He proved mathematically that as <span class="math inline">\(n \to \infty\)</span>, the distribution of <span class="math inline">\(-2 \ln \Lambda\)</span> does not depend on the specific form of the underlying density, but purely on the <strong>number of free parameters</strong> (<span class="math inline">\(k = p_1 - p_0\)</span>). This made the LRT universally applicable for large samples.</p></li>
<li><p><strong>The Finite-Sample Optimality: Karlin-Rubin (1956)</strong></p>
<p>While Wilks handled the asymptotics, the question of exact <strong>optimality</strong> for composite hypotheses remained tricky. In <strong>1956</strong>, Samuel Karlin and Herman Rubin formalized the condition of <strong>Monotone Likelihood Ratio (MLR)</strong>.</p>
<p>The <strong>Karlin-Rubin Theorem</strong> extended the logic of the Neyman-Pearson Lemma to <strong>one-sided</strong> composite hypotheses (<span class="math inline">\(H_0: \theta \le \theta_0\)</span> vs <span class="math inline">\(H_1: \theta &gt; \theta_0\)</span>). They proved that if the family of distributions possesses the MLR property (e.g., Normal, Exponential, Binomial), then the test based on the sufficient statistic is indeed UMP. This result completed the theoretical foundation, delineating exactly when a “perfect” test exists for finite samples.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="./bayesian.html" class="pagination-link" aria-label="Bayesian Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./expofam.html" class="pagination-link" aria-label="Exponential Families">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exponential Families</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>