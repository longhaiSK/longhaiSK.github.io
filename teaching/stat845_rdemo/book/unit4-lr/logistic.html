<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">

<title>6&nbsp; Logistic Regression – Statistical Inference and Learning Methods for Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../unit5-factor/crbd.html" rel="next">
<link href="../unit3-mlr/residuals.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-0de45b8b5f35a93596f1d788d60c4c11.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9f849cbbbd34ccda4fce30280e8b4082.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../resources/mystyles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../unit4-lr/logistic.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistical Inference and Learning Methods for Research</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit1-introR/introR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Science with R and Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit2-slr/slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit3-mlr/mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit3-mlr/residuals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Residual Diagnostics for Regression Modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit4-lr/logistic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit5-factor/crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">One-factor Design and Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../unit6-factorial/factorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Factorial Design and Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<section id="odds-as-a-function-of-probability" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="odds-as-a-function-of-probability"><span class="header-section-number">6.1</span> Odds as a Function of Probability</h2>
<p>For an event with probability <span class="math inline">\(p\)</span>, the odds is <span class="math display">\[\mathrm{odds}(p)=\frac{p}{1-p}\]</span> and the log-odds (logit) is <span class="math display">\[\mathrm{logit}(p)=\log\left(\frac{p}{1-p}\right)\]</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot odds(p) with a right-hand axis for log(odds(p)),</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## using different line colors for the two curves.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Defaults: p in [0.01, 0.99].</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Args:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   p_min, p_max : endpoints for p-grid (0&lt;p_min&lt;p_max&lt;1)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   n            : number of grid points</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   annotate     : add reference lines/labels if TRUE</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   odds_col     : color for odds(p)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   logit_col    : color for log(odds(p))</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   lwd1, lwd2   : line widths for the two curves</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plot_odds <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">p_min =</span> <span class="fl">0.01</span>, <span class="at">p_max =</span> <span class="fl">0.99</span>, <span class="at">n =</span> <span class="dv">400</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">annotate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">odds_col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">logit_col =</span> <span class="st">"firebrick"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">lwd1 =</span> <span class="dv">2</span>, <span class="at">lwd2 =</span> <span class="dv">2</span>) {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(p_min <span class="sc">&gt;</span> <span class="dv">0</span>, p_max <span class="sc">&lt;</span> <span class="dv">1</span>, p_min <span class="sc">&lt;</span> p_max, n <span class="sc">&gt;=</span> <span class="dv">10</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">seq</span>(p_min, p_max, <span class="at">length.out =</span> n)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  odds <span class="ot">&lt;-</span> p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  logit <span class="ot">&lt;-</span> <span class="fu">log</span>(odds)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Left y-axis: odds(p)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(p, odds, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> lwd1, <span class="at">col =</span> odds_col,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Probability p"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"odds(p) = p / (1 - p)"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (annotate) {</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">v =</span> <span class="fl">0.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.52</span>, <span class="fl">1.05</span>, <span class="st">"p = 0.5 → odds = 1"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Right y-axis: logit(p) = log(odds)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">on.exit</span>(<span class="fu">par</span>(op), <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(p, logit, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> lwd2, <span class="at">col =</span> logit_col,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">"log{odds(p)} = log{p/(1 - p)}"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (annotate) {</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># logit(0.5) = 0 reference (horizontal) on the right-axis scale</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">segments</span>(<span class="at">x0 =</span> usr[<span class="dv">1</span>], <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">x1 =</span> <span class="fl">0.5</span>, <span class="at">y1 =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"odds(p)"</span>, <span class="st">"log{odds(p)}"</span>),</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(odds_col, logit_col),</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="fu">c</span>(lwd1, lwd2), <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="fu">list</span>(<span class="at">p =</span> p, <span class="at">odds =</span> odds, <span class="at">logit =</span> logit))</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="do">## Example usage:</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="do">## plot_odds()  # defaults: steelblue for odds, firebrick for log-odds (right axis)</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_odds</span>(<span class="at">odds_col =</span> <span class="st">"#1f77b4"</span>, <span class="at">logit_col =</span> <span class="st">"#d62728"</span>, <span class="at">n =</span> <span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/plot-odds-colored-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logistic-regression" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">6.2</span> Logistic Regression</h2>
<p>Let <span class="math inline">\(Y_i \in \{0,1\}\)</span> denote a binary outcome, and let <span class="math inline">\(\mathbf{x}_i = (x_{i1}, \ldots, x_{ip})^\top\)</span> be the vector of predictors <strong>excluding</strong> the intercept.<br>
Let <span class="math inline">\(\boldsymbol{\beta} = (\beta_1, \ldots, \beta_p)^\top\)</span> denote the slope coefficients, and <span class="math inline">\(\beta_0\)</span> the intercept.<br>
The logistic regression model specifies <span class="math display">\[
p_i \;=\; P(Y_i = 1 \mid \mathbf{x}_i),
\]</span> with <span class="math display">\[
\log\!\left(\frac{p_i}{1 - p_i}\right)
\;=\; \beta_0 + \mathbf{x}_i^\top \boldsymbol{\beta}
\;=\; \beta_0 + \sum_{j=1}^p \beta_j x_{ij}.
\]</span></p>
<p>Equivalently, the fitted probability is <span class="math display">\[
p_i(\mathbf{x}_i;\boldsymbol{\beta})
\;=\;
\frac{\exp(\beta_0 + \mathbf{x}_i^\top \boldsymbol{\beta})}
     {1+\exp(\beta_0 + \mathbf{x}_i^\top \boldsymbol{\beta})}
\;=\;
\frac{1}{1+\exp\!\big(-(\beta_0 + \mathbf{x}_i^\top \boldsymbol{\beta})\big)}.
\]</span></p>
<p>This formulation expresses the <strong>log-odds</strong> of success as a linear function of predictors, ensuring that fitted probabilities remain in the range <span class="math inline">\((0,1)\)</span>.<br>
The <strong>odds</strong> satisfy <span class="math display">\[
\frac{p_i}{1-p_i} \;=\; \exp(\beta_0 + \mathbf{x}_i^\top \boldsymbol{\beta}),
\]</span> so a one-unit increase in <span class="math inline">\(x_{ij}\)</span> (holding other predictors fixed) multiplies the odds of success by <span class="math inline">\(\exp(\beta_j)\)</span>.</p>
</section>
<section id="a-dataset-simulated-from-logistic-regression" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="a-dataset-simulated-from-logistic-regression"><span class="header-section-number">6.3</span> A Dataset Simulated from Logistic Regression</h2>
<p>We simulate data from a logistic model where the <strong>logit</strong> is a linear function of <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\operatorname{logit}{p(x)}
=
\log\left(\frac{p(x)}{1-p(x)}\right)
=
\beta_0 + \beta_1 x,
\]</span></p>
<p>so that</p>
<p><span class="math display">\[
p(x)
=
\operatorname{logit}^{-1}(\beta_0+\beta_1 x)
=
\frac{1}{1+\exp\{-(\beta_0+\beta_1 x)\}}.
\]</span></p>
<p>We then display the observed <span class="math inline">\(y_i\)</span> (binary outcomes) and the true probability curve <span class="math inline">\(p(x)\)</span> in red.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## -- Truth (edit as desired) --</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n     <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span>  <span class="dv">4</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -- Simulate --</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>x   <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)             <span class="co"># predictor</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> x</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>p   <span class="ot">&lt;-</span> <span class="fu">plogis</span>(eta)                 <span class="co"># true p(x)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>y   <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p) <span class="co"># outcomes</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>sim.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">p =</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fit-a-logistic-model-to-the-simulated-data" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="fit-a-logistic-model-to-the-simulated-data"><span class="header-section-number">6.3.1</span> Fit a logistic model to the simulated data</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## -- Optional: fit a model to the simulated data --</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sim.fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim.data, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>p_fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(sim.fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x), <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## -- Plot: points for y_i (jittered), red line for true p(x) --</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Define jitter amount</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>jit <span class="ot">&lt;-</span> <span class="fl">0.05</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">## jitter to separate 0/1 visually</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>yj <span class="ot">&lt;-</span> <span class="fu">jitter</span>(sim.data<span class="sc">$</span>y, <span class="at">amount =</span> jit) </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim.data<span class="sc">$</span>x, yj,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.45</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Observed y (points) &amp; p(x) (curves)"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="do">## True probability curve (red)</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>xg <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xg, <span class="fu">plogis</span>(beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> xg), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Optional: add fitted probability curve (dashed dark red)</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xg, <span class="fu">predict</span>(sim.fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xg), <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"y (jittered points)"</span>, <span class="st">"true p(x)"</span>, <span class="st">"fitted p(x)"</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch    =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty    =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col    =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.45</span>), <span class="st">"red"</span>, <span class="st">"darkred"</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd    =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty    =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="example-coronary-heart-disease-data" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="example-coronary-heart-disease-data"><span class="header-section-number">6.4</span> Example: Coronary Heart Disease Data</h2>
<section id="load-a-dataset" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="load-a-dataset"><span class="header-section-number">6.4.1</span> Load a dataset</h3>
<p>This dataset is about a follow-up study to determine the development of coronary heart disease (CHD) over 9 years of follow-up of 609 white males from Evans County, Georgia.</p>
<p><strong>Variable meanings (as provided):</strong></p>
<ul>
<li><code>chd</code>: 1 if a person has the disease, 0 otherwise.</li>
<li><code>smk</code>: 1 if smoker, 0 if not.</li>
<li><code>cat</code>: 1 if catecholamine level is high, 0 if low.</li>
<li><code>sbp</code>: systolic blood pressure (continuous).</li>
<li><code>age</code>: age in years (continuous).</li>
<li><code>chl</code>: cholesterol level (continuous).</li>
<li><code>ecg</code>: 1 if electrocardiogram is abnormal, 0 if normal.</li>
<li><code>hpt</code>: 1 if high blood pressure, 0 if normal.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust the path if needed. The default is your original V: drive path.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">"evans.dat"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Read data (expects a header row)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>CHD.data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(data_path, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_html_output</span>()){</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  CHD.data</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span>{</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  CHD.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["chd"],"name":[2],"type":["int"],"align":["right"]},{"label":["age"],"name":[3],"type":["int"],"align":["right"]},{"label":["cat"],"name":[4],"type":["int"],"align":["right"]},{"label":["chl"],"name":[5],"type":["int"],"align":["right"]},{"label":["dbp"],"name":[6],"type":["int"],"align":["right"]},{"label":["ecg"],"name":[7],"type":["int"],"align":["right"]},{"label":["sbp"],"name":[8],"type":["int"],"align":["right"]},{"label":["smk"],"name":[9],"type":["int"],"align":["right"]},{"label":["hpt"],"name":[10],"type":["int"],"align":["right"]}],"data":[{"1":"21","2":"0","3":"56","4":"0","5":"270","6":"80","7":"0","8":"138","9":"0","10":"0"},{"1":"31","2":"0","3":"43","4":"0","5":"159","6":"74","7":"0","8":"128","9":"1","10":"0"},{"1":"51","2":"1","3":"56","4":"1","5":"201","6":"112","7":"1","8":"164","9":"1","10":"1"},{"1":"71","2":"0","3":"64","4":"1","5":"179","6":"100","7":"0","8":"200","9":"1","10":"1"},{"1":"74","2":"0","3":"49","4":"0","5":"243","6":"82","7":"0","8":"145","9":"1","10":"0"},{"1":"91","2":"0","3":"46","4":"0","5":"252","6":"88","7":"0","8":"142","9":"1","10":"0"},{"1":"111","2":"1","3":"52","4":"0","5":"179","6":"80","7":"1","8":"128","9":"1","10":"0"},{"1":"131","2":"0","3":"63","4":"0","5":"217","6":"92","7":"0","8":"135","9":"0","10":"0"},{"1":"141","2":"0","3":"42","4":"0","5":"176","6":"76","7":"0","8":"114","9":"1","10":"0"},{"1":"191","2":"0","3":"55","4":"0","5":"250","6":"114","7":"1","8":"182","9":"0","10":"1"},{"1":"201","2":"0","3":"74","4":"0","5":"293","6":"100","7":"0","8":"166","9":"0","10":"1"},{"1":"241","2":"0","3":"53","4":"0","5":"179","6":"90","7":"0","8":"158","9":"0","10":"0"},{"1":"251","2":"0","3":"58","4":"0","5":"201","6":"86","7":"0","8":"142","9":"1","10":"0"},{"1":"261","2":"0","3":"56","4":"0","5":"206","6":"85","7":"0","8":"120","9":"1","10":"0"},{"1":"271","2":"0","3":"69","4":"0","5":"225","6":"84","7":"0","8":"168","9":"0","10":"1"},{"1":"283","2":"1","3":"51","4":"1","5":"259","6":"102","7":"1","8":"135","9":"0","10":"1"},{"1":"291","2":"0","3":"43","4":"0","5":"193","6":"78","7":"0","8":"118","9":"1","10":"0"},{"1":"311","2":"0","3":"64","4":"1","5":"185","6":"100","7":"1","8":"180","9":"0","10":"1"},{"1":"312","2":"0","3":"44","4":"0","5":"150","6":"108","7":"0","8":"160","9":"0","10":"1"},{"1":"331","2":"0","3":"42","4":"0","5":"211","6":"86","7":"1","8":"122","9":"0","10":"0"},{"1":"351","2":"0","3":"57","4":"0","5":"216","6":"88","7":"0","8":"130","9":"0","10":"0"},{"1":"381","2":"1","3":"64","4":"1","5":"247","6":"75","7":"1","8":"130","9":"0","10":"0"},{"1":"401","2":"0","3":"49","4":"0","5":"200","6":"82","7":"0","8":"130","9":"0","10":"0"},{"1":"411","2":"0","3":"68","4":"1","5":"205","6":"74","7":"0","8":"152","9":"1","10":"0"},{"1":"431","2":"0","3":"41","4":"0","5":"225","6":"98","7":"0","8":"135","9":"1","10":"1"},{"1":"441","2":"0","3":"64","4":"0","5":"263","6":"98","7":"0","8":"162","9":"1","10":"1"},{"1":"451","2":"0","3":"41","4":"0","5":"205","6":"80","7":"0","8":"120","9":"0","10":"0"},{"1":"481","2":"0","3":"59","4":"0","5":"253","6":"98","7":"0","8":"154","9":"0","10":"1"},{"1":"501","2":"0","3":"50","4":"0","5":"282","6":"90","7":"0","8":"142","9":"1","10":"0"},{"1":"521","2":"0","3":"56","4":"0","5":"230","6":"80","7":"0","8":"118","9":"0","10":"0"},{"1":"541","2":"0","3":"57","4":"1","5":"203","6":"112","7":"0","8":"182","9":"0","10":"1"},{"1":"561","2":"0","3":"42","4":"0","5":"211","6":"86","7":"0","8":"144","9":"0","10":"0"},{"1":"571","2":"0","3":"59","4":"0","5":"234","6":"84","7":"0","8":"164","9":"1","10":"1"},{"1":"581","2":"0","3":"44","4":"0","5":"202","6":"94","7":"1","8":"174","9":"1","10":"1"},{"1":"611","2":"0","3":"52","4":"0","5":"162","6":"78","7":"0","8":"134","9":"1","10":"0"},{"1":"621","2":"0","3":"45","4":"0","5":"191","6":"85","7":"0","8":"135","9":"0","10":"0"},{"1":"641","2":"0","3":"41","4":"0","5":"220","6":"110","7":"0","8":"178","9":"0","10":"1"},{"1":"651","2":"0","3":"59","4":"0","5":"240","6":"80","7":"0","8":"130","9":"0","10":"0"},{"1":"671","2":"0","3":"52","4":"0","5":"189","6":"110","7":"0","8":"168","9":"0","10":"1"},{"1":"681","2":"0","3":"64","4":"0","5":"247","6":"102","7":"0","8":"170","9":"0","10":"1"},{"1":"731","2":"0","3":"46","4":"0","5":"181","6":"122","7":"1","8":"176","9":"1","10":"1"},{"1":"741","2":"0","3":"42","4":"0","5":"168","6":"75","7":"0","8":"104","9":"1","10":"0"},{"1":"751","2":"0","3":"54","4":"0","5":"187","6":"86","7":"0","8":"146","9":"1","10":"0"},{"1":"761","2":"0","3":"48","4":"0","5":"196","6":"98","7":"0","8":"130","9":"0","10":"1"},{"1":"811","2":"0","3":"45","4":"0","5":"155","6":"70","7":"0","8":"142","9":"1","10":"0"},{"1":"851","2":"0","3":"66","4":"1","5":"173","6":"100","7":"0","8":"160","9":"1","10":"1"},{"1":"861","2":"0","3":"41","4":"0","5":"138","6":"70","7":"0","8":"115","9":"1","10":"0"},{"1":"871","2":"0","3":"76","4":"0","5":"269","6":"94","7":"0","8":"175","9":"1","10":"1"},{"1":"881","2":"1","3":"49","4":"0","5":"266","6":"102","7":"0","8":"152","9":"1","10":"1"},{"1":"921","2":"0","3":"57","4":"1","5":"200","6":"100","7":"0","8":"160","9":"1","10":"1"},{"1":"941","2":"0","3":"51","4":"0","5":"188","6":"84","7":"0","8":"124","9":"1","10":"0"},{"1":"961","2":"1","3":"43","4":"0","5":"218","6":"108","7":"1","8":"136","9":"1","10":"1"},{"1":"971","2":"0","3":"43","4":"0","5":"212","6":"80","7":"1","8":"108","9":"1","10":"0"},{"1":"981","2":"0","3":"45","4":"0","5":"212","6":"102","7":"0","8":"150","9":"1","10":"1"},{"1":"991","2":"0","3":"45","4":"0","5":"180","6":"80","7":"0","8":"122","9":"1","10":"0"},{"1":"1061","2":"1","3":"46","4":"1","5":"166","6":"76","7":"1","8":"162","9":"0","10":"1"},{"1":"1071","2":"0","3":"40","4":"0","5":"257","6":"84","7":"0","8":"130","9":"0","10":"0"},{"1":"1081","2":"0","3":"48","4":"0","5":"243","6":"82","7":"1","8":"154","9":"1","10":"0"},{"1":"1091","2":"0","3":"64","4":"1","5":"179","6":"100","7":"1","8":"148","9":"1","10":"1"},{"1":"1111","2":"0","3":"70","4":"0","5":"167","6":"64","7":"0","8":"112","9":"1","10":"0"},{"1":"1151","2":"0","3":"52","4":"0","5":"178","6":"84","7":"1","8":"112","9":"1","10":"0"},{"1":"1171","2":"0","3":"55","4":"0","5":"178","6":"94","7":"0","8":"152","9":"0","10":"0"},{"1":"1181","2":"0","3":"49","4":"0","5":"211","6":"68","7":"0","8":"114","9":"1","10":"0"},{"1":"1191","2":"1","3":"56","4":"0","5":"171","6":"85","7":"0","8":"125","9":"1","10":"0"},{"1":"1201","2":"1","3":"66","4":"1","5":"205","6":"80","7":"0","8":"150","9":"1","10":"0"},{"1":"1221","2":"0","3":"48","4":"0","5":"229","6":"130","7":"0","8":"195","9":"1","10":"1"},{"1":"1231","2":"0","3":"47","4":"0","5":"238","6":"120","7":"1","8":"160","9":"1","10":"1"},{"1":"1471","2":"0","3":"54","4":"1","5":"195","6":"112","7":"0","8":"174","9":"1","10":"1"},{"1":"1501","2":"0","3":"44","4":"0","5":"162","6":"82","7":"0","8":"120","9":"0","10":"0"},{"1":"1561","2":"0","3":"51","4":"0","5":"240","6":"84","7":"1","8":"126","9":"1","10":"0"},{"1":"1691","2":"0","3":"43","4":"0","5":"177","6":"102","7":"1","8":"138","9":"1","10":"1"},{"1":"1701","2":"0","3":"68","4":"0","5":"252","6":"88","7":"1","8":"112","9":"1","10":"0"},{"1":"1741","2":"0","3":"49","4":"0","5":"217","6":"105","7":"0","8":"148","9":"0","10":"1"},{"1":"1751","2":"0","3":"55","4":"0","5":"263","6":"84","7":"0","8":"114","9":"0","10":"0"},{"1":"1761","2":"0","3":"51","4":"0","5":"229","6":"100","7":"0","8":"162","9":"1","10":"1"},{"1":"1791","2":"0","3":"50","4":"0","5":"245","6":"96","7":"0","8":"144","9":"0","10":"1"},{"1":"1811","2":"0","3":"65","4":"0","5":"177","6":"74","7":"0","8":"122","9":"0","10":"0"},{"1":"1821","2":"0","3":"42","4":"0","5":"203","6":"78","7":"0","8":"134","9":"1","10":"0"},{"1":"1851","2":"0","3":"57","4":"0","5":"194","6":"75","7":"1","8":"114","9":"0","10":"0"},{"1":"1881","2":"0","3":"42","4":"0","5":"288","6":"110","7":"0","8":"142","9":"0","10":"1"},{"1":"1891","2":"0","3":"53","4":"0","5":"217","6":"70","7":"0","8":"120","9":"1","10":"0"},{"1":"1901","2":"0","3":"57","4":"1","5":"163","6":"94","7":"0","8":"184","9":"0","10":"1"},{"1":"1911","2":"0","3":"61","4":"0","5":"180","6":"84","7":"0","8":"136","9":"0","10":"0"},{"1":"1951","2":"0","3":"53","4":"0","5":"209","6":"98","7":"0","8":"142","9":"1","10":"1"},{"1":"1961","2":"0","3":"45","4":"0","5":"200","6":"80","7":"0","8":"135","9":"0","10":"0"},{"1":"1971","2":"0","3":"44","4":"0","5":"194","6":"80","7":"0","8":"120","9":"1","10":"0"},{"1":"2241","2":"0","3":"63","4":"0","5":"227","6":"90","7":"1","8":"135","9":"0","10":"0"},{"1":"2252","2":"0","3":"42","4":"0","5":"158","6":"92","7":"0","8":"135","9":"1","10":"0"},{"1":"2273","2":"0","3":"73","4":"1","5":"183","6":"120","7":"1","8":"220","9":"0","10":"1"},{"1":"2281","2":"0","3":"47","4":"0","5":"253","6":"110","7":"0","8":"140","9":"1","10":"1"},{"1":"2311","2":"0","3":"56","4":"0","5":"198","6":"88","7":"0","8":"122","9":"1","10":"0"},{"1":"2371","2":"1","3":"41","4":"0","5":"228","6":"132","7":"0","8":"162","9":"1","10":"1"},{"1":"2381","2":"0","3":"58","4":"0","5":"217","6":"86","7":"0","8":"140","9":"0","10":"0"},{"1":"2391","2":"0","3":"55","4":"0","5":"163","6":"70","7":"0","8":"110","9":"1","10":"0"},{"1":"2401","2":"0","3":"46","4":"0","5":"212","6":"124","7":"0","8":"184","9":"1","10":"1"},{"1":"2461","2":"0","3":"57","4":"0","5":"144","6":"95","7":"0","8":"130","9":"0","10":"1"},{"1":"2481","2":"0","3":"44","4":"0","5":"134","6":"74","7":"0","8":"114","9":"1","10":"0"},{"1":"2501","2":"0","3":"52","4":"1","5":"183","6":"96","7":"0","8":"158","9":"1","10":"1"},{"1":"2511","2":"0","3":"56","4":"0","5":"212","6":"108","7":"0","8":"144","9":"0","10":"1"},{"1":"2531","2":"0","3":"64","4":"0","5":"214","6":"82","7":"0","8":"128","9":"1","10":"0"},{"1":"2541","2":"0","3":"54","4":"0","5":"249","6":"92","7":"0","8":"120","9":"1","10":"0"},{"1":"2571","2":"0","3":"52","4":"0","5":"180","6":"78","7":"1","8":"104","9":"1","10":"0"},{"1":"2591","2":"0","3":"42","4":"0","5":"212","6":"92","7":"0","8":"125","9":"1","10":"0"},{"1":"2611","2":"0","3":"46","4":"0","5":"167","6":"82","7":"0","8":"120","9":"1","10":"0"},{"1":"2621","2":"0","3":"46","4":"0","5":"273","6":"94","7":"0","8":"152","9":"0","10":"0"},{"1":"2631","2":"0","3":"42","4":"0","5":"210","6":"96","7":"0","8":"134","9":"1","10":"1"},{"1":"2641","2":"0","3":"54","4":"1","5":"173","6":"110","7":"0","8":"170","9":"1","10":"1"},{"1":"2671","2":"0","3":"43","4":"0","5":"256","6":"72","7":"0","8":"114","9":"1","10":"0"},{"1":"2681","2":"0","3":"53","4":"0","5":"234","6":"80","7":"0","8":"122","9":"0","10":"0"},{"1":"2691","2":"1","3":"40","4":"0","5":"221","6":"100","7":"0","8":"140","9":"1","10":"1"},{"1":"2711","2":"0","3":"46","4":"0","5":"261","6":"86","7":"0","8":"128","9":"1","10":"0"},{"1":"2731","2":"0","3":"43","4":"0","5":"299","6":"80","7":"0","8":"116","9":"0","10":"0"},{"1":"2851","2":"0","3":"43","4":"0","5":"192","6":"75","7":"0","8":"115","9":"1","10":"0"},{"1":"2861","2":"0","3":"47","4":"0","5":"185","6":"80","7":"1","8":"146","9":"1","10":"0"},{"1":"2871","2":"0","3":"44","4":"0","5":"283","6":"70","7":"0","8":"108","9":"1","10":"0"},{"1":"2881","2":"0","3":"49","4":"0","5":"176","6":"92","7":"0","8":"134","9":"1","10":"0"},{"1":"2891","2":"1","3":"56","4":"1","5":"331","6":"110","7":"0","8":"190","9":"1","10":"1"},{"1":"2901","2":"1","3":"56","4":"0","5":"203","6":"82","7":"0","8":"120","9":"1","10":"0"},{"1":"2911","2":"0","3":"64","4":"1","5":"217","6":"92","7":"0","8":"166","9":"1","10":"1"},{"1":"2921","2":"0","3":"54","4":"0","5":"164","6":"72","7":"0","8":"122","9":"1","10":"0"},{"1":"2931","2":"0","3":"54","4":"0","5":"256","6":"98","7":"0","8":"148","9":"0","10":"1"},{"1":"2991","2":"0","3":"51","4":"0","5":"184","6":"98","7":"0","8":"170","9":"0","10":"1"},{"1":"3001","2":"0","3":"49","4":"0","5":"165","6":"80","7":"0","8":"114","9":"1","10":"0"},{"1":"3011","2":"0","3":"47","4":"0","5":"189","6":"92","7":"0","8":"145","9":"0","10":"0"},{"1":"3031","2":"0","3":"58","4":"0","5":"221","6":"88","7":"0","8":"140","9":"1","10":"0"},{"1":"3061","2":"0","3":"70","4":"1","5":"126","6":"66","7":"1","8":"164","9":"1","10":"1"},{"1":"3601","2":"0","3":"42","4":"0","5":"169","6":"80","7":"1","8":"122","9":"1","10":"0"},{"1":"3611","2":"0","3":"59","4":"0","5":"266","6":"92","7":"0","8":"138","9":"0","10":"0"},{"1":"3621","2":"0","3":"57","4":"1","5":"153","6":"92","7":"0","8":"148","9":"1","10":"0"},{"1":"3651","2":"0","3":"76","4":"1","5":"211","6":"114","7":"1","8":"228","9":"1","10":"1"},{"1":"3661","2":"0","3":"43","4":"0","5":"113","6":"76","7":"0","8":"114","9":"1","10":"0"},{"1":"3701","2":"0","3":"46","4":"0","5":"200","6":"85","7":"0","8":"145","9":"1","10":"0"},{"1":"3721","2":"0","3":"75","4":"1","5":"172","6":"114","7":"1","8":"162","9":"1","10":"1"},{"1":"3751","2":"0","3":"42","4":"0","5":"131","6":"84","7":"0","8":"130","9":"0","10":"0"},{"1":"3761","2":"0","3":"64","4":"0","5":"214","6":"84","7":"0","8":"120","9":"0","10":"0"},{"1":"3771","2":"0","3":"63","4":"1","5":"236","6":"94","7":"1","8":"190","9":"0","10":"1"},{"1":"3791","2":"0","3":"54","4":"0","5":"213","6":"90","7":"0","8":"142","9":"0","10":"0"},{"1":"3811","2":"0","3":"66","4":"0","5":"226","6":"90","7":"0","8":"166","9":"0","10":"1"},{"1":"3813","2":"0","3":"44","4":"0","5":"200","6":"110","7":"0","8":"160","9":"1","10":"1"},{"1":"3841","2":"0","3":"72","4":"0","5":"188","6":"78","7":"0","8":"130","9":"0","10":"0"},{"1":"3861","2":"0","3":"50","4":"0","5":"268","6":"102","7":"0","8":"138","9":"0","10":"1"},{"1":"3871","2":"0","3":"59","4":"1","5":"195","6":"114","7":"1","8":"208","9":"0","10":"1"},{"1":"3881","2":"1","3":"59","4":"0","5":"216","6":"95","7":"0","8":"140","9":"1","10":"1"},{"1":"3891","2":"0","3":"53","4":"0","5":"182","6":"92","7":"0","8":"130","9":"1","10":"0"},{"1":"3901","2":"0","3":"48","4":"0","5":"178","6":"95","7":"0","8":"135","9":"1","10":"1"},{"1":"3911","2":"0","3":"40","4":"0","5":"191","6":"76","7":"0","8":"152","9":"1","10":"0"},{"1":"3941","2":"0","3":"61","4":"0","5":"255","6":"80","7":"0","8":"120","9":"0","10":"0"},{"1":"3951","2":"0","3":"42","4":"0","5":"225","6":"80","7":"0","8":"126","9":"1","10":"0"},{"1":"4161","2":"0","3":"42","4":"0","5":"166","6":"90","7":"0","8":"145","9":"0","10":"0"},{"1":"4191","2":"0","3":"49","4":"0","5":"278","6":"84","7":"0","8":"126","9":"1","10":"0"},{"1":"4202","2":"0","3":"40","4":"0","5":"235","6":"72","7":"0","8":"116","9":"0","10":"0"},{"1":"4221","2":"0","3":"51","4":"0","5":"251","6":"86","7":"0","8":"128","9":"1","10":"0"},{"1":"4242","2":"0","3":"44","4":"0","5":"217","6":"90","7":"0","8":"146","9":"0","10":"0"},{"1":"4261","2":"0","3":"44","4":"0","5":"181","6":"94","7":"0","8":"144","9":"1","10":"0"},{"1":"4271","2":"0","3":"47","4":"0","5":"208","6":"108","7":"0","8":"178","9":"0","10":"1"},{"1":"4291","2":"0","3":"51","4":"0","5":"182","6":"112","7":"0","8":"182","9":"0","10":"1"},{"1":"4301","2":"0","3":"69","4":"0","5":"228","6":"75","7":"0","8":"115","9":"1","10":"0"},{"1":"4321","2":"0","3":"58","4":"1","5":"170","6":"88","7":"1","8":"152","9":"1","10":"0"},{"1":"4331","2":"0","3":"74","4":"1","5":"147","6":"80","7":"1","8":"200","9":"0","10":"1"},{"1":"4341","2":"0","3":"48","4":"0","5":"190","6":"78","7":"0","8":"114","9":"1","10":"0"},{"1":"4381","2":"0","3":"64","4":"0","5":"205","6":"98","7":"1","8":"140","9":"0","10":"1"},{"1":"4401","2":"0","3":"53","4":"0","5":"216","6":"78","7":"0","8":"124","9":"1","10":"0"},{"1":"4411","2":"0","3":"71","4":"0","5":"170","6":"90","7":"0","8":"140","9":"1","10":"0"},{"1":"4421","2":"0","3":"47","4":"0","5":"127","6":"74","7":"0","8":"110","9":"1","10":"0"},{"1":"4451","2":"0","3":"56","4":"0","5":"235","6":"92","7":"0","8":"128","9":"1","10":"0"},{"1":"4461","2":"0","3":"40","4":"0","5":"200","6":"72","7":"0","8":"118","9":"0","10":"0"},{"1":"4491","2":"0","3":"46","4":"0","5":"283","6":"100","7":"0","8":"148","9":"1","10":"1"},{"1":"4531","2":"0","3":"68","4":"1","5":"157","6":"94","7":"0","8":"162","9":"0","10":"1"},{"1":"4551","2":"1","3":"54","4":"0","5":"206","6":"76","7":"1","8":"142","9":"0","10":"0"},{"1":"4581","2":"0","3":"54","4":"0","5":"197","6":"88","7":"0","8":"125","9":"1","10":"0"},{"1":"4591","2":"0","3":"45","4":"0","5":"163","6":"75","7":"0","8":"115","9":"1","10":"0"},{"1":"4601","2":"0","3":"66","4":"0","5":"176","6":"60","7":"1","8":"124","9":"0","10":"0"},{"1":"4641","2":"0","3":"58","4":"0","5":"211","6":"88","7":"0","8":"146","9":"1","10":"0"},{"1":"4681","2":"0","3":"49","4":"0","5":"161","6":"75","7":"0","8":"115","9":"0","10":"0"},{"1":"4711","2":"0","3":"51","4":"0","5":"244","6":"90","7":"0","8":"128","9":"0","10":"0"},{"1":"4731","2":"0","3":"44","4":"0","5":"172","6":"100","7":"0","8":"138","9":"0","10":"1"},{"1":"4751","2":"0","3":"61","4":"1","5":"166","6":"86","7":"0","8":"156","9":"1","10":"0"},{"1":"4771","2":"0","3":"48","4":"0","5":"184","6":"76","7":"0","8":"116","9":"1","10":"0"},{"1":"4781","2":"0","3":"63","4":"0","5":"143","6":"92","7":"0","8":"122","9":"1","10":"0"},{"1":"4791","2":"0","3":"54","4":"0","5":"196","6":"84","7":"0","8":"138","9":"1","10":"0"},{"1":"4801","2":"0","3":"52","4":"0","5":"189","6":"88","7":"0","8":"142","9":"1","10":"0"},{"1":"4811","2":"0","3":"45","4":"0","5":"227","6":"98","7":"1","8":"140","9":"1","10":"1"},{"1":"4821","2":"0","3":"62","4":"0","5":"236","6":"94","7":"0","8":"160","9":"0","10":"1"},{"1":"4831","2":"0","3":"41","4":"0","5":"240","6":"86","7":"0","8":"144","9":"0","10":"0"},{"1":"4851","2":"0","3":"41","4":"0","5":"256","6":"90","7":"0","8":"145","9":"1","10":"0"},{"1":"4861","2":"0","3":"61","4":"0","5":"200","6":"84","7":"0","8":"148","9":"1","10":"0"},{"1":"4871","2":"0","3":"42","4":"0","5":"199","6":"104","7":"0","8":"166","9":"1","10":"1"},{"1":"4901","2":"0","3":"42","4":"0","5":"161","6":"88","7":"0","8":"124","9":"0","10":"0"},{"1":"4911","2":"0","3":"72","4":"0","5":"211","6":"80","7":"1","8":"104","9":"0","10":"0"},{"1":"4951","2":"0","3":"43","4":"0","5":"180","6":"64","7":"0","8":"92","9":"0","10":"0"},{"1":"4961","2":"1","3":"72","4":"0","5":"200","6":"86","7":"1","8":"138","9":"0","10":"0"},{"1":"4971","2":"0","3":"51","4":"0","5":"206","6":"80","7":"0","8":"132","9":"1","10":"0"},{"1":"4981","2":"0","3":"58","4":"0","5":"254","6":"94","7":"0","8":"152","9":"1","10":"0"},{"1":"5011","2":"0","3":"41","4":"0","5":"215","6":"90","7":"0","8":"142","9":"1","10":"0"},{"1":"5061","2":"0","3":"71","4":"1","5":"162","6":"98","7":"1","8":"184","9":"1","10":"1"},{"1":"5071","2":"1","3":"63","4":"0","5":"145","6":"96","7":"0","8":"162","9":"1","10":"1"},{"1":"5091","2":"0","3":"44","4":"0","5":"220","6":"90","7":"1","8":"130","9":"1","10":"0"},{"1":"5101","2":"0","3":"45","4":"0","5":"298","6":"108","7":"0","8":"170","9":"1","10":"1"},{"1":"5111","2":"0","3":"54","4":"0","5":"300","6":"94","7":"0","8":"148","9":"1","10":"0"},{"1":"5131","2":"1","3":"52","4":"1","5":"306","6":"108","7":"0","8":"178","9":"1","10":"1"},{"1":"5141","2":"0","3":"55","4":"0","5":"302","6":"134","7":"1","8":"206","9":"1","10":"1"},{"1":"5181","2":"1","3":"41","4":"0","5":"158","6":"80","7":"0","8":"140","9":"1","10":"0"},{"1":"5191","2":"0","3":"54","4":"0","5":"194","6":"130","7":"1","8":"170","9":"1","10":"1"},{"1":"5211","2":"0","3":"64","4":"1","5":"229","6":"94","7":"1","8":"156","9":"1","10":"0"},{"1":"5251","2":"0","3":"61","4":"0","5":"259","6":"82","7":"0","8":"118","9":"0","10":"0"},{"1":"5281","2":"0","3":"40","4":"0","5":"214","6":"94","7":"0","8":"130","9":"0","10":"0"},{"1":"5301","2":"0","3":"51","4":"0","5":"168","6":"106","7":"0","8":"156","9":"1","10":"1"},{"1":"5361","2":"0","3":"51","4":"0","5":"265","6":"90","7":"0","8":"158","9":"1","10":"0"},{"1":"5391","2":"0","3":"75","4":"0","5":"225","6":"80","7":"0","8":"125","9":"0","10":"0"},{"1":"5421","2":"1","3":"40","4":"0","5":"219","6":"80","7":"0","8":"115","9":"1","10":"0"},{"1":"5451","2":"1","3":"63","4":"0","5":"202","6":"110","7":"0","8":"160","9":"0","10":"1"},{"1":"5461","2":"0","3":"42","4":"1","5":"217","6":"94","7":"1","8":"138","9":"0","10":"0"},{"1":"5471","2":"1","3":"64","4":"0","5":"231","6":"85","7":"0","8":"120","9":"1","10":"0"},{"1":"5521","2":"1","3":"50","4":"0","5":"215","6":"114","7":"0","8":"170","9":"1","10":"1"},{"1":"5601","2":"0","3":"49","4":"0","5":"146","6":"98","7":"1","8":"145","9":"1","10":"1"},{"1":"5621","2":"0","3":"48","4":"0","5":"198","6":"75","7":"0","8":"120","9":"1","10":"0"},{"1":"5631","2":"0","3":"58","4":"0","5":"206","6":"92","7":"0","8":"154","9":"0","10":"0"},{"1":"5641","2":"0","3":"46","4":"0","5":"227","6":"98","7":"0","8":"168","9":"1","10":"1"},{"1":"5671","2":"0","3":"46","4":"0","5":"214","6":"92","7":"1","8":"166","9":"1","10":"1"},{"1":"6341","2":"0","3":"42","4":"0","5":"225","6":"100","7":"1","8":"162","9":"1","10":"1"},{"1":"6351","2":"0","3":"57","4":"0","5":"193","6":"86","7":"0","8":"124","9":"0","10":"0"},{"1":"6371","2":"0","3":"50","4":"0","5":"186","6":"102","7":"0","8":"160","9":"0","10":"1"},{"1":"6391","2":"0","3":"46","4":"0","5":"147","6":"85","7":"0","8":"122","9":"1","10":"0"},{"1":"6411","2":"0","3":"45","4":"0","5":"205","6":"100","7":"0","8":"166","9":"0","10":"1"},{"1":"6421","2":"0","3":"57","4":"1","5":"196","6":"98","7":"1","8":"196","9":"1","10":"1"},{"1":"6441","2":"0","3":"46","4":"0","5":"195","6":"96","7":"0","8":"138","9":"0","10":"1"},{"1":"6451","2":"0","3":"45","4":"1","5":"153","6":"108","7":"1","8":"212","9":"1","10":"1"},{"1":"6461","2":"0","3":"58","4":"1","5":"172","6":"96","7":"1","8":"168","9":"0","10":"1"},{"1":"6482","2":"0","3":"42","4":"0","5":"293","6":"110","7":"0","8":"176","9":"1","10":"1"},{"1":"6491","2":"0","3":"53","4":"0","5":"274","6":"106","7":"0","8":"158","9":"1","10":"1"},{"1":"6501","2":"0","3":"55","4":"0","5":"221","6":"106","7":"0","8":"162","9":"0","10":"1"},{"1":"6511","2":"0","3":"53","4":"0","5":"197","6":"70","7":"0","8":"112","9":"0","10":"0"},{"1":"6531","2":"0","3":"69","4":"1","5":"194","6":"100","7":"1","8":"150","9":"0","10":"1"},{"1":"6551","2":"0","3":"58","4":"0","5":"204","6":"74","7":"0","8":"122","9":"1","10":"0"},{"1":"6561","2":"0","3":"46","4":"0","5":"203","6":"84","7":"0","8":"114","9":"1","10":"0"},{"1":"6591","2":"0","3":"62","4":"0","5":"293","6":"90","7":"1","8":"142","9":"1","10":"0"},{"1":"6631","2":"0","3":"61","4":"0","5":"197","6":"72","7":"1","8":"110","9":"0","10":"0"},{"1":"6641","2":"0","3":"49","4":"0","5":"195","6":"82","7":"0","8":"138","9":"1","10":"0"},{"1":"6651","2":"0","3":"48","4":"0","5":"184","6":"96","7":"0","8":"144","9":"1","10":"1"},{"1":"6661","2":"1","3":"55","4":"0","5":"209","6":"85","7":"0","8":"130","9":"1","10":"0"},{"1":"6681","2":"0","3":"52","4":"1","5":"209","6":"98","7":"1","8":"170","9":"0","10":"1"},{"1":"6691","2":"0","3":"61","4":"0","5":"214","6":"100","7":"0","8":"158","9":"0","10":"1"},{"1":"6721","2":"0","3":"68","4":"1","5":"130","6":"106","7":"1","8":"200","9":"0","10":"1"},{"1":"6731","2":"0","3":"55","4":"0","5":"196","6":"70","7":"0","8":"125","9":"0","10":"0"},{"1":"6741","2":"0","3":"52","4":"1","5":"237","6":"126","7":"1","8":"224","9":"0","10":"1"},{"1":"6751","2":"0","3":"43","4":"0","5":"185","6":"85","7":"1","8":"140","9":"1","10":"0"},{"1":"6761","2":"1","3":"47","4":"0","5":"248","6":"104","7":"1","8":"132","9":"1","10":"1"},{"1":"6781","2":"0","3":"57","4":"0","5":"252","6":"106","7":"0","8":"166","9":"0","10":"1"},{"1":"6791","2":"0","3":"55","4":"0","5":"198","6":"96","7":"0","8":"144","9":"1","10":"1"},{"1":"6801","2":"0","3":"71","4":"0","5":"176","6":"62","7":"0","8":"138","9":"0","10":"0"},{"1":"6811","2":"0","3":"74","4":"1","5":"193","6":"98","7":"1","8":"202","9":"0","10":"1"},{"1":"6821","2":"1","3":"65","4":"0","5":"185","6":"105","7":"0","8":"156","9":"0","10":"1"},{"1":"6831","2":"0","3":"65","4":"0","5":"241","6":"102","7":"1","8":"146","9":"0","10":"1"},{"1":"6871","2":"0","3":"44","4":"0","5":"231","6":"70","7":"0","8":"108","9":"0","10":"0"},{"1":"6881","2":"0","3":"40","4":"0","5":"157","6":"78","7":"1","8":"122","9":"0","10":"0"},{"1":"6891","2":"0","3":"45","4":"0","5":"152","6":"106","7":"1","8":"148","9":"1","10":"1"},{"1":"6911","2":"0","3":"50","4":"0","5":"237","6":"102","7":"0","8":"156","9":"1","10":"1"},{"1":"6921","2":"0","3":"64","4":"1","5":"175","6":"110","7":"1","8":"142","9":"0","10":"1"},{"1":"6931","2":"1","3":"56","4":"0","5":"195","6":"94","7":"1","8":"150","9":"0","10":"0"},{"1":"6941","2":"0","3":"62","4":"1","5":"151","6":"88","7":"0","8":"165","9":"0","10":"1"},{"1":"6961","2":"0","3":"44","4":"0","5":"205","6":"80","7":"0","8":"128","9":"1","10":"0"},{"1":"6981","2":"0","3":"73","4":"0","5":"190","6":"75","7":"0","8":"115","9":"0","10":"0"},{"1":"7001","2":"0","3":"46","4":"0","5":"239","6":"100","7":"0","8":"160","9":"1","10":"1"},{"1":"7021","2":"0","3":"51","4":"0","5":"232","6":"80","7":"0","8":"120","9":"0","10":"0"},{"1":"7031","2":"0","3":"59","4":"1","5":"170","6":"100","7":"0","8":"180","9":"1","10":"1"},{"1":"7051","2":"1","3":"67","4":"1","5":"319","6":"104","7":"0","8":"182","9":"0","10":"1"},{"1":"7091","2":"0","3":"54","4":"0","5":"225","6":"86","7":"0","8":"122","9":"0","10":"0"},{"1":"7101","2":"0","3":"49","4":"0","5":"252","6":"90","7":"0","8":"128","9":"1","10":"0"},{"1":"7121","2":"0","3":"46","4":"0","5":"224","6":"84","7":"0","8":"130","9":"1","10":"0"},{"1":"7131","2":"0","3":"42","4":"1","5":"229","6":"90","7":"1","8":"145","9":"0","10":"0"},{"1":"8641","2":"0","3":"68","4":"0","5":"195","6":"76","7":"1","8":"116","9":"1","10":"0"},{"1":"8651","2":"0","3":"43","4":"0","5":"230","6":"85","7":"1","8":"135","9":"1","10":"0"},{"1":"8671","2":"0","3":"56","4":"1","5":"186","6":"98","7":"1","8":"154","9":"0","10":"1"},{"1":"8682","2":"0","3":"68","4":"1","5":"192","6":"94","7":"0","8":"154","9":"1","10":"0"},{"1":"8711","2":"0","3":"46","4":"0","5":"184","6":"78","7":"0","8":"110","9":"1","10":"0"},{"1":"8721","2":"1","3":"64","4":"1","5":"233","6":"94","7":"0","8":"140","9":"1","10":"0"},{"1":"8731","2":"0","3":"54","4":"0","5":"175","6":"96","7":"0","8":"156","9":"1","10":"1"},{"1":"8751","2":"0","3":"48","4":"0","5":"188","6":"106","7":"0","8":"148","9":"1","10":"1"},{"1":"8771","2":"0","3":"41","4":"0","5":"232","6":"82","7":"0","8":"126","9":"1","10":"0"},{"1":"8811","2":"0","3":"65","4":"1","5":"178","6":"106","7":"1","8":"194","9":"0","10":"1"},{"1":"8841","2":"0","3":"41","4":"0","5":"187","6":"108","7":"0","8":"154","9":"0","10":"1"},{"1":"8851","2":"1","3":"42","4":"0","5":"207","6":"86","7":"1","8":"128","9":"1","10":"0"},{"1":"8971","2":"0","3":"66","4":"0","5":"94","6":"86","7":"0","8":"134","9":"0","10":"0"},{"1":"8981","2":"0","3":"44","4":"0","5":"211","6":"90","7":"0","8":"142","9":"1","10":"0"},{"1":"9011","2":"0","3":"42","4":"0","5":"275","6":"100","7":"1","8":"150","9":"1","10":"1"},{"1":"9021","2":"0","3":"51","4":"0","5":"165","6":"85","7":"0","8":"130","9":"1","10":"0"},{"1":"9031","2":"0","3":"56","4":"0","5":"282","6":"94","7":"0","8":"134","9":"1","10":"0"},{"1":"9051","2":"1","3":"64","4":"1","5":"239","6":"94","7":"0","8":"162","9":"1","10":"1"},{"1":"9061","2":"0","3":"44","4":"0","5":"256","6":"106","7":"0","8":"162","9":"1","10":"1"},{"1":"9071","2":"1","3":"55","4":"0","5":"175","6":"108","7":"0","8":"160","9":"1","10":"1"},{"1":"9091","2":"0","3":"55","4":"0","5":"306","6":"82","7":"0","8":"160","9":"1","10":"1"},{"1":"9101","2":"1","3":"67","4":"0","5":"188","6":"102","7":"1","8":"168","9":"0","10":"1"},{"1":"9191","2":"1","3":"56","4":"1","5":"221","6":"78","7":"1","8":"154","9":"1","10":"0"},{"1":"9201","2":"1","3":"63","4":"1","5":"213","6":"156","7":"1","8":"256","9":"0","10":"1"},{"1":"9261","2":"1","3":"67","4":"0","5":"250","6":"100","7":"0","8":"158","9":"0","10":"1"},{"1":"9471","2":"0","3":"48","4":"0","5":"268","6":"120","7":"0","8":"172","9":"1","10":"1"},{"1":"9601","2":"1","3":"45","4":"0","5":"263","6":"86","7":"0","8":"132","9":"0","10":"0"},{"1":"9631","2":"0","3":"49","4":"0","5":"150","6":"98","7":"1","8":"120","9":"1","10":"1"},{"1":"9651","2":"1","3":"70","4":"1","5":"251","6":"108","7":"1","8":"174","9":"1","10":"1"},{"1":"9671","2":"0","3":"45","4":"0","5":"180","6":"102","7":"0","8":"156","9":"1","10":"1"},{"1":"9681","2":"0","3":"48","4":"0","5":"336","6":"110","7":"0","8":"174","9":"1","10":"1"},{"1":"9711","2":"1","3":"42","4":"0","5":"210","6":"70","7":"0","8":"124","9":"1","10":"0"},{"1":"9721","2":"0","3":"69","4":"1","5":"179","6":"110","7":"0","8":"175","9":"1","10":"1"},{"1":"9731","2":"0","3":"44","4":"0","5":"177","6":"75","7":"0","8":"120","9":"0","10":"0"},{"1":"9751","2":"0","3":"48","4":"0","5":"227","6":"92","7":"0","8":"158","9":"1","10":"0"},{"1":"9791","2":"0","3":"46","4":"0","5":"195","6":"72","7":"0","8":"120","9":"1","10":"0"},{"1":"9801","2":"0","3":"52","4":"0","5":"227","6":"76","7":"0","8":"116","9":"1","10":"0"},{"1":"9811","2":"0","3":"73","4":"0","5":"250","6":"84","7":"0","8":"154","9":"0","10":"0"},{"1":"9831","2":"0","3":"67","4":"0","5":"218","6":"96","7":"1","8":"148","9":"0","10":"1"},{"1":"9841","2":"0","3":"63","4":"0","5":"229","6":"100","7":"0","8":"168","9":"1","10":"1"},{"1":"9871","2":"0","3":"45","4":"1","5":"197","6":"80","7":"1","8":"134","9":"0","10":"0"},{"1":"9881","2":"0","3":"46","4":"0","5":"190","6":"86","7":"0","8":"122","9":"1","10":"0"},{"1":"9891","2":"0","3":"68","4":"1","5":"189","6":"104","7":"1","8":"202","9":"1","10":"1"},{"1":"9901","2":"0","3":"49","4":"0","5":"185","6":"80","7":"0","8":"120","9":"1","10":"0"},{"1":"9911","2":"1","3":"63","4":"0","5":"194","6":"90","7":"0","8":"190","9":"1","10":"1"},{"1":"9931","2":"0","3":"59","4":"0","5":"192","6":"66","7":"0","8":"134","9":"0","10":"0"},{"1":"9941","2":"0","3":"67","4":"1","5":"261","6":"80","7":"1","8":"160","9":"1","10":"1"},{"1":"9951","2":"0","3":"49","4":"0","5":"174","6":"78","7":"1","8":"108","9":"0","10":"0"},{"1":"9961","2":"0","3":"65","4":"1","5":"189","6":"114","7":"1","8":"168","9":"1","10":"1"},{"1":"9981","2":"0","3":"44","4":"0","5":"248","6":"100","7":"0","8":"145","9":"1","10":"1"},{"1":"10011","2":"0","3":"45","4":"0","5":"214","6":"94","7":"0","8":"122","9":"0","10":"0"},{"1":"10041","2":"0","3":"47","4":"0","5":"275","6":"76","7":"0","8":"114","9":"1","10":"0"},{"1":"10051","2":"0","3":"46","4":"0","5":"259","6":"92","7":"0","8":"130","9":"1","10":"0"},{"1":"10071","2":"0","3":"52","4":"0","5":"230","6":"68","7":"0","8":"100","9":"0","10":"0"},{"1":"10091","2":"0","3":"60","4":"0","5":"206","6":"84","7":"0","8":"138","9":"1","10":"0"},{"1":"10121","2":"0","3":"45","4":"0","5":"275","6":"95","7":"0","8":"125","9":"1","10":"1"},{"1":"10151","2":"1","3":"67","4":"1","5":"237","6":"100","7":"1","8":"170","9":"1","10":"1"},{"1":"10181","2":"0","3":"60","4":"0","5":"289","6":"80","7":"1","8":"118","9":"0","10":"0"},{"1":"10201","2":"0","3":"65","4":"1","5":"176","6":"82","7":"0","8":"200","9":"1","10":"1"},{"1":"10221","2":"0","3":"72","4":"1","5":"232","6":"80","7":"1","8":"210","9":"1","10":"1"},{"1":"10231","2":"1","3":"71","4":"0","5":"184","6":"90","7":"0","8":"160","9":"1","10":"1"},{"1":"10241","2":"0","3":"55","4":"0","5":"283","6":"108","7":"1","8":"178","9":"1","10":"1"},{"1":"10271","2":"0","3":"54","4":"0","5":"214","6":"110","7":"0","8":"170","9":"1","10":"1"},{"1":"10401","2":"0","3":"52","4":"1","5":"161","6":"76","7":"0","8":"162","9":"1","10":"1"},{"1":"10402","2":"0","3":"48","4":"0","5":"232","6":"98","7":"0","8":"154","9":"1","10":"1"},{"1":"10921","2":"0","3":"66","4":"0","5":"228","6":"72","7":"0","8":"120","9":"1","10":"0"},{"1":"10951","2":"0","3":"52","4":"1","5":"206","6":"120","7":"1","8":"206","9":"0","10":"1"},{"1":"10971","2":"0","3":"64","4":"0","5":"218","6":"80","7":"0","8":"110","9":"1","10":"0"},{"1":"11011","2":"0","3":"42","4":"0","5":"262","6":"92","7":"0","8":"142","9":"1","10":"0"},{"1":"11081","2":"0","3":"52","4":"0","5":"227","6":"66","7":"0","8":"98","9":"0","10":"0"},{"1":"11101","2":"0","3":"51","4":"0","5":"215","6":"60","7":"0","8":"100","9":"0","10":"0"},{"1":"11141","2":"0","3":"54","4":"0","5":"146","6":"70","7":"0","8":"115","9":"0","10":"0"},{"1":"11151","2":"0","3":"51","4":"0","5":"268","6":"85","7":"0","8":"140","9":"1","10":"0"},{"1":"11161","2":"0","3":"60","4":"0","5":"211","6":"94","7":"0","8":"166","9":"0","10":"1"},{"1":"11221","2":"0","3":"48","4":"0","5":"213","6":"90","7":"1","8":"145","9":"1","10":"0"},{"1":"11281","2":"0","3":"73","4":"0","5":"249","6":"108","7":"0","8":"206","9":"1","10":"1"},{"1":"11291","2":"0","3":"50","4":"0","5":"218","6":"92","7":"0","8":"130","9":"1","10":"0"},{"1":"11321","2":"0","3":"45","4":"0","5":"221","6":"92","7":"0","8":"128","9":"0","10":"0"},{"1":"11341","2":"1","3":"56","4":"1","5":"228","6":"92","7":"0","8":"152","9":"1","10":"0"},{"1":"11351","2":"1","3":"46","4":"0","5":"240","6":"104","7":"0","8":"142","9":"1","10":"1"},{"1":"11361","2":"1","3":"76","4":"1","5":"279","6":"96","7":"0","8":"136","9":"1","10":"1"},{"1":"11391","2":"0","3":"52","4":"0","5":"186","6":"70","7":"0","8":"118","9":"0","10":"0"},{"1":"11441","2":"0","3":"54","4":"0","5":"160","6":"110","7":"1","8":"200","9":"1","10":"1"},{"1":"11461","2":"0","3":"53","4":"1","5":"222","6":"104","7":"1","8":"154","9":"0","10":"1"},{"1":"11481","2":"0","3":"43","4":"0","5":"211","6":"65","7":"0","8":"112","9":"1","10":"0"},{"1":"11491","2":"0","3":"46","4":"0","5":"195","6":"132","7":"1","8":"230","9":"1","10":"1"},{"1":"11501","2":"0","3":"63","4":"0","5":"290","6":"90","7":"0","8":"150","9":"0","10":"0"},{"1":"11511","2":"0","3":"44","4":"0","5":"220","6":"95","7":"0","8":"138","9":"0","10":"1"},{"1":"11531","2":"0","3":"42","4":"0","5":"161","6":"80","7":"0","8":"124","9":"1","10":"0"},{"1":"11553","2":"0","3":"74","4":"1","5":"212","6":"98","7":"0","8":"164","9":"1","10":"1"},{"1":"11611","2":"0","3":"53","4":"0","5":"182","6":"86","7":"0","8":"136","9":"1","10":"0"},{"1":"11651","2":"0","3":"56","4":"1","5":"223","6":"110","7":"1","8":"208","9":"1","10":"1"},{"1":"11661","2":"0","3":"47","4":"0","5":"290","6":"92","7":"0","8":"136","9":"1","10":"0"},{"1":"11711","2":"0","3":"43","4":"0","5":"249","6":"90","7":"1","8":"162","9":"1","10":"1"},{"1":"11721","2":"0","3":"51","4":"0","5":"174","6":"92","7":"0","8":"124","9":"1","10":"0"},{"1":"11731","2":"0","3":"63","4":"1","5":"204","6":"92","7":"1","8":"190","9":"1","10":"1"},{"1":"11781","2":"0","3":"49","4":"0","5":"245","6":"62","7":"0","8":"124","9":"1","10":"0"},{"1":"11791","2":"0","3":"57","4":"1","5":"216","6":"114","7":"0","8":"174","9":"1","10":"1"},{"1":"11811","2":"0","3":"43","4":"0","5":"245","6":"120","7":"1","8":"145","9":"0","10":"1"},{"1":"11831","2":"0","3":"58","4":"0","5":"151","6":"98","7":"0","8":"138","9":"1","10":"1"},{"1":"11851","2":"0","3":"49","4":"1","5":"178","6":"102","7":"0","8":"166","9":"1","10":"1"},{"1":"11891","2":"0","3":"47","4":"0","5":"227","6":"88","7":"0","8":"132","9":"1","10":"0"},{"1":"11911","2":"0","3":"45","4":"0","5":"253","6":"104","7":"0","8":"152","9":"1","10":"1"},{"1":"11941","2":"1","3":"65","4":"1","5":"222","6":"88","7":"1","8":"162","9":"0","10":"1"},{"1":"11971","2":"0","3":"51","4":"0","5":"258","6":"94","7":"1","8":"178","9":"1","10":"1"},{"1":"11981","2":"0","3":"49","4":"0","5":"182","6":"84","7":"1","8":"124","9":"1","10":"0"},{"1":"11991","2":"0","3":"51","4":"0","5":"184","6":"96","7":"0","8":"150","9":"1","10":"1"},{"1":"12051","2":"1","3":"67","4":"0","5":"357","6":"90","7":"0","8":"129","9":"0","10":"0"},{"1":"12111","2":"0","3":"47","4":"0","5":"193","6":"90","7":"0","8":"135","9":"1","10":"0"},{"1":"12121","2":"0","3":"50","4":"0","5":"198","6":"82","7":"1","8":"136","9":"1","10":"0"},{"1":"12141","2":"0","3":"48","4":"0","5":"263","6":"76","7":"0","8":"102","9":"0","10":"0"},{"1":"12151","2":"0","3":"48","4":"0","5":"254","6":"74","7":"0","8":"124","9":"0","10":"0"},{"1":"12181","2":"0","3":"64","4":"0","5":"248","6":"74","7":"0","8":"126","9":"1","10":"0"},{"1":"12221","2":"0","3":"43","4":"0","5":"197","6":"84","7":"0","8":"122","9":"1","10":"0"},{"1":"12231","2":"0","3":"41","4":"0","5":"282","6":"98","7":"0","8":"132","9":"0","10":"1"},{"1":"12241","2":"0","3":"48","4":"0","5":"238","6":"106","7":"0","8":"144","9":"1","10":"1"},{"1":"12251","2":"0","3":"50","4":"0","5":"156","6":"74","7":"0","8":"122","9":"1","10":"0"},{"1":"12271","2":"0","3":"46","4":"0","5":"234","6":"70","7":"0","8":"120","9":"1","10":"0"},{"1":"12281","2":"0","3":"44","4":"0","5":"203","6":"82","7":"0","8":"110","9":"1","10":"0"},{"1":"12291","2":"1","3":"65","4":"0","5":"200","6":"90","7":"0","8":"160","9":"1","10":"1"},{"1":"12293","2":"0","3":"44","4":"0","5":"209","6":"84","7":"0","8":"132","9":"1","10":"0"},{"1":"12311","2":"0","3":"40","4":"0","5":"245","6":"94","7":"0","8":"142","9":"0","10":"0"},{"1":"12351","2":"0","3":"56","4":"0","5":"124","6":"86","7":"0","8":"142","9":"0","10":"0"},{"1":"12371","2":"0","3":"56","4":"1","5":"199","6":"86","7":"1","8":"154","9":"1","10":"0"},{"1":"12381","2":"1","3":"47","4":"0","5":"148","6":"85","7":"1","8":"145","9":"1","10":"0"},{"1":"12391","2":"0","3":"48","4":"0","5":"246","6":"92","7":"0","8":"122","9":"1","10":"0"},{"1":"12401","2":"0","3":"46","4":"0","5":"233","6":"96","7":"0","8":"138","9":"0","10":"1"},{"1":"12431","2":"0","3":"48","4":"0","5":"265","6":"100","7":"1","8":"142","9":"1","10":"1"},{"1":"12461","2":"0","3":"50","4":"0","5":"207","6":"86","7":"1","8":"142","9":"1","10":"0"},{"1":"12471","2":"0","3":"69","4":"0","5":"227","6":"72","7":"1","8":"108","9":"1","10":"0"},{"1":"12481","2":"0","3":"45","4":"0","5":"205","6":"130","7":"1","8":"182","9":"1","10":"1"},{"1":"12641","2":"0","3":"57","4":"0","5":"189","6":"102","7":"1","8":"128","9":"1","10":"1"},{"1":"12681","2":"1","3":"69","4":"0","5":"191","6":"102","7":"0","8":"164","9":"1","10":"1"},{"1":"12741","2":"0","3":"45","4":"0","5":"171","6":"91","7":"0","8":"145","9":"1","10":"0"},{"1":"12742","2":"0","3":"52","4":"0","5":"178","6":"91","7":"1","8":"145","9":"1","10":"0"},{"1":"12751","2":"0","3":"63","4":"0","5":"229","6":"94","7":"0","8":"148","9":"1","10":"0"},{"1":"12761","2":"0","3":"61","4":"1","5":"169","6":"90","7":"0","8":"140","9":"1","10":"0"},{"1":"12801","2":"0","3":"48","4":"0","5":"238","6":"88","7":"0","8":"134","9":"1","10":"0"},{"1":"12831","2":"1","3":"45","4":"0","5":"216","6":"94","7":"0","8":"138","9":"1","10":"0"},{"1":"12861","2":"0","3":"66","4":"1","5":"178","6":"110","7":"0","8":"198","9":"0","10":"1"},{"1":"12891","2":"0","3":"54","4":"0","5":"173","6":"92","7":"0","8":"162","9":"0","10":"1"},{"1":"12901","2":"0","3":"45","4":"0","5":"173","6":"64","7":"0","8":"120","9":"1","10":"0"},{"1":"12911","2":"1","3":"66","4":"0","5":"180","6":"104","7":"1","8":"162","9":"1","10":"1"},{"1":"12921","2":"0","3":"53","4":"0","5":"168","6":"110","7":"0","8":"154","9":"1","10":"1"},{"1":"12941","2":"0","3":"40","4":"0","5":"277","6":"80","7":"0","8":"120","9":"0","10":"0"},{"1":"13021","2":"0","3":"55","4":"0","5":"181","6":"78","7":"0","8":"132","9":"1","10":"0"},{"1":"13041","2":"0","3":"48","4":"0","5":"272","6":"98","7":"1","8":"156","9":"1","10":"1"},{"1":"13051","2":"0","3":"49","4":"0","5":"307","6":"88","7":"0","8":"130","9":"0","10":"0"},{"1":"13101","2":"0","3":"61","4":"0","5":"203","6":"94","7":"1","8":"146","9":"0","10":"0"},{"1":"13111","2":"0","3":"41","4":"0","5":"212","6":"90","7":"0","8":"120","9":"1","10":"0"},{"1":"13121","2":"0","3":"43","4":"0","5":"248","6":"118","7":"0","8":"142","9":"1","10":"1"},{"1":"13131","2":"0","3":"47","4":"0","5":"208","6":"110","7":"0","8":"160","9":"1","10":"1"},{"1":"13321","2":"0","3":"46","4":"0","5":"218","6":"86","7":"0","8":"126","9":"1","10":"0"},{"1":"13351","2":"0","3":"63","4":"1","5":"163","6":"76","7":"0","8":"175","9":"1","10":"1"},{"1":"13391","2":"0","3":"62","4":"0","5":"261","6":"88","7":"0","8":"130","9":"1","10":"0"},{"1":"13421","2":"0","3":"72","4":"0","5":"224","6":"100","7":"1","8":"190","9":"0","10":"1"},{"1":"13431","2":"0","3":"50","4":"0","5":"292","6":"80","7":"1","8":"128","9":"1","10":"0"},{"1":"13451","2":"0","3":"46","4":"0","5":"202","6":"100","7":"1","8":"172","9":"1","10":"1"},{"1":"13461","2":"0","3":"44","4":"0","5":"145","6":"72","7":"0","8":"114","9":"1","10":"0"},{"1":"13471","2":"0","3":"46","4":"1","5":"183","6":"88","7":"1","8":"162","9":"1","10":"1"},{"1":"13481","2":"0","3":"47","4":"0","5":"188","6":"88","7":"0","8":"126","9":"1","10":"0"},{"1":"13511","2":"0","3":"51","4":"1","5":"209","6":"106","7":"0","8":"180","9":"1","10":"1"},{"1":"13521","2":"0","3":"46","4":"0","5":"217","6":"84","7":"0","8":"144","9":"1","10":"0"},{"1":"13531","2":"0","3":"47","4":"0","5":"180","6":"78","7":"0","8":"126","9":"1","10":"0"},{"1":"13541","2":"0","3":"44","4":"0","5":"190","6":"90","7":"0","8":"140","9":"0","10":"0"},{"1":"13551","2":"0","3":"55","4":"0","5":"211","6":"80","7":"0","8":"115","9":"1","10":"0"},{"1":"13571","2":"0","3":"56","4":"0","5":"204","6":"76","7":"0","8":"124","9":"1","10":"0"},{"1":"13591","2":"0","3":"54","4":"0","5":"185","6":"98","7":"0","8":"170","9":"0","10":"1"},{"1":"13611","2":"1","3":"50","4":"0","5":"206","6":"70","7":"0","8":"108","9":"1","10":"0"},{"1":"13641","2":"0","3":"59","4":"0","5":"265","6":"96","7":"0","8":"150","9":"1","10":"1"},{"1":"13651","2":"0","3":"47","4":"0","5":"246","6":"80","7":"0","8":"130","9":"0","10":"0"},{"1":"13661","2":"0","3":"65","4":"1","5":"171","6":"102","7":"0","8":"166","9":"0","10":"1"},{"1":"13662","2":"0","3":"41","4":"0","5":"211","6":"91","7":"0","8":"145","9":"0","10":"0"},{"1":"13671","2":"0","3":"47","4":"0","5":"139","6":"96","7":"1","8":"192","9":"1","10":"1"},{"1":"13691","2":"0","3":"49","4":"0","5":"155","6":"84","7":"0","8":"124","9":"0","10":"0"},{"1":"13721","2":"0","3":"50","4":"0","5":"229","6":"90","7":"0","8":"134","9":"0","10":"0"},{"1":"13731","2":"0","3":"56","4":"1","5":"148","6":"110","7":"0","8":"168","9":"1","10":"1"},{"1":"13751","2":"0","3":"50","4":"0","5":"198","6":"86","7":"0","8":"134","9":"1","10":"0"},{"1":"13761","2":"0","3":"55","4":"1","5":"186","6":"120","7":"0","8":"172","9":"1","10":"1"},{"1":"13771","2":"0","3":"52","4":"0","5":"211","6":"70","7":"0","8":"112","9":"1","10":"0"},{"1":"13811","2":"0","3":"57","4":"0","5":"210","6":"80","7":"0","8":"120","9":"1","10":"0"},{"1":"13841","2":"1","3":"47","4":"1","5":"212","6":"122","7":"1","8":"220","9":"1","10":"1"},{"1":"13861","2":"0","3":"59","4":"0","5":"227","6":"70","7":"0","8":"122","9":"0","10":"0"},{"1":"13901","2":"0","3":"47","4":"0","5":"232","6":"90","7":"0","8":"142","9":"0","10":"0"},{"1":"13911","2":"0","3":"42","4":"0","5":"176","6":"88","7":"0","8":"122","9":"1","10":"0"},{"1":"13931","2":"0","3":"56","4":"0","5":"166","6":"86","7":"0","8":"126","9":"0","10":"0"},{"1":"13941","2":"1","3":"43","4":"0","5":"268","6":"88","7":"1","8":"132","9":"1","10":"0"},{"1":"13951","2":"0","3":"55","4":"0","5":"178","6":"80","7":"0","8":"104","9":"1","10":"0"},{"1":"13961","2":"0","3":"49","4":"1","5":"147","6":"134","7":"1","8":"300","9":"1","10":"1"},{"1":"13971","2":"0","3":"71","4":"1","5":"164","6":"94","7":"0","8":"174","9":"0","10":"1"},{"1":"14041","2":"0","3":"71","4":"1","5":"187","6":"114","7":"1","8":"172","9":"0","10":"1"},{"1":"14071","2":"0","3":"69","4":"1","5":"165","6":"96","7":"1","8":"140","9":"0","10":"1"},{"1":"14691","2":"0","3":"47","4":"0","5":"250","6":"88","7":"1","8":"122","9":"1","10":"0"},{"1":"14701","2":"0","3":"44","4":"0","5":"199","6":"70","7":"0","8":"120","9":"1","10":"0"},{"1":"14711","2":"1","3":"65","4":"1","5":"233","6":"116","7":"1","8":"180","9":"1","10":"1"},{"1":"14731","2":"0","3":"65","4":"0","5":"182","6":"74","7":"0","8":"124","9":"0","10":"0"},{"1":"14741","2":"0","3":"40","4":"0","5":"210","6":"94","7":"0","8":"128","9":"0","10":"0"},{"1":"14751","2":"0","3":"47","4":"0","5":"235","6":"86","7":"0","8":"128","9":"1","10":"0"},{"1":"14761","2":"0","3":"54","4":"0","5":"172","6":"92","7":"0","8":"144","9":"1","10":"0"},{"1":"14771","2":"0","3":"64","4":"1","5":"198","6":"100","7":"0","8":"178","9":"0","10":"1"},{"1":"14781","2":"0","3":"59","4":"1","5":"212","6":"90","7":"1","8":"198","9":"0","10":"1"},{"1":"14801","2":"0","3":"72","4":"0","5":"285","6":"90","7":"1","8":"150","9":"1","10":"0"},{"1":"14811","2":"0","3":"52","4":"0","5":"194","6":"82","7":"0","8":"132","9":"0","10":"0"},{"1":"14861","2":"0","3":"56","4":"0","5":"237","6":"70","7":"0","8":"106","9":"0","10":"0"},{"1":"14871","2":"0","3":"56","4":"0","5":"153","6":"66","7":"1","8":"96","9":"0","10":"0"},{"1":"14881","2":"0","3":"54","4":"0","5":"219","6":"92","7":"0","8":"152","9":"1","10":"0"},{"1":"14901","2":"0","3":"60","4":"1","5":"188","6":"114","7":"1","8":"210","9":"1","10":"1"},{"1":"14911","2":"0","3":"63","4":"0","5":"276","6":"95","7":"1","8":"145","9":"0","10":"1"},{"1":"14931","2":"0","3":"73","4":"0","5":"203","6":"68","7":"0","8":"130","9":"1","10":"0"},{"1":"14941","2":"1","3":"49","4":"0","5":"228","6":"98","7":"0","8":"140","9":"1","10":"1"},{"1":"14981","2":"0","3":"57","4":"0","5":"199","6":"80","7":"0","8":"134","9":"0","10":"0"},{"1":"15001","2":"0","3":"53","4":"1","5":"162","6":"90","7":"0","8":"158","9":"1","10":"0"},{"1":"15011","2":"0","3":"43","4":"0","5":"221","6":"94","7":"0","8":"125","9":"1","10":"0"},{"1":"15021","2":"0","3":"68","4":"0","5":"150","6":"78","7":"0","8":"145","9":"0","10":"0"},{"1":"15031","2":"0","3":"53","4":"0","5":"140","6":"80","7":"0","8":"120","9":"1","10":"0"},{"1":"15041","2":"0","3":"50","4":"0","5":"162","6":"65","7":"1","8":"110","9":"0","10":"0"},{"1":"15061","2":"0","3":"49","4":"0","5":"171","6":"86","7":"1","8":"125","9":"1","10":"0"},{"1":"15091","2":"0","3":"62","4":"0","5":"206","6":"94","7":"0","8":"144","9":"0","10":"0"},{"1":"15111","2":"0","3":"52","4":"0","5":"226","6":"76","7":"0","8":"130","9":"1","10":"0"},{"1":"15121","2":"0","3":"57","4":"1","5":"113","6":"94","7":"1","8":"146","9":"1","10":"0"},{"1":"15141","2":"0","3":"45","4":"0","5":"197","6":"78","7":"0","8":"118","9":"0","10":"0"},{"1":"15161","2":"0","3":"50","4":"0","5":"180","6":"88","7":"0","8":"132","9":"1","10":"0"},{"1":"15171","2":"0","3":"50","4":"1","5":"180","6":"118","7":"1","8":"214","9":"1","10":"1"},{"1":"15191","2":"0","3":"53","4":"0","5":"196","6":"86","7":"0","8":"144","9":"1","10":"0"},{"1":"15201","2":"0","3":"51","4":"0","5":"211","6":"98","7":"0","8":"135","9":"0","10":"1"},{"1":"15211","2":"0","3":"58","4":"1","5":"164","6":"96","7":"1","8":"155","9":"1","10":"1"},{"1":"15221","2":"0","3":"64","4":"0","5":"218","6":"85","7":"0","8":"154","9":"0","10":"0"},{"1":"15251","2":"1","3":"49","4":"0","5":"191","6":"76","7":"0","8":"132","9":"1","10":"0"},{"1":"15271","2":"0","3":"55","4":"0","5":"189","6":"64","7":"0","8":"110","9":"0","10":"0"},{"1":"15311","2":"0","3":"50","4":"0","5":"156","6":"82","7":"0","8":"114","9":"1","10":"0"},{"1":"15321","2":"0","3":"50","4":"0","5":"223","6":"80","7":"0","8":"130","9":"1","10":"0"},{"1":"15361","2":"0","3":"57","4":"0","5":"165","6":"76","7":"0","8":"132","9":"1","10":"0"},{"1":"15401","2":"0","3":"55","4":"1","5":"200","6":"94","7":"1","8":"188","9":"1","10":"1"},{"1":"15421","2":"0","3":"48","4":"1","5":"162","6":"135","7":"1","8":"250","9":"1","10":"1"},{"1":"15431","2":"0","3":"56","4":"1","5":"207","6":"110","7":"0","8":"172","9":"1","10":"1"},{"1":"15441","2":"0","3":"72","4":"0","5":"262","6":"84","7":"0","8":"172","9":"1","10":"1"},{"1":"15511","2":"1","3":"67","4":"1","5":"236","6":"106","7":"1","8":"200","9":"0","10":"1"},{"1":"15541","2":"0","3":"70","4":"1","5":"192","6":"90","7":"1","8":"162","9":"0","10":"1"},{"1":"15562","2":"0","3":"57","4":"1","5":"203","6":"100","7":"0","8":"170","9":"1","10":"1"},{"1":"15611","2":"0","3":"67","4":"1","5":"200","6":"160","7":"1","8":"224","9":"0","10":"1"},{"1":"15641","2":"0","3":"62","4":"0","5":"280","6":"86","7":"0","8":"124","9":"1","10":"0"},{"1":"15651","2":"0","3":"72","4":"1","5":"229","6":"140","7":"1","8":"270","9":"1","10":"1"},{"1":"15661","2":"0","3":"70","4":"0","5":"290","6":"84","7":"0","8":"138","9":"0","10":"0"},{"1":"15671","2":"0","3":"65","4":"0","5":"222","6":"88","7":"0","8":"146","9":"0","10":"0"},{"1":"15691","2":"0","3":"58","4":"0","5":"259","6":"100","7":"1","8":"154","9":"0","10":"1"},{"1":"15711","2":"0","3":"64","4":"0","5":"205","6":"80","7":"0","8":"140","9":"0","10":"0"},{"1":"15761","2":"0","3":"44","4":"0","5":"276","6":"74","7":"0","8":"112","9":"1","10":"0"},{"1":"15791","2":"0","3":"55","4":"0","5":"171","6":"68","7":"0","8":"110","9":"0","10":"0"},{"1":"15831","2":"0","3":"71","4":"0","5":"287","6":"90","7":"0","8":"130","9":"0","10":"0"},{"1":"15851","2":"1","3":"72","4":"0","5":"174","6":"78","7":"1","8":"192","9":"1","10":"1"},{"1":"15882","2":"0","3":"71","4":"0","5":"277","6":"110","7":"1","8":"200","9":"0","10":"1"},{"1":"15891","2":"0","3":"54","4":"0","5":"192","6":"85","7":"0","8":"130","9":"0","10":"0"},{"1":"15911","2":"0","3":"51","4":"0","5":"196","6":"90","7":"0","8":"128","9":"1","10":"0"},{"1":"15921","2":"0","3":"68","4":"0","5":"203","6":"74","7":"0","8":"138","9":"1","10":"0"},{"1":"15931","2":"0","3":"47","4":"0","5":"271","6":"85","7":"0","8":"145","9":"1","10":"0"},{"1":"15941","2":"0","3":"49","4":"1","5":"169","6":"85","7":"1","8":"145","9":"0","10":"0"},{"1":"15951","2":"0","3":"48","4":"0","5":"201","6":"98","7":"0","8":"150","9":"1","10":"1"},{"1":"15981","2":"0","3":"74","4":"0","5":"244","6":"94","7":"0","8":"164","9":"0","10":"1"},{"1":"15991","2":"0","3":"49","4":"0","5":"161","6":"92","7":"0","8":"120","9":"0","10":"0"},{"1":"16321","2":"1","3":"53","4":"0","5":"192","6":"106","7":"0","8":"164","9":"1","10":"1"},{"1":"16431","2":"0","3":"46","4":"0","5":"192","6":"86","7":"1","8":"116","9":"1","10":"0"},{"1":"16441","2":"0","3":"59","4":"0","5":"230","6":"84","7":"0","8":"158","9":"1","10":"0"},{"1":"16461","2":"0","3":"50","4":"0","5":"312","6":"98","7":"1","8":"138","9":"0","10":"1"},{"1":"16481","2":"1","3":"69","4":"1","5":"230","6":"100","7":"1","8":"170","9":"0","10":"1"},{"1":"16501","2":"1","3":"75","4":"1","5":"233","6":"90","7":"1","8":"222","9":"1","10":"1"},{"1":"16531","2":"0","3":"42","4":"0","5":"207","6":"72","7":"0","8":"106","9":"1","10":"0"},{"1":"16541","2":"0","3":"50","4":"0","5":"317","6":"90","7":"1","8":"138","9":"0","10":"0"},{"1":"16571","2":"0","3":"44","4":"0","5":"213","6":"84","7":"0","8":"118","9":"1","10":"0"},{"1":"16581","2":"0","3":"44","4":"0","5":"220","6":"98","7":"0","8":"140","9":"0","10":"1"},{"1":"16591","2":"0","3":"42","4":"0","5":"225","6":"95","7":"0","8":"140","9":"0","10":"1"},{"1":"16622","2":"0","3":"42","4":"0","5":"288","6":"104","7":"0","8":"150","9":"1","10":"1"},{"1":"16691","2":"0","3":"44","4":"0","5":"168","6":"94","7":"1","8":"134","9":"1","10":"0"},{"1":"16701","2":"0","3":"57","4":"1","5":"182","6":"96","7":"1","8":"138","9":"1","10":"1"},{"1":"16711","2":"1","3":"68","4":"1","5":"242","6":"84","7":"0","8":"128","9":"1","10":"0"},{"1":"16752","2":"0","3":"69","4":"0","5":"258","6":"82","7":"0","8":"145","9":"1","10":"0"},{"1":"16761","2":"0","3":"74","4":"1","5":"172","6":"100","7":"0","8":"190","9":"1","10":"1"},{"1":"16841","2":"0","3":"56","4":"1","5":"239","6":"140","7":"1","8":"220","9":"1","10":"1"},{"1":"16871","2":"1","3":"58","4":"1","5":"209","6":"94","7":"1","8":"140","9":"1","10":"0"},{"1":"16891","2":"0","3":"46","4":"0","5":"181","6":"84","7":"0","8":"124","9":"0","10":"0"},{"1":"16911","2":"0","3":"60","4":"1","5":"199","6":"100","7":"0","8":"162","9":"0","10":"1"},{"1":"16931","2":"0","3":"62","4":"0","5":"217","6":"90","7":"0","8":"144","9":"1","10":"0"},{"1":"16971","2":"0","3":"74","4":"0","5":"200","6":"78","7":"0","8":"118","9":"1","10":"0"},{"1":"17071","2":"0","3":"44","4":"0","5":"268","6":"80","7":"0","8":"126","9":"1","10":"0"},{"1":"17111","2":"0","3":"54","4":"0","5":"202","6":"86","7":"0","8":"134","9":"0","10":"0"},{"1":"17121","2":"0","3":"49","4":"0","5":"224","6":"86","7":"1","8":"134","9":"1","10":"0"},{"1":"17131","2":"0","3":"46","4":"0","5":"302","6":"102","7":"0","8":"160","9":"1","10":"1"},{"1":"17151","2":"0","3":"45","4":"0","5":"239","6":"90","7":"0","8":"128","9":"0","10":"0"},{"1":"17161","2":"0","3":"57","4":"0","5":"205","6":"88","7":"0","8":"140","9":"0","10":"0"},{"1":"17171","2":"0","3":"56","4":"1","5":"192","6":"170","7":"1","8":"270","9":"0","10":"1"},{"1":"17181","2":"0","3":"42","4":"0","5":"282","6":"114","7":"0","8":"170","9":"1","10":"1"},{"1":"17191","2":"0","3":"52","4":"0","5":"232","6":"94","7":"0","8":"144","9":"1","10":"0"},{"1":"17211","2":"0","3":"49","4":"0","5":"229","6":"92","7":"0","8":"162","9":"1","10":"1"},{"1":"17231","2":"0","3":"51","4":"0","5":"336","6":"86","7":"0","8":"130","9":"1","10":"0"},{"1":"17251","2":"0","3":"40","4":"0","5":"146","6":"84","7":"0","8":"125","9":"0","10":"0"},{"1":"17271","2":"0","3":"43","4":"0","5":"224","6":"72","7":"0","8":"115","9":"0","10":"0"},{"1":"17291","2":"0","3":"45","4":"0","5":"228","6":"76","7":"1","8":"136","9":"1","10":"0"},{"1":"17361","2":"0","3":"63","4":"0","5":"211","6":"108","7":"0","8":"144","9":"1","10":"1"},{"1":"17401","2":"0","3":"52","4":"0","5":"212","6":"76","7":"0","8":"118","9":"0","10":"0"},{"1":"17481","2":"1","3":"67","4":"1","5":"243","6":"118","7":"1","8":"220","9":"1","10":"1"},{"1":"17961","2":"0","3":"72","4":"1","5":"208","6":"94","7":"1","8":"174","9":"1","10":"1"},{"1":"17991","2":"0","3":"54","4":"0","5":"284","6":"98","7":"0","8":"146","9":"1","10":"1"},{"1":"18061","2":"0","3":"52","4":"0","5":"190","6":"88","7":"1","8":"130","9":"1","10":"0"},{"1":"18071","2":"0","3":"49","4":"0","5":"264","6":"92","7":"0","8":"162","9":"0","10":"1"},{"1":"18101","2":"0","3":"42","4":"0","5":"288","6":"108","7":"0","8":"146","9":"0","10":"1"},{"1":"18121","2":"0","3":"41","4":"0","5":"181","6":"94","7":"0","8":"136","9":"1","10":"0"},{"1":"18131","2":"1","3":"56","4":"1","5":"283","6":"100","7":"0","8":"188","9":"1","10":"1"},{"1":"18141","2":"0","3":"46","4":"0","5":"217","6":"66","7":"0","8":"120","9":"1","10":"0"},{"1":"18151","2":"1","3":"52","4":"0","5":"250","6":"80","7":"0","8":"132","9":"1","10":"0"},{"1":"18161","2":"0","3":"44","4":"0","5":"209","6":"70","7":"0","8":"116","9":"1","10":"0"},{"1":"18171","2":"1","3":"43","4":"0","5":"189","6":"106","7":"0","8":"154","9":"1","10":"1"},{"1":"18201","2":"0","3":"73","4":"0","5":"190","6":"78","7":"0","8":"138","9":"0","10":"0"},{"1":"18401","2":"0","3":"54","4":"0","5":"223","6":"82","7":"0","8":"122","9":"1","10":"0"},{"1":"18411","2":"0","3":"46","4":"0","5":"241","6":"84","7":"0","8":"120","9":"1","10":"0"},{"1":"18421","2":"0","3":"44","4":"0","5":"214","6":"96","7":"1","8":"142","9":"1","10":"1"},{"1":"18441","2":"0","3":"43","4":"0","5":"207","6":"86","7":"0","8":"122","9":"0","10":"0"},{"1":"18481","2":"0","3":"46","4":"0","5":"186","6":"86","7":"0","8":"130","9":"0","10":"0"},{"1":"18491","2":"1","3":"74","4":"1","5":"212","6":"70","7":"1","8":"144","9":"1","10":"0"},{"1":"18511","2":"0","3":"54","4":"1","5":"211","6":"94","7":"1","8":"152","9":"0","10":"0"},{"1":"18521","2":"0","3":"63","4":"0","5":"223","6":"86","7":"0","8":"158","9":"1","10":"0"},{"1":"18551","2":"0","3":"58","4":"1","5":"206","6":"108","7":"1","8":"192","9":"0","10":"1"},{"1":"18581","2":"0","3":"50","4":"0","5":"194","6":"92","7":"0","8":"134","9":"1","10":"0"},{"1":"18631","2":"0","3":"71","4":"0","5":"193","6":"82","7":"0","8":"115","9":"1","10":"0"},{"1":"18661","2":"0","3":"52","4":"0","5":"213","6":"90","7":"0","8":"140","9":"1","10":"0"},{"1":"18681","2":"0","3":"63","4":"0","5":"318","6":"82","7":"1","8":"126","9":"0","10":"0"},{"1":"18711","2":"0","3":"66","4":"0","5":"216","6":"104","7":"1","8":"154","9":"0","10":"1"},{"1":"18731","2":"0","3":"60","4":"0","5":"211","6":"66","7":"0","8":"128","9":"1","10":"0"},{"1":"18752","2":"0","3":"47","4":"0","5":"219","6":"88","7":"0","8":"128","9":"1","10":"0"},{"1":"18771","2":"0","3":"57","4":"0","5":"322","6":"98","7":"0","8":"144","9":"1","10":"1"},{"1":"18801","2":"0","3":"66","4":"1","5":"239","6":"100","7":"1","8":"184","9":"1","10":"1"},{"1":"18841","2":"0","3":"66","4":"1","5":"195","6":"104","7":"0","8":"158","9":"1","10":"1"},{"1":"18871","2":"0","3":"47","4":"0","5":"243","6":"78","7":"0","8":"118","9":"1","10":"0"},{"1":"18921","2":"0","3":"60","4":"0","5":"223","6":"92","7":"1","8":"122","9":"1","10":"0"},{"1":"18971","2":"0","3":"48","4":"0","5":"174","6":"102","7":"0","8":"160","9":"1","10":"1"},{"1":"19003","2":"0","3":"61","4":"1","5":"163","6":"86","7":"1","8":"144","9":"1","10":"0"},{"1":"19011","2":"0","3":"64","4":"0","5":"225","6":"90","7":"0","8":"160","9":"1","10":"1"},{"1":"19061","2":"1","3":"46","4":"0","5":"252","6":"122","7":"0","8":"158","9":"1","10":"1"},{"1":"19091","2":"0","3":"49","4":"0","5":"261","6":"102","7":"0","8":"166","9":"1","10":"1"},{"1":"19121","2":"0","3":"51","4":"0","5":"184","6":"88","7":"0","8":"118","9":"1","10":"0"},{"1":"19161","2":"0","3":"64","4":"0","5":"206","6":"82","7":"0","8":"152","9":"0","10":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="fit-logistic-regression-model-for-a-single-variable" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="fit-logistic-regression-model-for-a-single-variable"><span class="header-section-number">6.4.2</span> Fit Logistic Regression Model for a Single Variable</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"smk"</span>, <span class="st">"sbp"</span>, <span class="st">"age"</span>, <span class="st">"chl"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#jit  &lt;- 0.01  # global jitter amount for y</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## par(mfrow = c(2, 2), mar = c(4, 4, 2, 4) + 0.1)  # extra right margin for axis(4)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> vars) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Univariate logistic regression using ORIGINAL variable name in the formula</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">reformulate</span>(v, <span class="at">response =</span> <span class="st">"chd"</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data    =</span> CHD.data,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family  =</span> <span class="fu">binomial</span>()</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(fit))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Base scatter of chd with small jitter (left axis: probability scale)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    CHD.data[[v]],</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">jitter</span>(CHD.data<span class="sc">$</span>chd, <span class="at">amount =</span> jit),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch  =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.45</span>),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> v, <span class="at">ylab =</span> <span class="st">"chd (jittered)"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"chd vs"</span>, v),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Fitted π(x) in red (left axis)</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(CHD.data[[v]])) <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># binary predictor</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    xcat <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(CHD.data[[v]]))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    nd   <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">data.frame</span>(xcat), v)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    pcat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(xcat, pcat, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(xcat, pcat, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Right-axis: logit{π(x)} with fixed y-limits</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    logit_p <span class="ot">&lt;-</span> <span class="fu">log</span>(pcat <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pcat))</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>      xcat, logit_p, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">range</span>(CHD.data[[v]]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">0</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="st">"logit(p(x))"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># continuous predictor</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    xg <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(CHD.data[[v]]), <span class="fu">max</span>(CHD.data[[v]]), <span class="at">length.out =</span> <span class="dv">400</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    nd <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">data.frame</span>(xg), v)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    pg <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(xg, pg, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Right-axis: logit{π(x)} with fixed y-limits</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    logit_pg <span class="ot">&lt;-</span> <span class="fu">log</span>(pg <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pg))</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>      xg, logit_pg, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">range</span>(xg), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">0</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="st">"logit(p(x))"</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = reformulate(v, response = "chd"), family = binomial(), 
    data = CHD.data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -2.4898     0.2524  -9.865   &lt;2e-16 ***
smk           0.6706     0.2919   2.297   0.0216 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 438.56  on 608  degrees of freedom
Residual deviance: 432.81  on 607  degrees of freedom
AIC: 436.81

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/chd-univariate-2x2-jitter-fixedlogit-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = reformulate(v, response = "chd"), family = binomial(), 
    data = CHD.data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.837912   0.629805  -6.094  1.1e-09 ***
sbp          0.012154   0.004036   3.011   0.0026 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 438.56  on 608  degrees of freedom
Residual deviance: 430.06  on 607  degrees of freedom
AIC: 434.06

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/chd-univariate-2x2-jitter-fixedlogit-2.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = reformulate(v, response = "chd"), family = binomial(), 
    data = CHD.data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -4.47833    0.75610  -5.923 3.16e-09 ***
age          0.04445    0.01315   3.381 0.000723 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 438.56  on 608  degrees of freedom
Residual deviance: 427.22  on 607  degrees of freedom
AIC: 431.22

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/chd-univariate-2x2-jitter-fixedlogit-3.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = reformulate(v, response = "chd"), family = binomial(), 
    data = CHD.data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.538260   0.686879  -5.151 2.59e-07 ***
chl          0.007004   0.003064   2.286   0.0223 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 438.56  on 608  degrees of freedom
Residual deviance: 433.42  on 607  degrees of freedom
AIC: 437.42

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/chd-univariate-2x2-jitter-fixedlogit-4.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-logistic-regression-model-with-all-variables" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="fit-logistic-regression-model-with-all-variables"><span class="header-section-number">6.4.3</span> Fit Logistic Regression Model with all variables</h3>
<p>We fit a logistic regression with a logit link:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit1_chd <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  chd <span class="sc">~</span> smk <span class="sc">+</span> cat <span class="sc">+</span> sbp <span class="sc">+</span> age <span class="sc">+</span> chl <span class="sc">+</span> ecg <span class="sc">+</span> hpt,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> CHD.data,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = chd ~ smk + cat + sbp + age + chl + ecg + hpt, 
    family = binomial(link = "logit"), data = CHD.data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -6.048892   1.345165  -4.497  6.9e-06 ***
smk          0.855951   0.306505   2.793  0.00523 ** 
cat          0.732763   0.376129   1.948  0.05139 .  
sbp         -0.006995   0.006976  -1.003  0.31600    
age          0.033956   0.015344   2.213  0.02690 *  
chl          0.008970   0.003274   2.740  0.00615 ** 
ecg          0.417776   0.295553   1.414  0.15750    
hpt          0.655498   0.359976   1.821  0.06861 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 438.56  on 608  degrees of freedom
Residual deviance: 399.35  on 601  degrees of freedom
AIC: 415.35

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p><strong>Notes for interpretation:</strong></p>
<ul>
<li>Positive coefficients increase the log-odds of CHD; negative coefficients decrease it.</li>
<li>For indicator variables (e.g., <code>smk</code>), <code>exp(beta)</code> is the adjusted odds ratio comparing the group with value 1 versus 0, holding others fixed.</li>
<li>For continuous predictors (e.g., <code>sbp</code>, <code>age</code>), <code>exp(beta)</code> is the multiplicative change in the odds for a one‑unit increase. For a <em>d</em>-unit increase, the OR is <code>exp(d * beta)</code>.</li>
</ul>
</section>
</section>
<section id="inference-for-coefficients-confidence-intervals-and-covariance-matrix" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="inference-for-coefficients-confidence-intervals-and-covariance-matrix"><span class="header-section-number">6.5</span> Inference for Coefficients: Confidence Intervals and Covariance Matrix</h2>
<p>We extract profile‑likelihood CIs and the covariance matrix to confirm standard errors.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ci_95 <span class="ot">&lt;-</span> <span class="fu">confint</span>(fit1_chd, <span class="at">level =</span> <span class="fl">0.95</span>)     <span class="co"># profile-likelihood CI</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>vcov_mat <span class="ot">&lt;-</span> <span class="fu">vcov</span>(fit1_chd)                    <span class="co"># covariance matrix of coefficients</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>se_vec   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(vcov_mat))          <span class="co"># standard errors</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ci_95</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %       97.5 %
(Intercept) -8.718003347 -3.427904298
smk          0.275699158  1.483333169
cat         -0.006873216  1.471885644
sbp         -0.021166144  0.006266328
age          0.003687290  0.064005215
chl          0.002533226  0.015404292
ecg         -0.171584621  0.990632546
hpt         -0.050184520  1.364993401</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>vcov_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             (Intercept)           smk           cat           sbp
(Intercept)  1.809468553 -1.014526e-01  0.1391440386 -4.908229e-03
smk         -0.101452600  9.394560e-02 -0.0032961000 -1.653230e-04
cat          0.139144039 -3.296100e-03  0.1414730484 -9.299960e-04
sbp         -0.004908229 -1.653230e-04 -0.0009299960  4.866901e-05
age         -0.011142995  7.738971e-04 -0.0017879998 -1.311191e-05
chl         -0.002111134  3.161443e-05  0.0003146354 -1.821907e-06
ecg          0.003442546  9.255483e-03 -0.0204455233 -2.982539e-04
hpt          0.139817180  6.954592e-03 -0.0044220690 -1.486400e-03
                      age           chl           ecg           hpt
(Intercept) -1.114300e-02 -2.111134e-03  3.442546e-03  1.398172e-01
smk          7.738971e-04  3.161443e-05  9.255483e-03  6.954592e-03
cat         -1.788000e-03  3.146354e-04 -2.044552e-02 -4.422069e-03
sbp         -1.311191e-05 -1.821907e-06 -2.982539e-04 -1.486400e-03
age          2.354442e-04 -1.480501e-06 -4.972374e-05  4.044434e-04
chl         -1.480501e-06  1.071766e-05  5.040548e-05 -6.046197e-05
ecg         -4.972374e-05  5.040548e-05  8.735130e-02  9.506863e-04
hpt          4.044434e-04 -6.046197e-05  9.506863e-04  1.295828e-01</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>se_vec  <span class="co"># should match the SE column in summary(fit1_chd)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         smk         cat         sbp         age         chl 
1.345164879 0.306505459 0.376129032 0.006976318 0.015344190 0.003273784 
        ecg         hpt 
0.295552531 0.359976081 </code></pre>
</div>
</div>
</section>
<section id="inference-for-odds-ratios" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="inference-for-odds-ratios"><span class="header-section-number">6.6</span> Inference for Odds Ratios</h2>
<section id="interpretation-of-odds-ratios-in-logistic-regression" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="interpretation-of-odds-ratios-in-logistic-regression"><span class="header-section-number">6.6.1</span> Interpretation of Odds Ratios in Logistic Regression</h3>
<p>A multiple logistic regression model expresses the log-odds (logit) of an event as a linear function of predictors:</p>
<p><span class="math display">\[
\log\left(\frac{p}{1-p}\right)
= \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k.
\]</span></p>
<p>Here,</p>
<ul>
<li><span class="math inline">\(p = \Pr(Y = 1 \mid x_1, x_2, \ldots, x_k)\)</span> is the probability of the event,</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept, and</li>
<li>each <span class="math inline">\(\beta_j\)</span> represents the <strong>change in the log-odds</strong> of the event per one-unit increase in <span class="math inline">\(x_j\)</span>, <em>holding all other variables constant</em>.</li>
</ul>
<p>Exponentiating both sides gives the model in odds form:</p>
<p><span class="math display">\[
\frac{p}{1-p}
= \exp(\beta_0)
\times \exp(\beta_1 x_1)
\times \exp(\beta_2 x_2)
\times \cdots
\times \exp(\beta_k x_k).
\]</span></p>
<p><strong>An R function for OR at two Profiles</strong></p>
<p>The or_from_predict R function is a utility designed to calculate the Odds Ratio (OR) and its 95% confidence interval (CI) between two specific covariate profiles (new1 and new0) for a given logistic regression model (fit). The calculation is performed on the link (logit) scale. For a logistic model <span class="math inline">\(\text{logit}(p) = \eta = \mathbf{X}\boldsymbol{\beta}\)</span>, the log-Odds Ratio (logOR) is the difference between the linear predictors (<span class="math inline">\(\eta_1, \eta_0\)</span>) for the two profiles: <span id="eq-logor"><span class="math display">\[\widehat{\text{logOR}} = \eta_1 - \eta_0 = (\mathbf{x}_1^T - \mathbf{x}_0^T) \boldsymbol{\beta} = \mathbf{c}^T \boldsymbol{\beta} \tag{6.1}\]</span></span></p>
<p>Here, <span class="math inline">\(\mathbf{c} = \mathbf{x}_1 - \mathbf{x}_0\)</span> is the linear contrast vector derived from the model matrices of the two profiles. The function estimates the variance of this contrast as <span class="math inline">\(\text{Var}(\widehat{\text{logOR}}) = \mathbf{c}^T \mathbf{V} \mathbf{c}\)</span>, where <span class="math inline">\(\mathbf{V}\)</span> is the model’s variance-covariance matrix (vcov(fit)). The standard error <span class="math inline">\(SE = \sqrt{\mathbf{c}^T \mathbf{V} \mathbf{c}}\)</span> is used to compute the <span class="math inline">\(100(1-\alpha)\%\)</span> confidence interval for the logOR: <span class="math display">\[\widehat{\text{logOR}} \pm z_{1-\alpha/2} \times SE.\]</span> These values (estimate and CI bounds) are then exponentiated to produce the final <span class="math inline">\(\widehat{\text{OR}} = \exp(\widehat{\text{logOR}})\)</span> and its 95% CI. The function also prints two helpful summaries to the console: a data frame showing only the variables that differ between the new0 and new1 profiles, and a 2x3 table presenting the estimates and CIs for both the OR and the logOR.</p>
<p><strong>The R function to find ORs</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute OR and 95% CI via predict() on the LINK scale</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">## OR = exp( eta(new1) - eta(new0) ), where eta(.) = logit{π(.)}</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute OR via predict() contrast on the LINK scale, also:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (ii) print a 2-row data.frame of only variables that differ between new0 and new1</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="do">## (iii) print a 2x3 table (rows: OR, logOR; cols: Estimate, CI_low, CI_up)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>or_from_predict <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, new1, new0, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-12</span>) {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.data.frame</span>(new1), <span class="fu">is.data.frame</span>(new0))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## --- REFACTORED SECTION START ---</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ---- (ii) Two-row data.frame with only changed variables ----</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Helper function to find differing variables between two profiles</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This is defined *inside* or_from_predict for encapsulation</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  get_changed_vars <span class="ot">&lt;-</span> <span class="cf">function</span>(d0, d1, tolerance) {</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    common <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">names</span>(d0), <span class="fu">names</span>(d1))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    diffv  <span class="ot">&lt;-</span> <span class="fu">vapply</span>(common, <span class="cf">function</span>(nm) {</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>      x0 <span class="ot">&lt;-</span> d0[[nm]]; x1 <span class="ot">&lt;-</span> d1[[nm]]</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.numeric</span>(x0) <span class="sc">&amp;&amp;</span> <span class="fu">is.numeric</span>(x1)) {</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">isTRUE</span>(<span class="fu">all.equal</span>(<span class="fu">as.numeric</span>(x0), <span class="fu">as.numeric</span>(x1), <span class="at">tolerance =</span> tolerance))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">identical</span>(x0, x1)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    }, <span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    keep <span class="ot">&lt;-</span> common[diffv]</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(keep) <span class="sc">==</span> <span class="dv">0</span>L) {</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>      out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">_no_changes_</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"no differences"</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames</span>(out) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"new0"</span>, <span class="st">"new1"</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(out)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d0[keep], d1[keep])</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(out) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"new0"</span>, <span class="st">"new1"</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Call the helper function</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  changes_df <span class="ot">&lt;-</span> <span class="fu">get_changed_vars</span>(new0, new1, tol)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">## --- REFACTORED SECTION </span><span class="re">END</span><span class="do"> ---</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ---- Linear contrast for log-OR and its variance ----</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="do">## (i) Calculate logOR estimate using predict(type="link")</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">## eta(.) = logit{p(.)}</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  eta1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> new1, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>  eta0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> new0, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  logOR_hat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(eta1 <span class="sc">-</span> eta0) <span class="co"># logOR = eta1 - eta0</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="do">## (ii) Calculate standard error using the contrast vector 'cvec'</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="fu">delete.response</span>(<span class="fu">terms</span>(fit)), <span class="at">data =</span> new1)</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  X0 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="fu">delete.response</span>(<span class="fu">terms</span>(fit)), <span class="at">data =</span> new0)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  cvec      <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(X1 <span class="sc">-</span> X0)</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>  V         <span class="ot">&lt;-</span> <span class="fu">vcov</span>(fit)</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  se_logOR  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(<span class="fu">t</span>(cvec) <span class="sc">%*%</span> V <span class="sc">%*%</span> cvec))</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>  alpha  <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>  z      <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>  ci_log <span class="ot">&lt;-</span> <span class="fu">c</span>(logOR_hat <span class="sc">-</span> z <span class="sc">*</span> se_logOR, logOR_hat <span class="sc">+</span> z <span class="sc">*</span> se_logOR)</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ---- 2x3 table: rows OR and logOR; columns Estimate, CI_low, CI_up ----</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>  res_tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">exp</span>(logOR_hat),          logOR_hat),</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low   =</span> <span class="fu">c</span>(<span class="fu">exp</span>(ci_log[<span class="dv">1</span>L]),         ci_log[<span class="dv">1</span>L]),</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_up    =</span> <span class="fu">c</span>(<span class="fu">exp</span>(ci_log[<span class="dv">2</span>L]),         ci_log[<span class="dv">2</span>L]),</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"OR"</span>, <span class="st">"logOR"</span>)</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ---- Print requested items ----</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables that differ between new0 and new1:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(changes_df)</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratio summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(res_tab, <span class="at">digits =</span> digits)) <span class="co"># Added rounding for neatness</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ---- Return (invisibly) ----</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="fu">list</span>(</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR        =</span> <span class="fu">exp</span>(logOR_hat),</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_OR     =</span> <span class="fu">exp</span>(ci_log),</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">logOR     =</span> logOR_hat,</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_logOR  =</span> ci_log,</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_logOR  =</span> se_logOR,</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">changes   =</span> changes_df,</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">table     =</span> res_tab</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="do">## --- Example usage ---</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="do">## Suppose 'fit1_chd' is your fitted model and 'CHD.data' is your data</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="do">## base_prof &lt;- as.data.frame(lapply(CHD.data, function(col) if (is.numeric(col)) mean(col) else col[1]))</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a><span class="do">## new0 &lt;- base_prof; new0$smk &lt;- 0</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="do">## new1 &lt;- base_prof; new1$smk &lt;- 1</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="do">## or_from_predict(fit1_chd, new1 = new1, new0 = new0)</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>mean_profile <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">vars_binary_as =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) {</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Build a single-row data.frame of typical values:</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data, <span class="cf">function</span>(col) {</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.numeric</span>(col)) {</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If strictly 0/1, keep mean (works fine for GLM prediction),</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>      <span class="co"># or switch to mode if you prefer.</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">all</span>(col <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))) <span class="fu">mean</span>(col) <span class="cf">else</span> <span class="fu">mean</span>(col, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fallback to first level for factors/characters</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.factor</span>(col)) <span class="fu">levels</span>(col)[<span class="dv">1</span>] <span class="cf">else</span> <span class="fu">unique</span>(col)[<span class="dv">1</span>]</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(out)</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="examples-of-finding-ors-and-their-cis-for-the-chd-dataset" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="examples-of-finding-ors-and-their-cis-for-the-chd-dataset"><span class="header-section-number">6.6.2</span> Examples of Finding ORs and Their CIs for the CHD Dataset</h3>
<section id="or-smoking-smk-1-vs-0" class="level4" data-number="6.6.2.1">
<h4 data-number="6.6.2.1" class="anchored" data-anchor-id="or-smoking-smk-1-vs-0"><span class="header-section-number">6.6.2.1</span> OR Smoking (<code>smk</code>) (1 vs 0)</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 1) Smoking OR: smk = 1 vs 0 (other vars at their means)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Example profiles at sample means (adjust as you like)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>base_prof <span class="ot">&lt;-</span> <span class="fu">mean_profile</span>(CHD.data)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>new0 <span class="ot">&lt;-</span> base_prof; new0<span class="sc">$</span>smk <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>new1 <span class="ot">&lt;-</span> base_prof; new1<span class="sc">$</span>smk <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>res_smk <span class="ot">&lt;-</span> <span class="fu">or_from_predict</span>(fit1_chd, <span class="at">new1 =</span> new1, <span class="at">new0 =</span> new0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Variables that differ between new0 and new1:
     smk
new0   0
new1   1

Odds Ratio summary:
      Estimate CI_low  CI_up
OR      2.3536 1.2907 4.2917
logOR   0.8560 0.2552 1.4567</code></pre>
</div>
</div>
<p><strong>How to read this:</strong></p>
<ul>
<li><code>OR_smk &gt; 1</code> suggests higher odds of CHD among smokers (adjusted for other variables). If the 95% CI excludes 1, the association is statistically significant at the 5% level.</li>
</ul>
</section>
<section id="or-for-systolic-blood-pressure-sbp-from-120-to-160" class="level4" data-number="6.6.2.2">
<h4 data-number="6.6.2.2" class="anchored" data-anchor-id="or-for-systolic-blood-pressure-sbp-from-120-to-160"><span class="header-section-number">6.6.2.2</span> OR for Systolic Blood Pressure (<code>sbp</code>): from 120 to 160</h4>
<p>We compute the adjusted OR for a 40‑unit increase in <code>sbp</code> (from 120 to 160):</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 2) SBP OR: 160 vs 120 (other vars at their means)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>new0 <span class="ot">&lt;-</span> base_prof; new0<span class="sc">$</span>sbp <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>new1 <span class="ot">&lt;-</span> base_prof; new1<span class="sc">$</span>sbp <span class="ot">&lt;-</span> <span class="dv">160</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>res_sbp <span class="ot">&lt;-</span> <span class="fu">or_from_predict</span>(fit1_chd, <span class="at">new1 =</span> new1, <span class="at">new0 =</span> new0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Variables that differ between new0 and new1:
     sbp
new0 120
new1 160

Odds Ratio summary:
      Estimate  CI_low  CI_up
OR      0.7559  0.4375 1.3062
logOR  -0.2798 -0.8267 0.2671</code></pre>
</div>
</div>
</section>
<section id="or-for-combined-effects-of-two-variables-smoking-with-an-age-difference" class="level4" data-number="6.6.2.3">
<h4 data-number="6.6.2.3" class="anchored" data-anchor-id="or-for-combined-effects-of-two-variables-smoking-with-an-age-difference"><span class="header-section-number">6.6.2.3</span> OR for Combined Effects of Two Variables: Smoking with an Age Difference</h4>
<p>Suppose we compare two groups that differ in <strong>smoking status</strong> and <strong>age</strong>:</p>
<ul>
<li><strong>Group A:</strong> <code>smk = 1</code>, <code>age = 50</code> (all other covariates equal)</li>
<li><strong>Group B:</strong> <code>smk = 0</code>, <code>age = 30</code></li>
</ul>
<p>The log‑odds contrast is (<span class="math inline">\(A = \beta_{smk} + (50-20)\beta_{age}\)</span>), so the OR is (<span class="math inline">\(\exp(A)\)</span>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>new0 <span class="ot">&lt;-</span> base_prof; new0<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="dv">30</span>; new0<span class="sc">$</span>smk <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>new1 <span class="ot">&lt;-</span> base_prof; new1<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="dv">50</span>; new1<span class="sc">$</span>smk <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>res_ageAsmk <span class="ot">&lt;-</span> <span class="fu">or_from_predict</span>(fit1_chd, <span class="at">new1 =</span> new1, <span class="at">new0 =</span> new0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Variables that differ between new0 and new1:
     age smk
new0  30   0
new1  50   1

Odds Ratio summary:
      Estimate CI_low   CI_up
OR      4.6417 1.8546 11.6168
logOR   1.5351 0.6177  2.4525</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="assessing-statistical-significance-with-wilks-theorem-analogue-of-f-test-for-ols" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="assessing-statistical-significance-with-wilks-theorem-analogue-of-f-test-for-ols"><span class="header-section-number">6.7</span> Assessing Statistical Significance with Wilks’ Theorem (Analogue of F-test for OLS)</h2>
<p>In the context of logistic regression, Wilks’ theorem provides the basis for the Likelihood Ratio Test (LRT) used to assess the significance of predictor variables. The theorem states that when comparing a full model (<span class="math inline">\(M_1\)</span>) to a nested null model (<span class="math inline">\(M_0\)</span>), the test statistic, <span class="math inline">\(\Lambda\)</span>, asymptotically follows a chi-squared (<span class="math inline">\(\chi^2\)</span>) distribution under the null hypothesis (i.e., that the simpler model <span class="math inline">\(M_0\)</span> is correct).</p>
<p>The statistic <span class="math inline">\(\Lambda\)</span> is calculated as the difference in the maximized log-likelihoods: <span id="eq-LRT"><span class="math display">\[\Lambda = -2(\log L_0 - \log L_1) \tag{6.2}\]</span></span> where <span class="math inline">\(\log L_0\)</span> and <span class="math inline">\(\log L_1\)</span> are the log-likelihoods of the null and full models, respectively. In logistic regression, this is equivalent to the difference in the deviances: <span class="math inline">\(\Lambda = \text{Deviance}_0 - \text{Deviance}_1\)</span>. This test statistic <span class="math inline">\(\Lambda\)</span> represents the reduction in deviance (a measure of badness-of-fit) achieved by adding the extra predictors to the model.</p>
<p>The following R code chunk generates a conceptual plot of this relationship:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot-lrt-concept</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Conceptual plot of Deviance versus Number of Parameters, illustrating the Likelihood Ratio Test statistic (Λ) and Residual Deviance. Λ is the drop from the Null Model to the Full Model. The Saturated Model represents perfect fit (Deviance = 0)."</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Create conceptual data for the plot</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="do">## These are just for illustration</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="co"># Number of observations</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># Parameters in null model (intercept)</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">21</span>    <span class="co"># Parameters in full model (e.g., intercept + 7 predictors)</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>psat <span class="ot">&lt;-</span> n_obs <span class="co"># Parameters in saturated model (1 per observation)</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="dv">41</span> <span class="co"># Null deviance</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>D1 <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># Full model deviance (residual deviance of M1)</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>D_sat <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Saturated model deviance</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Data frame for the three points</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">c</span>(<span class="st">"M_0 (Null)"</span>, <span class="st">"M_1 (Full)"</span>, <span class="st">"M_Sat (Saturated)"</span>),</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">params =</span> <span class="fu">c</span>(p0, p1, psat),</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">deviance =</span> <span class="fu">c</span>(D0, D1, D_sat),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Add custom justification and nudges for labels</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust_val =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.1</span>), <span class="co"># Right-align the last label</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">nudge_x_val =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>) </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. Create the ggplot</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> params, <span class="at">y =</span> deviance)) <span class="sc">+</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Draw dashed guide lines for D0 and D1</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> p0, <span class="at">y =</span> D0, <span class="at">xend =</span> p1, <span class="at">yend =</span> D0), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey70"</span>) <span class="sc">+</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> p1, <span class="at">y =</span> D1, <span class="at">xend =</span> psat, <span class="at">yend =</span> D1), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey70"</span>) <span class="sc">+</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Connect the points with lines</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Draw the main points</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## --- MODIFIED LABEL PLACEMENT ---</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Label the points using custom nudge/justification</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> model, <span class="at">hjust =</span> hjust_val, <span class="at">nudge_x =</span> nudge_x_val), </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="fl">2.5</span>,  <span class="co"># Use a much smaller vertical nudge</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  <span class="do">## --- ADDED BACK D0 and D1 ANNOTATIONS ---</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  <span class="do">## D0 (Null Deviance)</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> p0 <span class="sc">-</span> <span class="dv">2</span>, <span class="at">y =</span> D0, <span class="at">xend =</span> p0 <span class="sc">-</span> <span class="dv">2</span>, <span class="at">yend =</span> D_sat), <span class="co"># Nudged left</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>)),</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> p0 <span class="sc">-</span> <span class="dv">3</span>, <span class="at">y =</span> D0 <span class="sc">/</span> <span class="dv">2</span>, <span class="co"># Nudged left</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"D[0]"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>  <span class="do">## D1 (Residual Deviance of Full Model)</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> psat <span class="sc">+</span> <span class="dv">2</span>, <span class="at">y =</span> D1, <span class="at">xend =</span> psat <span class="sc">+</span> <span class="dv">2</span>, <span class="at">yend =</span> D_sat), <span class="co"># Nudged right</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>)),</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkblue"</span>,</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> psat <span class="sc">+</span> <span class="dv">3</span>, <span class="at">y =</span> D1 <span class="sc">/</span> <span class="dv">2</span>, <span class="co"># Nudged right</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"D[1]"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>  <span class="do">## LRT statistic Λ = D0 - D1</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> p1 <span class="sc">+</span> <span class="dv">2</span>, <span class="at">y =</span> D0, <span class="at">xend =</span> p1 <span class="sc">+</span> <span class="dv">2</span>, <span class="at">yend =</span> D1), <span class="co"># Nudged right</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>)),</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> p1 <span class="sc">+</span> <span class="dv">3</span>, <span class="at">y =</span> D1 <span class="sc">+</span> (D0 <span class="sc">-</span> D1) <span class="sc">/</span> <span class="dv">2</span>, <span class="co"># Nudged right</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Lambda == D[0] - D[1]"</span>,</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Customize axes to show the symbolic labels</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(p0, p1, psat),</span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(p[<span class="dv">0</span>]), <span class="fu">expression</span>(p[<span class="dv">1</span>]), <span class="fu">expression</span>(n)),</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>) <span class="co"># Add some padding</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(D_sat, D1, D0),</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="dv">0</span>), <span class="fu">expression</span>(D[<span class="dv">1</span>]), <span class="fu">expression</span>(D[<span class="dv">0</span>]))</span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Labels and Title</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Deviance and Model Complexity"</span>,</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of Parameters"</span>,</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Model Deviance"</span></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Clean theme</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span> <span class="co"># Remove legend, as points are labeled</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M_0 (Null)"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"M_1 (Full)"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"M_Sat (Saturated)"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>As the diagram illustrates, the null model (<span class="math inline">\(M_0\)</span>) has fewer parameters (<span class="math inline">\(p_0\)</span>) and a higher deviance (<span class="math inline">\(D_0\)</span>, or worse fit), while the full model (<span class="math inline">\(M_1\)</span>) has more parameters (<span class="math inline">\(p_1\)</span>) and a lower deviance (<span class="math inline">\(D_1\)</span>). The Likelihood Ratio Test statistic <span class="math inline">\(D\)</span> is the magnitude of this drop in deviance.</p>
<p>For assessing the overall significance of a regression model (<code>fit1_chd</code>), this involves comparing it to its corresponding intercept-only (null) model. The degrees of freedom for the <span class="math inline">\(\chi^2\)</span> test is the difference in the number of parameters, <span class="math inline">\(df = p_1 - p_0\)</span>, which equals the number of predictors in the full model.</p>
<p>Here is an R code chunk demonstrating how to compute this p-value directly from a <code>glm</code> fit object, assuming it is named <code>fit1_chd</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the Likelihood Ratio Test statistic (D) and degrees of freedom (df)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">## by comparing the model's deviance to the null (intercept-only) deviance,</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">## both of which are stored in the 'fit1_chd' object.</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = chd ~ smk + cat + sbp + age + chl + ecg + hpt, 
    family = binomial(link = "logit"), data = CHD.data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -6.048892   1.345165  -4.497  6.9e-06 ***
smk          0.855951   0.306505   2.793  0.00523 ** 
cat          0.732763   0.376129   1.948  0.05139 .  
sbp         -0.006995   0.006976  -1.003  0.31600    
age          0.033956   0.015344   2.213  0.02690 *  
chl          0.008970   0.003274   2.740  0.00615 ** 
ecg          0.417776   0.295553   1.414  0.15750    
hpt          0.655498   0.359976   1.821  0.06861 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 438.56  on 608  degrees of freedom
Residual deviance: 399.35  on 601  degrees of freedom
AIC: 415.35

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lrt_statistic <span class="ot">&lt;-</span> fit1_chd<span class="sc">$</span>null.deviance <span class="sc">-</span> fit1_chd<span class="sc">$</span>deviance</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>lrt_df <span class="ot">&lt;-</span> fit1_chd<span class="sc">$</span>df.null <span class="sc">-</span> fit1_chd<span class="sc">$</span>df.residual</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute the p-value from the chi-squared distribution</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">## We use lower.tail = FALSE to get P(ChiSq &gt; D)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(lrt_statistic, lrt_df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Create and print the result in an ANOVA-like table</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Row 1: Null model</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Row 2: Full model (fit1_chd), showing the test against the null</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>lrt_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Resid. Df"</span> <span class="ot">=</span> <span class="fu">c</span>(fit1_chd<span class="sc">$</span>df.null, fit1_chd<span class="sc">$</span>df.residual),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Resid. Dev"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(fit1_chd<span class="sc">$</span>null.deviance, <span class="dv">4</span>), <span class="fu">round</span>(fit1_chd<span class="sc">$</span>deviance, <span class="dv">4</span>)),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Test Df"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, lrt_df),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Test Statistic (D)"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">round</span>(lrt_statistic, <span class="dv">4</span>)),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p-value"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">4</span>)),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"Null Model"</span>, <span class="st">"Full Model (fit1_chd)"</span>),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span> <span class="co"># Prevent R from changing 'p-value' to 'p.value'</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Likelihood Ratio Test for Model Significance:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood Ratio Test for Model Significance:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lrt_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Test Df"],"name":[3],"type":["int"],"align":["right"]},{"label":["Test Statistic (D)"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p-value"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"608","2":"438.5583","3":"NA","4":"NA","5":"NA","_rn_":"Null Model"},{"1":"601","2":"399.3539","3":"7","4":"39.2044","5":"1.787e-06","_rn_":"Full Model (fit1_chd)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Using built-in anova() function</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fit0_chd <span class="ot">&lt;-</span> <span class="fu">glm</span> (chd<span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> CHD.data, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit0_chd, fit1_chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"608","2":"438.5583","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"601","2":"399.3539","3":"7","4":"39.20436","5":"1.78662e-06","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1_chd, <span class="at">test=</span><span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Df"],"name":[3],"type":["int"],"align":["right"]},{"label":["Resid. Dev"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"608","4":"438.5583","5":"NA","_rn_":"NULL"},{"1":"1","2":"5.745347","3":"607","4":"432.8129","5":"0.0165323862","_rn_":"smk"},{"1":"1","2":"14.371556","3":"606","4":"418.4414","5":"0.0001500519","_rn_":"cat"},{"1":"1","2":"0.757426","3":"605","4":"417.6840","5":"0.3841352552","_rn_":"sbp"},{"1":"1","2":"5.282117","3":"604","4":"412.4019","5":"0.0215455399","_rn_":"age"},{"1":"1","2":"7.861857","3":"603","4":"404.5400","5":"0.0050488517","_rn_":"chl"},{"1":"1","2":"1.870124","3":"602","4":"402.6699","5":"0.1714608889","_rn_":"ecg"},{"1":"1","2":"3.315934","3":"601","4":"399.3539","5":"0.0686113093","_rn_":"hpt"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="assessing-predictive-effect-size-anologue-to-r2_mathrmadj" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="assessing-predictive-effect-size-anologue-to-r2_mathrmadj"><span class="header-section-number">6.8</span> Assessing Predictive Effect-Size (Anologue to <span class="math inline">\(R^2_\mathrm{adj}\)</span>)</h2>
<p>While the LRT assesses overall model significance (in-sample fit), it’s also crucial to evaluate how well the model predicts new, unseen data (out-of-sample performance). A common method is to split the data into a training set (e.g., 2/3 of the data) and a test set (e.g., 1/3). The model is fit using only the training data and then used to make predictions for the test data. We can then compare these predictions to the actual outcomes in the test set.</p>
<section id="understanding-the-confusion-matrix-and-metrics" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="understanding-the-confusion-matrix-and-metrics"><span class="header-section-number">6.8.1</span> Understanding the Confusion Matrix and Metrics</h3>
<p>To evaluate a model’s predictive performance, we classify its probabilistic predictions using a threshold (typically 0.5) and compare them to the true outcomes in a <strong>Confusion Matrix</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><strong>Predicted: 0</strong></th>
<th style="text-align: left;"><strong>Predicted: 1</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Actual: 0</strong></td>
<td style="text-align: left;">True Negative (TN)</td>
<td style="text-align: left;">False Positive (FP)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Actual: 1</strong></td>
<td style="text-align: left;">False Negative (FN)</td>
<td style="text-align: left;">True Positive (TP)</td>
</tr>
</tbody>
</table>
<p>From this matrix, we derive several key performance metrics:</p>
<ul>
<li><p><strong>Misclassification Error Rate (ER):</strong> The proportion of all predictions that were incorrect. <span class="math display">\[
  \text{Error Rate} = \frac{FP + FN}{TP + TN + FP + FN}
  \]</span></p></li>
<li><p><strong>Precision (Positive Predictive Value):</strong> Answers: “Of all the times the model predicted positive, how often was it correct?” This is crucial when the cost of a <strong>False Positive</strong> is high. <span class="math display">\[
  \text{Precision} = \frac{TP}{TP + FP}
  \]</span></p></li>
<li><p><strong>Recall (Sensitivity or True Positive Rate):</strong> Answers: “Of all the actual positive cases, how many did the model find?” This is crucial when the cost of a <strong>False Negative</strong> is high. <span class="math display">\[
  \text{Recall (TPR)} = \frac{TP}{TP + FN}
  \]</span></p></li>
<li><p><strong>ROC Curve and AUC:</strong> An <strong>ROC (Receiver Operating Characteristic) Curve</strong> is a graph that shows a model’s diagnostic ability across <em>all possible classification thresholds</em>. It plots the <strong>True Positive Rate (Recall)</strong> on the y-axis against the <strong>False Positive Rate</strong> (FPR = <span class="math inline">\(\frac{FP}{FP + TN}\)</span>) on the x-axis.</p>
<ul>
<li><strong>Interpretation:</strong> The curve shows the trade-off between sensitivity (finding all the positives) and specificity (not mislabeling negatives). A random “no-skill” classifier is represented by a diagonal line from (0,0) to (1,1). A perfect classifier would hug the <strong>top-left corner</strong> (TPR = 1, FPR = 0).</li>
<li><strong>AUC (Area Under the Curve):</strong> The AUC summarizes the entire curve into a single number from 0 to 1. An AUC of 0.5 corresponds to a random guess, while an AUC of 1.0 represents a perfect model.</li>
</ul></li>
<li><p><strong>Precision-Recall (PR) Curve:</strong> A <strong>PR Curve</strong> plots <strong>Precision</strong> (y-axis) against <strong>Recall</strong> (x-axis) at all possible thresholds.</p>
<ul>
<li><strong>Interpretation:</strong> This curve shows the trade-off between how <em>reliable</em> a positive prediction is (Precision) and how <em>complete</em> the model is at finding all positives (Recall).</li>
<li><strong>When to Use:</strong> The PR curve is particularly informative when the dataset is <strong>imbalanced</strong> (i.e., one class, like “fraud” or “disease,” is much rarer than the other). Unlike the ROC curve, the PR curve’s baseline (the “no-skill” line) is a horizontal line at the proportion of positive cases, which makes it easier to see if the model is performing significantly better than chance in a low-positive-rate scenario. A perfect classifier would hug the <strong>top-right corner</strong> (Precision = 1, Recall = 1).</li>
</ul></li>
</ul>
</section>
<section id="illustration-with-the-simulated-dataset" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="illustration-with-the-simulated-dataset"><span class="header-section-number">6.8.2</span> Illustration with the Simulated Dataset</h3>
<p>This section applies the train/test split and model evaluation workflow to the <code>sim.data</code> created in the previous step.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the pROC library for AUC calculation</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("pROC") # Uncomment to install if needed</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 1. Split the data ---</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="do">## We use 'sim.data' which has 200 rows</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sim.data)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>train_size_sim <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">*</span> n_sim)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>train_indices_sim <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_sim, <span class="at">size =</span> train_size_sim)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>train_data_sim <span class="ot">&lt;-</span> sim.data[train_indices_sim, ]</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>test_data_sim  <span class="ot">&lt;-</span> sim.data[<span class="sc">-</span>train_indices_sim, ]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 2. Refit the model on the training data ---</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="do">## We fit the model y ~ x on the training data</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>fit_train_sim <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data_sim,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 3. Make predictions on the test data ---</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: The true probabilities 'p' are also in test_data_sim</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="do">## We predict from the *fitted* model</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>pred_probs_sim <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_train_sim, <span class="at">newdata =</span> test_data_sim, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Plotting the Predictive Probabilities with True Labels</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 5. Plot sorted predicted probabilities ---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a data frame for plotting</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>plot_data_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Prob =</span> pred_probs_sim,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> <span class="fu">as.factor</span>(test_data_sim<span class="sc">$</span>y),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">TrueProb =</span> test_data_sim<span class="sc">$</span>p <span class="co"># Include true probs for comparison</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Sort by predicted probability</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>plot_data_sim <span class="ot">&lt;-</span> plot_data_sim[<span class="fu">order</span>(plot_data_sim<span class="sc">$</span>Prob), ]</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>plot_data_sim<span class="sc">$</span>Rank <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plot_data_sim)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the plot</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  plot_data_sim<span class="sc">$</span>Rank,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  plot_data_sim<span class="sc">$</span>Prob,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">ifelse</span>(plot_data_sim<span class="sc">$</span>Actual <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(plot_data_sim<span class="sc">$</span>Actual <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Index (Sorted by Predicted Probability)"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Predicted Probability"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicted Probabilities vs. Actual Class (Simulated Data)"</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.5</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Add the true probability curve (sorted by predicted prob)</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="do">## This shows how well the fitted model's predictions align with the true probs</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(plot_data_sim$Rank, plot_data_sim$TrueProb[order(plot_data_sim$Prob)], col = "darkgreen", lwd = 2)</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Add a legend</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"topleft"</span>,</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Actual 0 (o)"</span>, <span class="st">"Actual 1 (x)"</span>),</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/plot-sorted-probabilities-sim-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p><strong>Confusion Matrix with threshold=0.5</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 4. Assess accuracy ---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 4a. Misclassification Error Rate (using 0.5 threshold)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>pred_class_sim <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_probs_sim <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>conf_matrix_sim <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Actual =</span> test_data_sim<span class="sc">$</span>y, <span class="at">Predicted =</span> pred_class_sim)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="do">## --- MODIFIED LINES START ---</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Confusion Matrix (Counts, threshold = 0.5):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix (Counts, threshold = 0.5):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual  0  1
     0 26  5
     1  9 27</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Row Proportions (Given Actual, % Predicted -- Relates to TPR/FPR):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Row Proportions (Given Actual, % Predicted -- Relates to TPR/FPR):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## margin = 1 calculates proportions across rows</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(conf_matrix_sim, <span class="at">margin =</span> <span class="dv">1</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual     0     1
     0 0.839 0.161
     1 0.250 0.750</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Column Proportions (Given Predicted, % Actual -- Relates to Precision):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Column Proportions (Given Predicted, % Actual -- Relates to Precision):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## margin = 2 calculates proportions across columns</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(conf_matrix_sim, <span class="at">margin =</span> <span class="dv">2</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual     0     1
     0 0.743 0.156
     1 0.257 0.844</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- MODIFIED LINES </span><span class="re">END</span><span class="do"> ---</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Check if matrix has 2x2 dimensions, otherwise metrics will fail</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">dim</span>(conf_matrix_sim) <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))) {</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Calculate metrics</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  error_rate <span class="ot">&lt;-</span> (FP <span class="sc">+</span> FN) <span class="sc">/</span> (TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  TPR_Recall <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FN) <span class="co"># True Positive Rate (Recall / Sensitivity)</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  FPR <span class="ot">&lt;-</span> FP <span class="sc">/</span> (FP <span class="sc">+</span> TN)      <span class="co"># False Positive Rate (1 - Specificity)</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  Precision <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FP)  <span class="co"># Positive Predictive Value</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Misclassification Error Rate:"</span>, <span class="fu">round</span>(error_rate, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"True Positive Rate (Recall):"</span>, <span class="fu">round</span>(TPR_Recall, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"False Positive Rate:"</span>, <span class="fu">round</span>(FPR, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Precision:"</span>, <span class="fu">round</span>(Precision, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cannot calculate full metrics: model predicted only one class.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Misclassification Error Rate: 0.209 
True Positive Rate (Recall): 0.75 
False Positive Rate: 0.1613 
Precision: 0.8438 </code></pre>
</div>
</div>
<p><strong>Confusion Matrix with threshold=0.1</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pred_class_sim <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_probs_sim <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>conf_matrix_sim <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Actual =</span> test_data_sim<span class="sc">$</span>y, <span class="at">Predicted =</span> pred_class_sim)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="do">## --- MODIFIED LINES START ---</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Confusion Matrix (Counts, threshold = 0.1):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix (Counts, threshold = 0.1):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual  0  1
     0 15 16
     1  1 35</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Row Proportions (Given Actual, % Predicted -- Relates to TPR/FPR):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Row Proportions (Given Actual, % Predicted -- Relates to TPR/FPR):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## margin = 1 calculates proportions across rows</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(conf_matrix_sim, <span class="at">margin =</span> <span class="dv">1</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual     0     1
     0 0.484 0.516
     1 0.028 0.972</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Column Proportions (Given Predicted, % Actual -- Relates to Precision):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Column Proportions (Given Predicted, % Actual -- Relates to Precision):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## margin = 2 calculates proportions across columns</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(conf_matrix_sim, <span class="at">margin =</span> <span class="dv">2</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual     0     1
     0 0.938 0.314
     1 0.062 0.686</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- MODIFIED LINES </span><span class="re">END</span><span class="do"> ---</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Check if matrix has 2x2 dimensions</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">dim</span>(conf_matrix_sim) <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))) {</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> conf_matrix_sim[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Calculate metrics</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  error_rate <span class="ot">&lt;-</span> (FP <span class="sc">+</span> FN) <span class="sc">/</span> (TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  TPR_Recall <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FN) <span class="co"># True Positive Rate (Recall / Sensitivity)</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  FPR <span class="ot">&lt;-</span> FP <span class="sc">/</span> (FP <span class="sc">+</span> TN)      <span class="co"># False Positive Rate (1 - Specificity)</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  Precision <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FP)  <span class="co"># Positive Predictive Value</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Misclassification Error Rate:"</span>, <span class="fu">round</span>(error_rate, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"True Positive Rate (Recall):"</span>, <span class="fu">round</span>(TPR_Recall, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"False Positive Rate:"</span>, <span class="fu">round</span>(FPR, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Precision:"</span>, <span class="fu">round</span>(Precision, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cannot calculate full metrics: model predicted only one class.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Misclassification Error Rate: 0.2537 
True Positive Rate (Recall): 0.9722 
False Positive Rate: 0.5161 
Precision: 0.6863 </code></pre>
</div>
</div>
<p><strong>ROC curve and Area Under the ROC (AUC)</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 4b. Area Under the Curve (AUC)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>roc_curve_sim <span class="ot">&lt;-</span> <span class="fu">roc</span>(test_data_sim<span class="sc">$</span>y, pred_probs_sim, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the ROC curve</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve_sim, <span class="at">main =</span> <span class="st">"ROC Curve (Simulated Test Data)"</span>, <span class="at">print.auc =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>auc_value_sim <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve_sim)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Area Under the Curve (AUC):"</span>, <span class="fu">round</span>(auc_value_sim, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Area Under the Curve (AUC): 0.8996 </code></pre>
</div>
</div>
<p><strong>PR curve and Area Under PR Curve (AUPR)</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the ROCR library</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("ROCR") # Uncomment to install if needed</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 1. Create a 'prediction' object ---</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 'prediction' takes all predictions and all true labels</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(pred_probs_sim, test_data_sim<span class="sc">$</span>y)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 2. Create a 'performance' object for PR ---</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="do">## "prec" is for precision, "rec" is for recall</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>perf_pr <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="at">measure =</span> <span class="st">"prec"</span>, <span class="at">x.measure =</span> <span class="st">"rec"</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 3. Calculate Area Under the PR Curve (AUPR) ---</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>perf_auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="at">measure =</span> <span class="st">"aucpr"</span>) <span class="co"># "aucpr" = Area Under PR Curve</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>aupr_value <span class="ot">&lt;-</span> perf_auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Area Under PR Curve (AUPR):"</span>, <span class="fu">round</span>(aupr_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Area Under PR Curve (AUPR): 0.9157 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 4. Plot the performance object ---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_pr, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Precision-Recall Curve (Simulated Test Data)"</span>, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 5. Calculate and add the 'no-skill' baseline ---</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>baseline_precision_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(test_data_sim<span class="sc">$</span>y <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">length</span>(test_data_sim<span class="sc">$</span>y)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> baseline_precision_sim, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 6. Add a legend with AUPR ---</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, </span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste</span>(<span class="st">"Model (AUPR ="</span>, <span class="fu">round</span>(aupr_value, <span class="dv">4</span>), <span class="st">")"</span>),  <span class="co"># &lt;-- MODIFIED LINE</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste</span>(<span class="st">"Baseline ("</span>, <span class="fu">round</span>(baseline_precision_sim, <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>       ), </span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>), </span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>) <span class="co"># bty="n" removes the box</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/pr-curve-rocr-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application-to-the-chd-dataset" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="application-to-the-chd-dataset"><span class="header-section-number">6.8.3</span> Application to the CHD Dataset</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the pROC library for AUC calculation</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("pROC") # Uncomment to install if needed</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 1. Split the data ---</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(CHD.data)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">*</span> n)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> train_size)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> CHD.data[train_indices, ]</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>test_data  <span class="ot">&lt;-</span> CHD.data[<span class="sc">-</span>train_indices, ]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 2. Refit the model on the training data ---</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>fit_train <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  chd <span class="sc">~</span> smk <span class="sc">+</span> cat <span class="sc">+</span> sbp <span class="sc">+</span> age <span class="sc">+</span> chl <span class="sc">+</span> ecg <span class="sc">+</span> hpt,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 3. Make predictions on the test data ---</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_train, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Plot Predictive Probabilities</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 5. Plot sorted predicted probabilities ---</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a data frame for plotting</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Prob =</span> pred_probs,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> <span class="fu">as.factor</span>(test_data<span class="sc">$</span>chd)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Sort by predicted probability</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> plot_data[<span class="fu">order</span>(plot_data<span class="sc">$</span>Prob), ]</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>Rank <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plot_data)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the plot</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="do">## We use 'pch' (plot character) to set different symbols</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 'pch = 1' is 'o' (default)</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 'pch = 4' is 'x'</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>Rank,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>Prob,</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">ifelse</span>(plot_data<span class="sc">$</span>Actual <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(plot_data<span class="sc">$</span>Actual <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Index (Sorted by Predicted Probability)"</span>,</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Log-odds of Predicted Probability"</span>,</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicted Probabilities vs. Actual Class"</span>,</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.5</span>)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Add a legend</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"topleft"</span>,</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Actual 0 (o)"</span>, <span class="st">"Actual 1 (x)"</span>),</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/plot-sorted-probabilities-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p><strong>ROC curve and Area Under the ROC (AUC)</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 4b. Area Under the Curve (AUC)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(test_data<span class="sc">$</span>chd, pred_probs, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the ROC curve</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Test Data)"</span>, <span class="at">print.auc =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Area Under the Curve (AUC):"</span>, <span class="fu">round</span>(auc_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Area Under the Curve (AUC): 0.6872 </code></pre>
</div>
</div>
<p><strong>PR curve and Area Under PR Curve (AUPR)</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the ROCR library</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("ROCR") # Uncomment to install if needed</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 1. Create a 'prediction' object ---</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 'prediction' takes all predictions and all true labels</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="do">## We use 'pred_probs' and 'test_data$chd' from the CHD data split</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(pred_probs, test_data<span class="sc">$</span>chd)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 2. Create a 'performance' object for PR ---</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="do">## "prec" is for precision, "rec" is for recall</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>perf_pr <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="at">measure =</span> <span class="st">"prec"</span>, <span class="at">x.measure =</span> <span class="st">"rec"</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 3. Calculate Area Under the PR Curve (AUPR) ---</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>perf_auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="at">measure =</span> <span class="st">"aucpr"</span>) <span class="co"># "aucpr" = Area Under PR Curve</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>aupr_value <span class="ot">&lt;-</span> perf_auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Area Under PR Curve (AUPR):"</span>, <span class="fu">round</span>(aupr_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Area Under PR Curve (AUPR): 0.2826 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 4. Plot the performance object ---</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_pr, </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Precision-Recall Curve (Test Data)"</span>, </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 5. Calculate and add the 'no-skill' baseline ---</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>baseline_precision <span class="ot">&lt;-</span> <span class="fu">sum</span>(test_data<span class="sc">$</span>chd <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">length</span>(test_data<span class="sc">$</span>chd)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> baseline_precision, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="do">## --- 6. Add a legend with AUPR ---</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste</span>(<span class="st">"Model (AUPR ="</span>, <span class="fu">round</span>(aupr_value, <span class="dv">4</span>), <span class="st">")"</span>),  <span class="co"># &lt;-- MODIFIED LINE</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste</span>(<span class="st">"Baseline ("</span>, <span class="fu">round</span>(baseline_precision, <span class="dv">3</span>), <span class="st">")"</span>)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>       ), </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>), </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>) <span class="co"># bty="n" removes the box</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/pr-curve-rocr-chd-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-of-entropy" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="analysis-of-entropy"><span class="header-section-number">6.9</span> Analysis of Entropy</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>anoen_chd <span class="ot">&lt;-</span> <span class="fu">anoen</span>(fit1_chd)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anoen_chd, <span class="at">format =</span> <span class="st">"kable"</span>, <span class="at">include.F =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Term</th>
<th style="text-align: right;"><span class="math inline">\(p\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\text{df}_c\)</span></th>
<th style="text-align: right;"><span class="math inline">\(d_{\text{adj}}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\hat I_{NH}\)</span></th>
<th style="text-align: right;">partial <span class="math inline">\(\hat R_{NH}^2\)</span></th>
<th style="text-align: right;">comp. <span class="math inline">\(\hat R_{NH}^2\)</span></th>
<th style="text-align: right;">cum. <span class="math inline">\(\hat R_{NH}^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Pr(&gt;\chi^2_{\text{df}_c})\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Pr(&gt;F)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">(Null)</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">0.7218</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: right;">smk</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0025</td>
<td style="text-align: right;">0.7140</td>
<td style="text-align: right;">0.0078</td>
<td style="text-align: right;">0.0151</td>
<td style="text-align: right;">0.0151</td>
<td style="text-align: right;">0.0151</td>
<td style="text-align: right;">0.0166</td>
<td style="text-align: right;">0.0168</td>
</tr>
<tr class="odd">
<td style="text-align: right;">cat</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0041</td>
<td style="text-align: right;">0.6920</td>
<td style="text-align: right;">0.0219</td>
<td style="text-align: right;">0.0422</td>
<td style="text-align: right;">0.0419</td>
<td style="text-align: right;">0.0570</td>
<td style="text-align: right;">0.0002</td>
<td style="text-align: right;">0.0002</td>
</tr>
<tr class="even">
<td style="text-align: right;">sbp</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0058</td>
<td style="text-align: right;">0.6924</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0008</td>
<td style="text-align: right;">-0.0008</td>
<td style="text-align: right;">0.0562</td>
<td style="text-align: right;">0.3862</td>
<td style="text-align: right;">0.3859</td>
</tr>
<tr class="odd">
<td style="text-align: right;">age</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0074</td>
<td style="text-align: right;">0.6854</td>
<td style="text-align: right;">0.0070</td>
<td style="text-align: right;">0.0136</td>
<td style="text-align: right;">0.0132</td>
<td style="text-align: right;">0.0694</td>
<td style="text-align: right;">0.0218</td>
<td style="text-align: right;">0.0221</td>
</tr>
<tr class="even">
<td style="text-align: right;">chl</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0091</td>
<td style="text-align: right;">0.6742</td>
<td style="text-align: right;">0.0113</td>
<td style="text-align: right;">0.0218</td>
<td style="text-align: right;">0.0210</td>
<td style="text-align: right;">0.0904</td>
<td style="text-align: right;">0.0051</td>
<td style="text-align: right;">0.0053</td>
</tr>
<tr class="odd">
<td style="text-align: right;">ecg</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0108</td>
<td style="text-align: right;">0.6728</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0027</td>
<td style="text-align: right;">0.0026</td>
<td style="text-align: right;">0.0930</td>
<td style="text-align: right;">0.1737</td>
<td style="text-align: right;">0.1741</td>
</tr>
<tr class="even">
<td style="text-align: right;">hpt</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0125</td>
<td style="text-align: right;">0.6690</td>
<td style="text-align: right;">0.0038</td>
<td style="text-align: right;">0.0073</td>
<td style="text-align: right;">0.0070</td>
<td style="text-align: right;">0.1000</td>
<td style="text-align: right;">0.0698</td>
<td style="text-align: right;">0.0706</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.compR2</span>(anoen_chd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script>
/* loadtoc.js — overlay TOC drawer (no layout shift, up to h3)
   - Creates a fixed-position overlay panel + backdrop
   - Clones existing Quarto TOC if found; else builds from <main> h2/h3
   - Collapses h3 under h2 initially; click to toggle
   - Closes on link click, backdrop click, or ESC
   - Prevents body scroll when open; does NOT push page content
*/

(() => {
  // ===== Config =====
  const CFG = {
    side: 'right',            // 'right' | 'left'
    fontSize: '14px',
    width: 400,               // px
    maxWidthVw: 92,           // %
    headerOffset: 80,         // px: scroll margin for headings
    zBase: 2000,              // base z-index for overlay/backdrop
    buildFromHeadingsIfMissingSidebar: true, // fallback builder
    headingSelector: 'main :is(h2,h3)',      // used if building fallback
    maxDepth: 3,              // up to h3
    toggleHotkey: 'KeyT',     // Cmd/Ctrl+Shift+T toggles
  };

  // ===== Utilities =====
  const $ = (sel, el=document) => el.querySelector(sel);
  const $$ = (sel, el=document) => [...el.querySelectorAll(sel)];
  const on = (el, ev, fn, opts) => el && el.addEventListener(ev, fn, opts);

  const slugify = (txt) =>
    txt.toLowerCase()
       .trim()
       .replace(/[\s\.\,\/:\;\?\!\(\)\[\]\{\}"'`]+/g, '-')
       .replace(/-+/g, '-')
       .replace(/^-|-$/g, '');

  function ensureId(el) {
    if (!el.id) el.id = slugify(el.textContent || 'section');
    return el.id;
  }

  function injectStyles() {
    const style = document.createElement('style');
    style.setAttribute('data-toc-style', 'overlay');
    style.textContent = `
      :root { 
        --toc-width:${CFG.width}px; 
        --toc-offset:${CFG.headerOffset}px; 
        --toc-z:${CFG.zBase}; 
        --toc-font-size:${CFG.fontSize};
      }
      main :is(h1,h2,h3,h4,h5,h6){ scroll-margin-top: var(--toc-offset); }

      #toc-toggle-btn {
        position: fixed; top: 50px; ${CFG.side}: 10px;
        z-index: calc(var(--toc-z) + 2);
        padding: 0.1rem 0.6rem; border: 1px solid #ddd; border-radius: 999px;
        background: #fff; cursor: pointer; box-shadow: 0 8px 24px rgba(0,0,0,.10);
        font: 1000 32px system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      }

      #toc-backdrop {
        position: fixed; inset: 0; background: rgba(0,0,0,.25);
        opacity: 0; pointer-events: none; transition: opacity .2s ease;
        z-index: var(--toc-z);
      }
      body.toc-open #toc-backdrop { opacity: 1; pointer-events: auto; }

      #toc-panel {
        position: fixed; top: 0; ${CFG.side}: 0; height: 100vh;
        width: var(--toc-width); max-width: ${CFG.maxWidthVw}vw;
        background: #fff; box-shadow: ${CFG.side==='right' ? '-16px' : '16px'} 0 32px rgba(0,0,0,.08);
        transform: translateX(${CFG.side==='right' ? '100%' : '-100%'});
        transition: transform .22s ease;
        z-index: calc(var(--toc-z) + 1);
        display: flex; flex-direction: column;
      }
      body.toc-open #toc-panel { transform: translateX(0); }
      body.toc-open { overflow: hidden; }

      #toc-head {
        display:flex; align-items:center; justify-content:space-between;
        gap:0.5rem; padding:.75rem .9rem; border-bottom:1px solid #eee;
      }
      #toc-head h3{ margin:0; font:600 16px system-ui,-apple-system,Segoe UI,Roboto,sans-serif; }

      #toc-content { 
        overflow:auto; 
        padding:.6rem .85rem 1rem; 
        font-size: var(--toc-font-size);  
      }
      #toc-content nav, #toc-content .book-toc { line-height:1.5; }
      #toc-content ul { list-style:none; margin:.25rem 0; padding-left:1rem; }
      #toc-content li { margin:.1rem 0; }
      #toc-content a { text-decoration:none; }
      #toc-content .lvl-1 > a { font-weight:600; }
      #toc-content .lvl-2 > a { font-weight:500; }
      #toc-content .lvl-3 > a { font-weight:400; }

      .toc-icon-btn{
        border:1px solid #ddd; border-radius:8px; padding:.35rem .55rem; background:#fff; cursor:pointer;
      }

      /* collapsible h3 under h2 */
      .toc-caret { margin-right:.35rem; user-select:none; cursor:pointer; }
      .toc-collapsed > ul { display:none; }
      .toc-caret::before { content: '▾'; display:inline-block; transform: rotate(0deg); transition: transform .12s linear; }
      .toc-collapsed > .toc-row .toc-caret::before { transform: rotate(-90deg); }
      .toc-row { display:flex; align-items:center; gap:.25rem; }
    `;
    document.head.appendChild(style);
  }

  // Create skeleton (toggle button, backdrop, panel)
  function createShell() {
    // Toggle button (if user already has one with #toc-toggle-btn, reuse)
    let toggle = document.getElementById('toc-toggle-btn');
    if (!toggle) {
      toggle = document.createElement('button');
      toggle.id = 'toc-toggle-btn';
      toggle.type = 'button';
      toggle.setAttribute('aria-expanded','false');
      toggle.setAttribute('aria-controls','toc-panel');
      toggle.title = 'Open Table of Contents';
      toggle.textContent = '☰';
      document.body.appendChild(toggle);
    }

    // Backdrop
    let backdrop = document.getElementById('toc-backdrop');
    if (!backdrop) {
      backdrop = document.createElement('div');
      backdrop.id = 'toc-backdrop';
      backdrop.setAttribute('aria-hidden','true');
      document.body.appendChild(backdrop);
    }

    // Panel
    let panel = document.getElementById('toc-panel');
    if (!panel) {
      panel = document.createElement('aside');
      panel.id = 'toc-panel';
      panel.setAttribute('role','dialog');
      panel.setAttribute('aria-modal','true');
      panel.setAttribute('aria-label','Table of Contents');

      const head = document.createElement('div');
      head.id = 'toc-head';
      const h = document.createElement('h3'); h.textContent = 'Table of Contents';
      const close = document.createElement('button'); close.className='toc-icon-btn'; close.id='toc-close'; close.textContent='✕'; close.title='Close TOC';
      head.append(h, close);

      const content = document.createElement('div');
      content.id = 'toc-content';
      content.innerHTML = '<p><em>Loading…</em></p>';

      panel.append(head, content);
      document.body.appendChild(panel);
    }

    return { toggle, backdrop, panel };
  }

  function openTOC(toggleBtn) {
    document.body.classList.add('toc-open');
    toggleBtn?.setAttribute('aria-expanded','true');
  }
  function closeTOC(toggleBtn) {
    document.body.classList.remove('toc-open');
    toggleBtn?.setAttribute('aria-expanded','false');
  }

  // Build TOC DOM: either clone Quarto sidebar TOC or build from headings
  function findExistingTOC() {
    // Try common Quarto TOC containers
    return (
      $('nav[role="navigation"].toc-active') ||
      $('#TOC') ||
      $('nav.sidebar-navigation .toc-active') ||
      null
    );
  }

  function buildFromHeadings() {
    const container = document.createElement('div');
    container.className = 'book-toc';
    const ul1 = document.createElement('ul');

    const heads = $$(CFG.headingSelector).filter(h => {
      const level = Number(h.tagName.slice(1));
      return level >= 2 && level <= CFG.maxDepth;
    });

    let currentH2LI = null;
    heads.forEach(h => {
      const level = Number(h.tagName.slice(1));
      const id = '#' + ensureId(h);
      const a = document.createElement('a');
      a.href = id;
      a.textContent = h.textContent.trim() || (level === 2 ? 'Section' : 'Subsection');

      if (level === 2) {
        const li = document.createElement('li'); li.className = 'lvl-2';
        const row = document.createElement('div'); row.className = 'toc-row';
        const caret = document.createElement('span'); caret.className = 'toc-caret'; caret.title = 'Toggle subsections';
        row.append(caret, a);
        li.appendChild(row);

        const ul2 = document.createElement('ul'); // for h3 children
        li.appendChild(ul2);
        li.classList.add('toc-collapsed'); // start collapsed
        ul1.appendChild(li);
        currentH2LI = li;

        on(caret, 'click', () => li.classList.toggle('toc-collapsed'));
      } else if (level === 3) {
        if (!currentH2LI) {
          // Create a dummy h2 wrapper if needed
          const dummy = document.createElement('li'); dummy.className = 'lvl-2 toc-collapsed';
          const row = document.createElement('div'); row.className = 'toc-row';
          const caret = document.createElement('span'); caret.className = 'toc-caret'; caret.title = 'Toggle subsections';
          const label = document.createElement('a'); label.href = '#'; label.textContent = '(Untitled section)';
          row.append(caret, label);
          dummy.appendChild(row);
          const ul2 = document.createElement('ul'); dummy.appendChild(ul2);
          ul1.appendChild(dummy);
          currentH2LI = dummy;
          on(caret, 'click', () => dummy.classList.toggle('toc-collapsed'));
        }
        const ul2 = currentH2LI.querySelector('ul') || (() => { const u=document.createElement('ul'); currentH2LI.appendChild(u); return u; })();
        const li3 = document.createElement('li'); li3.className = 'lvl-3';
        li3.appendChild(a);
        ul2.appendChild(li3);
      }
    });

    // Wrap under a fake lvl-1 “This page”
    const li1 = document.createElement('li'); li1.className = 'lvl-1';
    const aTop = document.createElement('a'); aTop.href = '#'; aTop.textContent = document.title || 'This page';
    li1.appendChild(aTop);
    li1.appendChild(ul1);

    const rootUL = document.createElement('ul'); rootUL.appendChild(li1);
    container.appendChild(rootUL);
    return container;
  }

  function prepareLinksCloseOnClick(scopeEl, toggleBtn) {
    $$('#toc-content a', scopeEl).forEach(a => {
      on(a, 'click', () => {
        // let the browser jump first, then close to avoid covering target
        setTimeout(() => closeTOC(toggleBtn), 0);
      });
    });
  }

  // ===== Init =====
  function init() {
    injectStyles();
    const { toggle, backdrop, panel } = createShell();

    const closeBtn = $('#toc-close', panel);
    const content = $('#toc-content', panel);

    // Open/close wiring
    on(toggle, 'click', () => openTOC(toggle));
    on(closeBtn, 'click', () => closeTOC(toggle));
    on(backdrop, 'click', () => closeTOC(toggle));
    on(document, 'keydown', (e) => {
      if (e.key === 'Escape') closeTOC(toggle);
      // Cmd/Ctrl+Shift+T hotkey
      if ((e.metaKey || e.ctrlKey) && e.shiftKey && e.code === CFG.toggleHotkey) {
        e.preventDefault();
        document.body.classList.contains('toc-open') ? closeTOC(toggle) : openTOC(toggle);
      }
    });

    // Fill content
    const existing = findExistingTOC();
    if (existing) {
      const cloned = existing.cloneNode(true);
      // If the cloned nav already has nested lists, just drop it in
      content.innerHTML = '';
      content.appendChild(cloned);
      // Optional: start with h3 collapsed if structure resembles h2>ul>li>ul
      // (Skip auto-collapse for cloned Quarto TOC to avoid fighting its JS)
      prepareLinksCloseOnClick(panel, toggle);
    } else if (CFG.buildFromHeadingsIfMissingSidebar) {
      const built = buildFromHeadings();
      content.innerHTML = '';
      content.appendChild(built);
      prepareLinksCloseOnClick(panel, toggle);
    } else {
      content.innerHTML = '<p><em>No TOC found on this page.</em></p>';
    }
  }

  // Run after DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../unit3-mlr/residuals.html" class="pagination-link" aria-label="Residual Diagnostics for Regression Modelling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Residual Diagnostics for Regression Modelling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../unit5-factor/crbd.html" class="pagination-link" aria-label="One-factor Design and Analysis">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">One-factor Design and Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>