{
  "hash": "f28051d5850d92165d17abce469a6e60",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Multiple Linear Regression\"\nauthor:\n  - name: \"Longhai Li\"\n    affiliation: \"University of Saskatchewan\"\n    url: \"https://longhaisk.github.io/\"\ndate: today\neditor: source\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n## An Example: Wire Bond Strength Dataset\n\n### Loading Data and Visualization\n\n**Note:** You must change the file paths in the `read.csv()` functions below to match the location of the files on your computer (for example `C:\\\\Users\\\\<YourUsername>\\\\Documents` on Windows).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Read data. Change the path as necessary.\n## Example: bond.data <- read.csv(\"wire-bond.csv\")\nbond.data <- read.csv(\"wire-bond.csv\")\n\n## This will now be automatically rendered as a paged table\nbond.data\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"strength\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"length\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"height\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"9.95\",\"2\":\"2\",\"3\":\"50\"},{\"1\":\"24.45\",\"2\":\"8\",\"3\":\"110\"},{\"1\":\"31.75\",\"2\":\"11\",\"3\":\"120\"},{\"1\":\"35.00\",\"2\":\"10\",\"3\":\"550\"},{\"1\":\"25.02\",\"2\":\"8\",\"3\":\"295\"},{\"1\":\"16.86\",\"2\":\"4\",\"3\":\"200\"},{\"1\":\"14.38\",\"2\":\"2\",\"3\":\"375\"},{\"1\":\"9.60\",\"2\":\"2\",\"3\":\"52\"},{\"1\":\"24.35\",\"2\":\"9\",\"3\":\"100\"},{\"1\":\"27.50\",\"2\":\"8\",\"3\":\"300\"},{\"1\":\"17.08\",\"2\":\"4\",\"3\":\"412\"},{\"1\":\"37.00\",\"2\":\"11\",\"3\":\"400\"},{\"1\":\"41.95\",\"2\":\"12\",\"3\":\"500\"},{\"1\":\"11.66\",\"2\":\"2\",\"3\":\"360\"},{\"1\":\"21.65\",\"2\":\"4\",\"3\":\"205\"},{\"1\":\"17.89\",\"2\":\"4\",\"3\":\"400\"},{\"1\":\"69.00\",\"2\":\"20\",\"3\":\"600\"},{\"1\":\"10.30\",\"2\":\"1\",\"3\":\"585\"},{\"1\":\"34.93\",\"2\":\"10\",\"3\":\"540\"},{\"1\":\"46.59\",\"2\":\"15\",\"3\":\"250\"},{\"1\":\"44.88\",\"2\":\"15\",\"3\":\"290\"},{\"1\":\"54.12\",\"2\":\"16\",\"3\":\"510\"},{\"1\":\"56.63\",\"2\":\"17\",\"3\":\"590\"},{\"1\":\"22.13\",\"2\":\"6\",\"3\":\"100\"},{\"1\":\"21.15\",\"2\":\"5\",\"3\":\"400\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n\n**2D Visualization**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 3), mar = c(5, 4, 2, 1))\n\n## 1) length vs strength\ni1 <- which(!is.na(bond.data$length) & !is.na(bond.data$strength))\nplot(bond.data$length[i1], bond.data$strength[i1],\n     xlab = \"Wire Length\", ylab = \"Pull strength\", pch = 19)\ntext(bond.data$length[i1], bond.data$strength[i1],\n     labels = i1, pos = 1, offset = 0.4, cex = 0.75)\n\n## 2) height vs strength\ni2 <- which(!is.na(bond.data$height) & !is.na(bond.data$strength))\nplot(bond.data$height[i2], bond.data$strength[i2],\n     xlab = \"Die height\", ylab = \"Pull strength\", pch = 19)\ntext(bond.data$height[i2], bond.data$strength[i2],\n     labels = i2, pos = 1, offset = 0.4, cex = 0.75)\n\n## 3) height vs length\ni3 <- which(!is.na(bond.data$height) & !is.na(bond.data$length))\nplot(bond.data$height[i3], bond.data$length[i3],\n     xlab = \"Die height\", ylab = \"Length\", pch = 19)\ntext(bond.data$height[i3], bond.data$length[i3],\n     labels = i3, pos = 1, offset = 0.4, cex = 0.75)\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-3-1.png){width=576}\n:::\n:::\n\n\n\n\n**3D Visualize**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scatterplot3d)\n\npar(mfrow = c(1,1))\ns3d <- with(bond.data, scatterplot3d(\n  x = length,\n  y = height,\n  z = strength,\n  pch = 19,\n  color = \"steelblue\",\n  main = \"3D Scatterplot: Strength vs. Length and Height\",\n  xlab = \"Length\",\n  ylab = \"Height\",\n  zlab = \"Strength\",\n  angle = 60\n))\n\nfit <- lm(strength ~ length + height, data = bond.data)\ns3d$plane3d(fit, lty.box = \"solid\")\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-4-1.png){width=576}\n:::\n:::\n\n\n\n\n### Model Fitting and Summary\n\nWe fit a multiple linear regression model with `strength` as the response variable and `length` and `height` as predictors.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(strength ~ length + height, data = bond.data)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = strength ~ length + height, data = bond.data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-3.865 -1.542 -0.362  1.196  5.841 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 2.263791   1.060066   2.136 0.044099 *  \nlength      2.744270   0.093524  29.343  < 2e-16 ***\nheight      0.012528   0.002798   4.477 0.000188 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.288 on 22 degrees of freedom\nMultiple R-squared:  0.9811,\tAdjusted R-squared:  0.9794 \nF-statistic: 572.2 on 2 and 22 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\nThe summary provides the ANOVA F-test for overall significance, $R^2$, adjusted $R^2$, and t-tests for individual coefficients.\n\n### Confidence Intervals and Model Components\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Confidence intervals\nconfint(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  2.5 %     97.5 %\n(Intercept) 0.065348613 4.46223426\nlength      2.550313061 2.93822623\nheight      0.006724246 0.01833138\n```\n\n\n:::\n\n```{.r .cell-code}\n## Fitted values and residuals\npred <- fitted.values(fit)\ne <- resid(fit)\ndata.frame(y = bond.data$strength, y.hat = pred, e = e)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y.hat\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"e\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"9.95\",\"2\":\"8.378721\",\"3\":\"1.57127871\",\"_rn_\":\"1\"},{\"1\":\"24.45\",\"2\":\"25.596008\",\"3\":\"-1.14600783\",\"_rn_\":\"2\"},{\"1\":\"31.75\",\"2\":\"33.954095\",\"3\":\"-2.20409488\",\"_rn_\":\"3\"},{\"1\":\"35.00\",\"2\":\"36.596784\",\"3\":\"-1.59678413\",\"_rn_\":\"4\"},{\"1\":\"25.02\",\"2\":\"27.913653\",\"3\":\"-2.89365294\",\"_rn_\":\"5\"},{\"1\":\"16.86\",\"2\":\"15.746432\",\"3\":\"1.11356772\",\"_rn_\":\"6\"},{\"1\":\"14.38\",\"2\":\"12.450260\",\"3\":\"1.92974001\",\"_rn_\":\"7\"},{\"1\":\"9.60\",\"2\":\"8.403777\",\"3\":\"1.19622309\",\"_rn_\":\"8\"},{\"1\":\"24.35\",\"2\":\"28.214999\",\"3\":\"-3.86499936\",\"_rn_\":\"9\"},{\"1\":\"27.50\",\"2\":\"27.976292\",\"3\":\"-0.47629200\",\"_rn_\":\"10\"},{\"1\":\"17.08\",\"2\":\"18.402328\",\"3\":\"-1.32232830\",\"_rn_\":\"11\"},{\"1\":\"37.00\",\"2\":\"37.461882\",\"3\":\"-0.46188206\",\"_rn_\":\"12\"},{\"1\":\"41.95\",\"2\":\"41.458933\",\"3\":\"0.49106715\",\"_rn_\":\"13\"},{\"1\":\"11.66\",\"2\":\"12.262343\",\"3\":\"-0.60234282\",\"_rn_\":\"14\"},{\"1\":\"21.65\",\"2\":\"15.809071\",\"3\":\"5.84092866\",\"_rn_\":\"15\"},{\"1\":\"17.89\",\"2\":\"18.251995\",\"3\":\"-0.36199456\",\"_rn_\":\"16\"},{\"1\":\"69.00\",\"2\":\"64.665871\",\"3\":\"4.33412887\",\"_rn_\":\"17\"},{\"1\":\"10.30\",\"2\":\"12.336831\",\"3\":\"-2.03683074\",\"_rn_\":\"18\"},{\"1\":\"34.93\",\"2\":\"36.471506\",\"3\":\"-1.54150602\",\"_rn_\":\"19\"},{\"1\":\"46.59\",\"2\":\"46.559789\",\"3\":\"0.03021107\",\"_rn_\":\"20\"},{\"1\":\"44.88\",\"2\":\"47.060901\",\"3\":\"-2.18090138\",\"_rn_\":\"21\"},{\"1\":\"54.12\",\"2\":\"52.561290\",\"3\":\"1.55871047\",\"_rn_\":\"22\"},{\"1\":\"56.63\",\"2\":\"56.307784\",\"3\":\"0.32221591\",\"_rn_\":\"23\"},{\"1\":\"22.13\",\"2\":\"19.982190\",\"3\":\"2.14780957\",\"_rn_\":\"24\"},{\"1\":\"21.15\",\"2\":\"20.996264\",\"3\":\"0.15373580\",\"_rn_\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n## Covariance matrix and standard errors\ncov.mat <- vcov(fit)\ncov.mat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             (Intercept)        length        height\n(Intercept)  1.123740429 -3.921612e-02 -1.781991e-03\nlength      -0.039216122  8.746709e-03 -9.903775e-05\nheight      -0.001781991 -9.903775e-05  7.831149e-06\n```\n\n\n:::\n\n```{.r .cell-code}\ndata.frame(std.error = sqrt(diag(cov.mat)))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"std.error\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1.060066238\",\"_rn_\":\"(Intercept)\"},{\"1\":\"0.093523844\",\"_rn_\":\"length\"},{\"1\":\"0.002798419\",\"_rn_\":\"height\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## RSS-based Inference: F-test, and adjusted $R^2$\n\n**The General Linear Model**\n\nThe general linear model is:\n\n$$y = X\\beta + \\epsilon$$\n\n-   $y$: $n \\times 1$ vector of responses\n-   $X$: $n \\times p$ design matrix (first column often ones)\n-   $\\beta$: $p \\times 1$ parameter vector, where $p=k+1$\n-   $\\epsilon$: $n \\times 1$ error vector\n\n### RSS-Based Quantities\n\n#### RSS-Based Quantities\n\n| Source | Sum of Squares | $R^2$ | df | Mean Squares | $F$ | SS$_\\mathrm{adj}$ | $\\hat{\\sigma}^2$ | $R^2_{\\mathrm{adj}}$ |\n|:-------|:-------|:-------|:------:|:-------|:-------|:-------|:-------|:-------|\n| $x^\\top\\beta$ | $\\mathrm{SSR} = \\displaystyle \\sum_{i=1}^n (\\hat y_i - \\bar y)^2$ | $\\displaystyle \\frac{\\mathrm{SSR}}{\\mathrm{SST}}$ | $k$ | $\\displaystyle \\mathrm{MSR} = \\frac{\\mathrm{SSR}}{k}$ | $\\displaystyle \\frac{\\mathrm{MSR}}{\\mathrm{MSE}}$ | $\\mathrm{SSR}_{\\mathrm{adj}}$ | $\\displaystyle \\hat{\\sigma}^2_{x^\\top\\beta} = \\frac{\\mathrm{SSR}_{\\mathrm{adj}}}{n-1}$ | $\\displaystyle \\frac{\\mathrm{SSR}_{\\mathrm{adj}}}{\\mathrm{SST}} = 1 - \\frac{\\mathrm{MSE}}{\\mathrm{MST}}$ |\n| $\\epsilon$ | $\\mathrm{SSE} = \\displaystyle \\sum_{i=1}^n (y_i - \\hat y_i)^2$ | — | $n-p$ | $\\displaystyle \\mathrm{MSE} = \\frac{\\mathrm{SSE}}{n-p}$ | — | $\\mathrm{SSE}$ | $\\displaystyle \\hat{\\sigma}^2_{\\epsilon} = \\mathrm{MSE}$ | — |\n| $y$ | $\\mathrm{SST} = \\displaystyle \\sum_{i=1}^n (y_i - \\bar y)^2$ | — | $n-1$ | $\\displaystyle \\mathrm{MST} = \\frac{\\mathrm{SST}}{n-1}$ | — | $\\mathrm{SST}$ | $\\displaystyle \\hat{\\sigma}^2_{y} = \\mathrm{MST}$ | — |\n\n------------------------------------------------------------------------\n\n**Interpretation of the** $\\hat{\\sigma}^2$ Column\n\nThe $\\hat{\\sigma}^2$ column highlights how each sum of squares corresponds to an estimated variance.\\\nThis view makes the adjusted coefficient of determination clear:\n\n$$\nR^2_{\\mathrm{adj}} \n= 1 - \\frac{\\hat{\\sigma}^2_\\epsilon}{\\hat{\\sigma}^2_y}\n= \\frac{\\hat{\\sigma}^2_{x^\\top\\beta}}{\\hat{\\sigma}^2_y}.\n$$\n\nHence, the adjusted $R^2$ simply expresses the **proportion of total estimated variance** attributable to the fitted model $X\\beta$ rather than the residual noise $\\epsilon$.\n\n### Remarks\n\n#### Fundamental Identities\n\n$$\n\\begin{aligned}\n\\mathrm{SST} &= \\mathrm{SSR} + \\mathrm{SSE}, \\\\\n\\mathrm{MST} &= \\mathrm{MSE} + \\frac{\\mathrm{SSR}_{\\mathrm{adj}}}{n-1}.\n\\end{aligned}\n$$\n\nwhere\n\n$$\n\\mathrm{SSR}_{\\mathrm{adj}} = (n-1)MST-(n-p+k)\\mathrm{MSE} = \\mathrm{SST}-\\mathrm{SSE} - k\\,\\mathrm{MSE} = \\mathrm{SSR} - k\\,\\mathrm{MSE}.\n$$\n\n------------------------------------------------------------------------\n\n#### Difference of $\\hat{\\sigma}^2$ and Mean Squares\n\nThe quantity $\\hat{\\sigma}^2$ represents the **estimated variance** associated with each component of the model. MSE and MST are the estimated variances of the $\\epsilon$ and $y$ itself. However, the MSR, although called **Mean Square for Regression (MSR)** is *NOT* an estimate of the variance or sample variance of $x^\\top \\beta$. The name of \"mean\" here is used to indicate a different thing. Its name “Mean Square” reflects that it is also an estimate estimate of noise variance $\\sigma^2$ under $H_0\\!:\\,\\beta = 0$:\n\n$$\nE[\\mathrm{MSR} \\mid H_0] = \\sigma^2,\n\\qquad \nE[\\mathrm{MSR} \\mid H_1] > \\sigma^2.\n$$\n\nHence the F-statistic\n\n$$\nF = \\frac{\\mathrm{MSR}}{\\mathrm{MSE}}\n$$ is approximately equal to 1 subject to the variability as characterized with F-distribution with degree freedoms of $k$ and $n-p$. This test is to test whether any regression coefficients are not equal to 0.\n\n------------------------------------------------------------------------\n\n#### $\\hat \\sigma^2_{x^\\top\\beta}=\\frac{\\mathrm{SSR}_{\\text{adj}}}{n-1}$\n\n$\\hat \\sigma^2_{x^\\top\\beta}$ is an unbiased estimator of the variance of linear signal when $x$ is a regarded as a random variable. This can be seen from the following equations: $$\nE[\\mathrm{SSR}] = k\\,\\sigma^2 + \\beta^\\top X^\\top (I - J/n)\\,X\\,\\beta,\n\\qquad\nE[\\mathrm{MSE}] = \\sigma^2.\n$$ Hence, $$\n\\begin{aligned}\nE[\\mathrm{SSR}_{\\mathrm{adj}}]\n&= E[\\mathrm{SSR}] - k\\,E[\\mathrm{MSE}] \\\\\n&= \\beta^\\top X^\\top (I - J/n)\\,X\\,\\beta \\\\\n&= \\sum_{i=1}^n (\\mu_i - \\bar\\mu)^2,\n\\end{aligned}\n$$\n\nwhere $$\n\\begin{aligned}\n\\mu_i &= x_i^\\top \\beta \\\\\n\\bar\\mu &= \\tfrac{1}{n}\\sum_{i=1}^n \\mu_i\n\\end{aligned}\n$$ For fixed $X$, $\\mathrm{SSR}_{\\text{adj}}/(n-1)$ equals the **sample variance** of the true means $\\{\\mu_i\\}$ over the observed design points. If the rows of $X$ are independently sampled with covariance matrix $\\Sigma_X$ (the random-$X$ model), then\n\n$$\n\\mathbb{E}_X\\!\\left[\\frac{\\mathrm{SSR}_{\\text{adj}}}{n-1}\\right]\n= \\beta^\\top \\Sigma_X \\beta\n= \\mathrm{Var}(x^\\top \\beta),\n$$\n\n#### Connection to Rao-Blackwell Formula\n\nThe decomposition of $\\hat{\\sigma}^2$ is consistent with the **Rao–Blackwell formula** for total variance:\n\n$$\n\\mathrm{Var}(y) = \\mathrm{Var}\\!\\big(E[y \\mid x]\\big) + E\\!\\big(\\mathrm{Var}[y \\mid x]\\big).\n$$\n\nHere,\n\n-   $\\mathrm{Var}\\!\\big(E[y \\mid x]\\big)$ corresponds to the **explained variation** due to the regression component $x^\\top\\beta$, and\\\n-   $E\\!\\big(\\mathrm{Var}[y \\mid x]\\big)$ corresponds to the **residual variation** due to $\\epsilon$.\n\n### A Simulation Study to Understand the Distributions of RSS\n\n**Data Generating Model**\n\nFor $n=30$ and $p_{max}=20$, simulate with either $H_0:\\beta=\\mathbf 0$ or $H_1$ where only $\\beta_1\\neq 0$; $\\epsilon_i\\sim N(0,1)$.\n\n**Sequence of Fitted Models**\n\n| Model Name | \\# of Predictors (k) | \\# of Parameters (p) | R Formula |\n|:----------------|:----------------:|:----------------:|:--------------------|\n| Model 0 | 0 | 1 | `y ~ 1` |\n| Model 1 | 2 | 3 | `y ~ x_1 + x_2` |\n| ... | ... | ... | ... |\n| Final Model | 20 | 21 | `y ~ x_1 + ... + x_20` |\n\n\n\n\n\n\n\n\n\n#### When $H_0$ is true\n\n\n\n\n\n\n\n\n{{< video rss-h0.mp4 >}}\n\n\n\n\n\n\n#### When $H_1$ is true\n\n\n\n\n\n\n{{< video rss-h1.mp4 >}}\n\n\n\n\n\n\n### Example:  Modelling Children Weight with Height and Age\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Data: Weight, height and age of children\nwgt <- c(64, 71, 53, 67, 55, 58, 77, 57, 56, 51, 76, 68)\nhgt <- c(57, 59, 49, 62, 51, 50, 55, 48, 42, 42, 61, 57)\nage <- c(8, 10, 6, 11, 8, 7, 10, 9, 10, 6, 12, 9)\nchild.data <- data.frame(wgt, hgt, age)\n```\n:::\n\n\n\n\n#### Problem 1: Height then Age\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_hgt_age <- lm(wgt ~ hgt + age, data = child.data)\nsummary(fit_hgt_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = wgt ~ hgt + age, data = child.data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.8708 -1.7004  0.3454  1.4642 10.2336 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept)   6.5530    10.9448   0.599   0.5641  \nhgt           0.7220     0.2608   2.768   0.0218 *\nage           2.0501     0.9372   2.187   0.0565 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.66 on 9 degrees of freedom\nMultiple R-squared:   0.78,\tAdjusted R-squared:  0.7311 \nF-statistic: 15.95 on 2 and 9 DF,  p-value: 0.001099\n```\n\n\n:::\n\n```{.r .cell-code}\nfit_hgt <- lm(wgt ~ hgt, data = child.data)\nsummary(fit_hgt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = wgt ~ hgt, data = child.data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.8736 -3.8973 -0.4402  2.2624 11.8375 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept)   6.1898    12.8487   0.482  0.64035   \nhgt           1.0722     0.2417   4.436  0.00126 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.471 on 10 degrees of freedom\nMultiple R-squared:  0.663,\tAdjusted R-squared:  0.6293 \nF-statistic: 19.67 on 1 and 10 DF,  p-value: 0.001263\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(fit_hgt, fit_hgt_age)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Res.Df\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RSS\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sum of Sq\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"10\",\"2\":\"299.3275\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"9\",\"2\":\"195.4274\",\"3\":\"1\",\"4\":\"103.9001\",\"5\":\"4.784901\",\"6\":\"0.05648531\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nanova(fit_hgt_age)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"588.9225\",\"3\":\"588.92252\",\"4\":\"27.121595\",\"5\":\"0.0005581809\",\"_rn_\":\"hgt\"},{\"1\":\"1\",\"2\":\"103.9001\",\"3\":\"103.90008\",\"4\":\"4.784901\",\"5\":\"0.0564853052\",\"_rn_\":\"age\"},{\"1\":\"9\",\"2\":\"195.4274\",\"3\":\"21.71415\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n#### Problem 2: Age then Height\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_age <- lm(wgt ~ age, data = child.data)\nsummary(fit_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = wgt ~ age, data = child.data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-11.000  -3.911   1.143   4.071  10.000 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept)  30.5714     8.6137   3.549  0.00528 **\nage           3.6429     0.9551   3.814  0.00341 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.015 on 10 degrees of freedom\nMultiple R-squared:  0.5926,\tAdjusted R-squared:  0.5519 \nF-statistic: 14.55 on 1 and 10 DF,  p-value: 0.003407\n```\n\n\n:::\n\n```{.r .cell-code}\nfit_age_hgt <- lm(wgt ~ age + hgt, data = child.data)\nsummary(fit_age_hgt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = wgt ~ age + hgt, data = child.data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.8708 -1.7004  0.3454  1.4642 10.2336 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept)   6.5530    10.9448   0.599   0.5641  \nage           2.0501     0.9372   2.187   0.0565 .\nhgt           0.7220     0.2608   2.768   0.0218 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.66 on 9 degrees of freedom\nMultiple R-squared:   0.78,\tAdjusted R-squared:  0.7311 \nF-statistic: 15.95 on 2 and 9 DF,  p-value: 0.001099\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(fit_age, fit_age_hgt)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Res.Df\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RSS\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sum of Sq\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"10\",\"2\":\"361.8571\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"9\",\"2\":\"195.4274\",\"3\":\"1\",\"4\":\"166.4297\",\"5\":\"7.664574\",\"6\":\"0.02180704\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nanova(fit_age_hgt)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"526.3929\",\"3\":\"526.39286\",\"4\":\"24.241922\",\"5\":\"0.000820522\",\"_rn_\":\"age\"},{\"1\":\"1\",\"2\":\"166.4297\",\"3\":\"166.42975\",\"4\":\"7.664574\",\"5\":\"0.021807043\",\"_rn_\":\"hgt\"},{\"1\":\"9\",\"2\":\"195.4274\",\"3\":\"21.71415\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### Example:  Wire bond strength\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_len_hgt <-  lm(strength ~ length + height, data = bond.data)\nfit_hgt_len <-  lm(strength ~ height+length, data = bond.data)\nanova(fit_len_hgt)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"5885.8521\",\"3\":\"5885.852069\",\"4\":\"1124.29304\",\"5\":\"2.208244e-20\",\"_rn_\":\"length\"},{\"1\":\"1\",\"2\":\"104.9192\",\"3\":\"104.919152\",\"4\":\"20.04126\",\"5\":\"1.882655e-04\",\"_rn_\":\"height\"},{\"1\":\"22\",\"2\":\"115.1735\",\"3\":\"5.235158\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nanova(fit_hgt_len)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sum Sq\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Mean Sq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F value\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1483.2407\",\"3\":\"1483.240660\",\"4\":\"283.3230\",\"5\":\"4.730796e-14\",\"_rn_\":\"height\"},{\"1\":\"1\",\"2\":\"4507.5306\",\"3\":\"4507.530561\",\"4\":\"861.0113\",\"5\":\"3.906908e-19\",\"_rn_\":\"length\"},{\"1\":\"22\",\"2\":\"115.1735\",\"3\":\"5.235158\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"Residuals\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsummary(fit_hgt_len)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = strength ~ height + length, data = bond.data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-3.865 -1.542 -0.362  1.196  5.841 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 2.263791   1.060066   2.136 0.044099 *  \nheight      0.012528   0.002798   4.477 0.000188 ***\nlength      2.744270   0.093524  29.343  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.288 on 22 degrees of freedom\nMultiple R-squared:  0.9811,\tAdjusted R-squared:  0.9794 \nF-statistic: 572.2 on 2 and 22 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(fit_len_hgt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = strength ~ length + height, data = bond.data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-3.865 -1.542 -0.362  1.196  5.841 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 2.263791   1.060066   2.136 0.044099 *  \nlength      2.744270   0.093524  29.343  < 2e-16 ***\nheight      0.012528   0.002798   4.477 0.000188 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.288 on 22 degrees of freedom\nMultiple R-squared:  0.9811,\tAdjusted R-squared:  0.9794 \nF-statistic: 572.2 on 2 and 22 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n### Relationship between t-test and partial F-test\n\n-   A t-test for a single coefficient is a special case of the partial F-test; the relationship is $F = t^2$ for 1 df in the numerator.\n-   The p-value from t-test (output of *summary(lm())*) is the same as anova test for: $H_0: \\beta_j = 0$ vs $H_1$: all covaraites have non-zero effects.\n\n## Predictions for Mean Response and a Future Observation\n\n### Confidence Interval for Mean Response\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(fit, newdata = data.frame(length = 8, height = 275),\n        interval = \"confidence\", level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      fit      lwr      upr\n1 27.6631 26.66324 28.66296\n```\n\n\n:::\n:::\n\n\n\n\n### Prediction Interval for a New Observation\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(fit, newdata = data.frame(length = 8, height = 275),\n        interval = \"prediction\", level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      fit      lwr      upr\n1 27.6631 22.81378 32.51241\n```\n\n\n:::\n:::\n\n\n\n\n## Model Diagnostics\n\n### Residual Calculations\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresiduals_df <- data.frame(\n  hat_values = hatvalues(fit),\n  ordinary_resid = resid(fit),\n  standardized_resid = resid(fit) / sigma(fit),\n  studentized_internal = rstandard(fit),\n  studentized_external = rstudent(fit)\n)\nresiduals_df\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"hat_values\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ordinary_resid\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"standardized_resid\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"studentized_internal\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"studentized_external\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.15728923\",\"2\":\"1.57127871\",\"3\":\"0.68673363\",\"4\":\"0.74808172\",\"5\":\"0.74035927\",\"_rn_\":\"1\"},{\"1\":\"0.11164598\",\"2\":\"-1.14600783\",\"3\":\"-0.50086730\",\"4\":\"-0.53140990\",\"5\":\"-0.52255660\",\"_rn_\":\"2\"},{\"1\":\"0.14191905\",\"2\":\"-2.20409488\",\"3\":\"-0.96330846\",\"4\":\"-1.03992315\",\"5\":\"-1.04194550\",\"_rn_\":\"3\"},{\"1\":\"0.10188923\",\"2\":\"-1.59678413\",\"3\":\"-0.69788088\",\"4\":\"-0.73640435\",\"5\":\"-0.72850799\",\"_rn_\":\"4\"},{\"1\":\"0.04178381\",\"2\":\"-2.89365294\",\"3\":\"-1.26468257\",\"4\":\"-1.29196212\",\"5\":\"-1.31305171\",\"_rn_\":\"5\"},{\"1\":\"0.07486842\",\"2\":\"1.11356772\",\"3\":\"0.48668921\",\"4\":\"0.50599936\",\"5\":\"0.49726770\",\"_rn_\":\"6\"},{\"1\":\"0.11806106\",\"2\":\"1.92974001\",\"3\":\"0.84340057\",\"4\":\"0.89807919\",\"5\":\"0.89397096\",\"_rn_\":\"7\"},{\"1\":\"0.15608149\",\"2\":\"1.19622309\",\"3\":\"0.52281407\",\"4\":\"0.56911105\",\"5\":\"0.56016499\",\"_rn_\":\"8\"},{\"1\":\"0.12797685\",\"2\":\"-3.86499936\",\"3\":\"-1.68921340\",\"4\":\"-1.80892479\",\"5\":\"-1.91552083\",\"_rn_\":\"9\"},{\"1\":\"0.04131672\",\"2\":\"-0.47629200\",\"3\":\"-0.20816532\",\"4\":\"-0.21260369\",\"5\":\"-0.20792931\",\"_rn_\":\"10\"},{\"1\":\"0.09253979\",\"2\":\"-1.32232830\",\"3\":\"-0.57792886\",\"4\":\"-0.60668127\",\"5\":\"-0.59775404\",\"_rn_\":\"11\"},{\"1\":\"0.05256700\",\"2\":\"-0.46188206\",\"3\":\"-0.20186740\",\"4\":\"-0.20739197\",\"5\":\"-0.20282206\",\"_rn_\":\"12\"},{\"1\":\"0.08202675\",\"2\":\"0.49106715\",\"3\":\"0.21462286\",\"4\":\"0.22400668\",\"5\":\"0.21910643\",\"_rn_\":\"13\"},{\"1\":\"0.11291577\",\"2\":\"-0.60234282\",\"3\":\"-0.26325633\",\"4\":\"-0.27950939\",\"5\":\"-0.27356920\",\"_rn_\":\"14\"},{\"1\":\"0.07373697\",\"2\":\"5.84092866\",\"3\":\"2.55280118\",\"4\":\"2.65246601\",\"5\":\"3.14216850\",\"_rn_\":\"15\"},{\"1\":\"0.08794942\",\"2\":\"-0.36199456\",\"3\":\"-0.15821117\",\"4\":\"-0.16566382\",\"5\":\"-0.16195600\",\"_rn_\":\"16\"},{\"1\":\"0.25934228\",\"2\":\"4.33412887\",\"3\":\"1.89424832\",\"4\":\"2.20104100\",\"5\":\"2.43521394\",\"_rn_\":\"17\"},{\"1\":\"0.29287870\",\"2\":\"-2.03683074\",\"3\":\"-0.89020500\",\"4\":\"-1.05862725\",\"5\":\"-1.06168251\",\"_rn_\":\"18\"},{\"1\":\"0.09617553\",\"2\":\"-1.54150602\",\"3\":\"-0.67372136\",\"4\":\"-0.70866056\",\"5\":\"-0.70040768\",\"_rn_\":\"19\"},{\"1\":\"0.14726101\",\"2\":\"0.03021107\",\"3\":\"0.01320387\",\"4\":\"0.01429859\",\"5\":\"0.01396991\",\"_rn_\":\"20\"},{\"1\":\"0.12963943\",\"2\":\"-2.18090138\",\"3\":\"-0.95317165\",\"4\":\"-1.02169558\",\"5\":\"-1.02276424\",\"_rn_\":\"21\"},{\"1\":\"0.13580052\",\"2\":\"1.55871047\",\"3\":\"0.68124063\",\"4\":\"0.73281364\",\"5\":\"0.72486668\",\"_rn_\":\"22\"},{\"1\":\"0.18237610\",\"2\":\"0.32221591\",\"3\":\"0.14082575\",\"4\":\"0.15574183\",\"5\":\"0.15224503\",\"_rn_\":\"23\"},{\"1\":\"0.10908869\",\"2\":\"2.14780957\",\"3\":\"0.93870874\",\"4\":\"0.99452024\",\"5\":\"0.99426154\",\"_rn_\":\"24\"},{\"1\":\"0.07287021\",\"2\":\"0.15373580\",\"3\":\"0.06719084\",\"4\":\"0.06978142\",\"5\":\"0.06818458\",\"_rn_\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### Residual Plots\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- nrow(bond.data)\nr <- rstudent(fit) \ny.hat <- fitted.values(fit)\n\npar(mfrow = c(2, 3))\nqqnorm(r, main = \"Normal Q-Q Plot\"); qqline(r)\nplot(y.hat, r, xlab = \"Fitted values\", ylab = \"Studentized Residuals\"); abline(h = 0)\nplot(1:n, r, xlab = \"Observation Number\", ylab = \"Studentized Residuals\"); abline(h = 0)\nplot(bond.data$length, r, xlab = \"Wire Length\", ylab = \"Studentized Residuals\"); abline(h = 0)\nplot(bond.data$height, r, xlab = \"Die Height\", ylab = \"Studentized Residuals\"); abline(h = 0)\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-17-1.png){width=576}\n:::\n:::\n\n\n\n\n## Influential Observations\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninfluence_df <- data.frame(dffits = dffits(fit),\n                           cook.D = cooks.distance(fit),\n                           dfbetas(fit))\ninfluence_df\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"dffits\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cook.D\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X.Intercept.\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"length\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"height\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.319854702\",\"2\":\"3.481748e-02\",\"3\":\"0.3179493921\",\"4\":\"-0.100534181\",\"5\":\"-0.200085326\",\"_rn_\":\"1\"},{\"1\":\"-0.185251548\",\"2\":\"1.183028e-02\",\"3\":\"-0.1403477437\",\"4\":\"-0.051464370\",\"5\":\"0.148315370\",\"_rn_\":\"2\"},{\"1\":\"-0.423741713\",\"2\":\"5.962023e-02\",\"3\":\"-0.2219151046\",\"4\":\"-0.237135616\",\"5\":\"0.339340552\",\"_rn_\":\"3\"},{\"1\":\"-0.245376811\",\"2\":\"2.050736e-02\",\"3\":\"0.0787635526\",\"4\":\"0.022343842\",\"5\":\"-0.184260891\",\"_rn_\":\"4\"},{\"1\":\"-0.274191565\",\"2\":\"2.426179e-02\",\"3\":\"-0.1572410603\",\"4\":\"-0.009662357\",\"5\":\"0.055328303\",\"_rn_\":\"5\"},{\"1\":\"0.141461363\",\"2\":\"6.906752e-03\",\"3\":\"0.1301249135\",\"4\":\"-0.058073567\",\"5\":\"-0.049408295\",\"_rn_\":\"6\"},{\"1\":\"0.327082639\",\"2\":\"3.598953e-02\",\"3\":\"0.1479853099\",\"4\":\"-0.261848970\",\"5\":\"0.142220906\",\"_rn_\":\"7\"},{\"1\":\"0.240902557\",\"2\":\"1.996750e-02\",\"3\":\"0.2394962591\",\"4\":\"-0.076575387\",\"5\":\"-0.149787102\",\"_rn_\":\"8\"},{\"1\":\"-0.733818383\",\"2\":\"1.600749e-01\",\"3\":\"-0.5011686139\",\"4\":\"-0.283749099\",\"5\":\"0.605559181\",\"_rn_\":\"9\"},{\"1\":\"-0.043165927\",\"2\":\"6.493384e-04\",\"3\":\"-0.0241138520\",\"4\":\"-0.001038287\",\"5\":\"0.007460760\",\"_rn_\":\"10\"},{\"1\":\"-0.190885522\",\"2\":\"1.251125e-02\",\"3\":\"-0.0602003847\",\"4\":\"0.132053762\",\"5\":\"-0.102733745\",\"_rn_\":\"11\"},{\"1\":\"-0.047774650\",\"2\":\"7.954763e-04\",\"3\":\"0.0017554145\",\"4\":\"-0.016926531\",\"5\":\"-0.008495572\",\"_rn_\":\"12\"},{\"1\":\"0.065496465\",\"2\":\"1.494604e-03\",\"3\":\"-0.0224255162\",\"4\":\"0.017340091\",\"5\":\"0.033756253\",\"_rn_\":\"13\"},{\"1\":\"-0.097602753\",\"2\":\"3.314830e-03\",\"3\":\"-0.0483552961\",\"4\":\"0.077880727\",\"5\":\"-0.038066705\",\"_rn_\":\"14\"},{\"1\":\"0.886553487\",\"2\":\"1.866936e-01\",\"3\":\"0.8097463528\",\"4\":\"-0.374290156\",\"5\":\"-0.292048214\",\"_rn_\":\"15\"},{\"1\":\"-0.050292599\",\"2\":\"8.821617e-04\",\"3\":\"-0.0177647675\",\"4\":\"0.034746758\",\"5\":\"-0.025275682\",\"_rn_\":\"16\"},{\"1\":\"1.441003392\",\"2\":\"5.654455e-01\",\"3\":\"-0.8513738015\",\"4\":\"1.008880052\",\"5\":\"0.413618783\",\"_rn_\":\"17\"},{\"1\":\"-0.683268805\",\"2\":\"1.547244e-01\",\"3\":\"-0.0218935465\",\"4\":\"0.521608456\",\"5\":\"-0.532432956\",\"_rn_\":\"18\"},{\"1\":\"-0.228476293\",\"2\":\"1.781295e-02\",\"3\":\"0.0700729860\",\"4\":\"0.018004228\",\"5\":\"-0.167581999\",\"_rn_\":\"19\"},{\"1\":\"0.005805362\",\"2\":\"1.176892e-05\",\"3\":\"0.0005613509\",\"4\":\"0.004752581\",\"5\":\"-0.003094588\",\"_rn_\":\"20\"},{\"1\":\"-0.394724862\",\"2\":\"5.182743e-02\",\"3\":\"-0.0084618169\",\"4\":\"-0.324109965\",\"5\":\"0.170622396\",\"_rn_\":\"21\"},{\"1\":\"0.287343813\",\"2\":\"2.812893e-02\",\"3\":\"-0.1326208213\",\"4\":\"0.183002776\",\"5\":\"0.076391058\",\"_rn_\":\"22\"},{\"1\":\"0.071903545\",\"2\":\"1.803448e-03\",\"3\":\"-0.0412553376\",\"4\":\"0.040164093\",\"5\":\"0.030365108\",\"_rn_\":\"23\"},{\"1\":\"0.347915085\",\"2\":\"4.036930e-02\",\"3\":\"0.3084561584\",\"4\":\"0.016541769\",\"5\":\"-0.262089402\",\"_rn_\":\"24\"},{\"1\":\"0.019115733\",\"2\":\"1.275757e-04\",\"3\":\"0.0062730782\",\"4\":\"-0.011614674\",\"5\":\"0.009459029\",\"_rn_\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### Plotting with the `olsrr` Package\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## install.packages(\"olsrr\") # Run once if needed\nlibrary(olsrr)\n\nols_plot_cooksd_chart(fit)\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-19-1.png){width=576}\n:::\n\n```{.r .cell-code}\nols_plot_dffits(fit)\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-19-2.png){width=576}\n:::\n\n```{.r .cell-code}\nols_plot_dfbetas(fit)\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-19-3.png){width=576}\n:::\n:::\n\n\n\n\n## Polynomial Regression\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- c(1.81, 1.70, 1.65, 1.55, 1.48, 1.40, 1.30, 1.26, 1.24, 1.21, 1.20, 1.18)\nx <- c(20, 25, 30, 35, 40, 50, 60, 65, 70, 75, 80, 90)\nfit_poly <- lm(y ~ x + I(x^2))\nsummary(fit_poly)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x + I(x^2))\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-0.0174763 -0.0065087  0.0001297  0.0071482  0.0151887 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  2.198e+00  2.255e-02   97.48 6.38e-15 ***\nx           -2.252e-02  9.424e-04  -23.90 1.88e-09 ***\nI(x^2)       1.251e-04  8.658e-06   14.45 1.56e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01219 on 9 degrees of freedom\nMultiple R-squared:  0.9975,\tAdjusted R-squared:  0.9969 \nF-statistic:  1767 on 2 and 9 DF,  p-value: 2.096e-12\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(x, y, xlab = \"Lot size, x\", ylab = \"Average cost per unit, y\")\nlines(x, predict(fit_poly, newdata = data.frame(x = x)), type = \"l\")\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-21-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit1 <- lm(y ~ x)\nanova(fit1, fit_poly)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Res.Df\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RSS\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sum of Sq\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"F\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>F)\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"10\",\"2\":\"0.032339665\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"9\",\"2\":\"0.001337125\",\"3\":\"1\",\"4\":\"0.03100254\",\"5\":\"208.6737\",\"6\":\"1.563952e-07\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## Handling Categorical Variables with Dummy Variables\n\nInvestigate the common observation that males tend to have higher blood pressure than females of similar age.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Note: Update this path to your local file location\nsbpdata <- read.csv(\"sbpdata.csv\")\nsbpdata\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"sbp\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"age\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"144\",\"3\":\"39\"},{\"1\":\"0\",\"2\":\"138\",\"3\":\"45\"},{\"1\":\"0\",\"2\":\"145\",\"3\":\"47\"},{\"1\":\"0\",\"2\":\"162\",\"3\":\"65\"},{\"1\":\"0\",\"2\":\"142\",\"3\":\"46\"},{\"1\":\"0\",\"2\":\"170\",\"3\":\"67\"},{\"1\":\"0\",\"2\":\"124\",\"3\":\"42\"},{\"1\":\"0\",\"2\":\"158\",\"3\":\"67\"},{\"1\":\"0\",\"2\":\"154\",\"3\":\"56\"},{\"1\":\"0\",\"2\":\"162\",\"3\":\"64\"},{\"1\":\"0\",\"2\":\"150\",\"3\":\"56\"},{\"1\":\"0\",\"2\":\"140\",\"3\":\"59\"},{\"1\":\"0\",\"2\":\"110\",\"3\":\"34\"},{\"1\":\"0\",\"2\":\"128\",\"3\":\"42\"},{\"1\":\"0\",\"2\":\"130\",\"3\":\"48\"},{\"1\":\"0\",\"2\":\"135\",\"3\":\"45\"},{\"1\":\"0\",\"2\":\"114\",\"3\":\"17\"},{\"1\":\"0\",\"2\":\"116\",\"3\":\"20\"},{\"1\":\"0\",\"2\":\"124\",\"3\":\"19\"},{\"1\":\"0\",\"2\":\"136\",\"3\":\"36\"},{\"1\":\"0\",\"2\":\"142\",\"3\":\"50\"},{\"1\":\"0\",\"2\":\"120\",\"3\":\"39\"},{\"1\":\"0\",\"2\":\"120\",\"3\":\"21\"},{\"1\":\"0\",\"2\":\"160\",\"3\":\"44\"},{\"1\":\"0\",\"2\":\"158\",\"3\":\"53\"},{\"1\":\"0\",\"2\":\"144\",\"3\":\"63\"},{\"1\":\"0\",\"2\":\"130\",\"3\":\"29\"},{\"1\":\"0\",\"2\":\"125\",\"3\":\"25\"},{\"1\":\"0\",\"2\":\"175\",\"3\":\"69\"},{\"1\":\"1\",\"2\":\"158\",\"3\":\"41\"},{\"1\":\"1\",\"2\":\"185\",\"3\":\"60\"},{\"1\":\"1\",\"2\":\"152\",\"3\":\"41\"},{\"1\":\"1\",\"2\":\"159\",\"3\":\"47\"},{\"1\":\"1\",\"2\":\"176\",\"3\":\"66\"},{\"1\":\"1\",\"2\":\"156\",\"3\":\"47\"},{\"1\":\"1\",\"2\":\"184\",\"3\":\"68\"},{\"1\":\"1\",\"2\":\"138\",\"3\":\"43\"},{\"1\":\"1\",\"2\":\"172\",\"3\":\"68\"},{\"1\":\"1\",\"2\":\"168\",\"3\":\"57\"},{\"1\":\"1\",\"2\":\"176\",\"3\":\"65\"},{\"1\":\"1\",\"2\":\"164\",\"3\":\"57\"},{\"1\":\"1\",\"2\":\"154\",\"3\":\"61\"},{\"1\":\"1\",\"2\":\"124\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"142\",\"3\":\"44\"},{\"1\":\"1\",\"2\":\"144\",\"3\":\"50\"},{\"1\":\"1\",\"2\":\"149\",\"3\":\"47\"},{\"1\":\"1\",\"2\":\"128\",\"3\":\"19\"},{\"1\":\"1\",\"2\":\"130\",\"3\":\"22\"},{\"1\":\"1\",\"2\":\"138\",\"3\":\"21\"},{\"1\":\"1\",\"2\":\"150\",\"3\":\"38\"},{\"1\":\"1\",\"2\":\"156\",\"3\":\"52\"},{\"1\":\"1\",\"2\":\"134\",\"3\":\"41\"},{\"1\":\"1\",\"2\":\"134\",\"3\":\"18\"},{\"1\":\"1\",\"2\":\"174\",\"3\":\"51\"},{\"1\":\"1\",\"2\":\"174\",\"3\":\"55\"},{\"1\":\"1\",\"2\":\"158\",\"3\":\"65\"},{\"1\":\"1\",\"2\":\"144\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"139\",\"3\":\"23\"},{\"1\":\"1\",\"2\":\"180\",\"3\":\"70\"},{\"1\":\"1\",\"2\":\"165\",\"3\":\"56\"},{\"1\":\"1\",\"2\":\"172\",\"3\":\"62\"},{\"1\":\"1\",\"2\":\"160\",\"3\":\"51\"},{\"1\":\"1\",\"2\":\"157\",\"3\":\"48\"},{\"1\":\"1\",\"2\":\"170\",\"3\":\"59\"},{\"1\":\"1\",\"2\":\"153\",\"3\":\"40\"},{\"1\":\"1\",\"2\":\"148\",\"3\":\"35\"},{\"1\":\"1\",\"2\":\"140\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"132\",\"3\":\"26\"},{\"1\":\"1\",\"2\":\"169\",\"3\":\"61\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### Four Models Involving \"sex\"\n\n#### Coincidence Model (Age Only)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Ensure sex is a factor (labels will appear in the legend)\nsbpdata$sex <- as.factor(sbpdata$sex)\n\n## Fit (you already have this)\nfit.age <- lm(sbp ~ age, data = sbpdata)\n\n## Generate predictions over the observed age range\nnew_age <- seq(min(sbpdata$age, na.rm = TRUE),\n               max(sbpdata$age, na.rm = TRUE),\n               length.out = 200)\npred <- predict(fit.age, newdata = data.frame(age = new_age))\n\n## Simple palette for the sex levels (works for 1–3 levels; expand if needed)\nlev  <- levels(sbpdata$sex)\ncols <- setNames(c(\"steelblue3\", \"tomato3\", \"darkorchid3\")[seq_along(lev)], lev)\n\n## Scatter plot with colored points by sex\nplot(sbp ~ age, data = sbpdata,\n     col = cols[sbpdata$sex], pch = 16,\n     xlab = \"Age\", ylab = \"Systolic BP\")\n\n## Add predicted line\nlines(new_age, pred, lwd = 2)\n\n## Legend\nlegend(\"topleft\", legend = lev, col = cols[lev], pch = 16, bty = \"n\", title = \"Sex\")\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-24-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata.frame(model.matrix(fit.age)) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"X.Intercept.\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"age\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"39\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"45\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"47\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"65\",\"_rn_\":\"4\"},{\"1\":\"1\",\"2\":\"46\",\"_rn_\":\"5\"},{\"1\":\"1\",\"2\":\"67\",\"_rn_\":\"6\"},{\"1\":\"1\",\"2\":\"42\",\"_rn_\":\"7\"},{\"1\":\"1\",\"2\":\"67\",\"_rn_\":\"8\"},{\"1\":\"1\",\"2\":\"56\",\"_rn_\":\"9\"},{\"1\":\"1\",\"2\":\"64\",\"_rn_\":\"10\"},{\"1\":\"1\",\"2\":\"56\",\"_rn_\":\"11\"},{\"1\":\"1\",\"2\":\"59\",\"_rn_\":\"12\"},{\"1\":\"1\",\"2\":\"34\",\"_rn_\":\"13\"},{\"1\":\"1\",\"2\":\"42\",\"_rn_\":\"14\"},{\"1\":\"1\",\"2\":\"48\",\"_rn_\":\"15\"},{\"1\":\"1\",\"2\":\"45\",\"_rn_\":\"16\"},{\"1\":\"1\",\"2\":\"17\",\"_rn_\":\"17\"},{\"1\":\"1\",\"2\":\"20\",\"_rn_\":\"18\"},{\"1\":\"1\",\"2\":\"19\",\"_rn_\":\"19\"},{\"1\":\"1\",\"2\":\"36\",\"_rn_\":\"20\"},{\"1\":\"1\",\"2\":\"50\",\"_rn_\":\"21\"},{\"1\":\"1\",\"2\":\"39\",\"_rn_\":\"22\"},{\"1\":\"1\",\"2\":\"21\",\"_rn_\":\"23\"},{\"1\":\"1\",\"2\":\"44\",\"_rn_\":\"24\"},{\"1\":\"1\",\"2\":\"53\",\"_rn_\":\"25\"},{\"1\":\"1\",\"2\":\"63\",\"_rn_\":\"26\"},{\"1\":\"1\",\"2\":\"29\",\"_rn_\":\"27\"},{\"1\":\"1\",\"2\":\"25\",\"_rn_\":\"28\"},{\"1\":\"1\",\"2\":\"69\",\"_rn_\":\"29\"},{\"1\":\"1\",\"2\":\"41\",\"_rn_\":\"30\"},{\"1\":\"1\",\"2\":\"60\",\"_rn_\":\"31\"},{\"1\":\"1\",\"2\":\"41\",\"_rn_\":\"32\"},{\"1\":\"1\",\"2\":\"47\",\"_rn_\":\"33\"},{\"1\":\"1\",\"2\":\"66\",\"_rn_\":\"34\"},{\"1\":\"1\",\"2\":\"47\",\"_rn_\":\"35\"},{\"1\":\"1\",\"2\":\"68\",\"_rn_\":\"36\"},{\"1\":\"1\",\"2\":\"43\",\"_rn_\":\"37\"},{\"1\":\"1\",\"2\":\"68\",\"_rn_\":\"38\"},{\"1\":\"1\",\"2\":\"57\",\"_rn_\":\"39\"},{\"1\":\"1\",\"2\":\"65\",\"_rn_\":\"40\"},{\"1\":\"1\",\"2\":\"57\",\"_rn_\":\"41\"},{\"1\":\"1\",\"2\":\"61\",\"_rn_\":\"42\"},{\"1\":\"1\",\"2\":\"36\",\"_rn_\":\"43\"},{\"1\":\"1\",\"2\":\"44\",\"_rn_\":\"44\"},{\"1\":\"1\",\"2\":\"50\",\"_rn_\":\"45\"},{\"1\":\"1\",\"2\":\"47\",\"_rn_\":\"46\"},{\"1\":\"1\",\"2\":\"19\",\"_rn_\":\"47\"},{\"1\":\"1\",\"2\":\"22\",\"_rn_\":\"48\"},{\"1\":\"1\",\"2\":\"21\",\"_rn_\":\"49\"},{\"1\":\"1\",\"2\":\"38\",\"_rn_\":\"50\"},{\"1\":\"1\",\"2\":\"52\",\"_rn_\":\"51\"},{\"1\":\"1\",\"2\":\"41\",\"_rn_\":\"52\"},{\"1\":\"1\",\"2\":\"18\",\"_rn_\":\"53\"},{\"1\":\"1\",\"2\":\"51\",\"_rn_\":\"54\"},{\"1\":\"1\",\"2\":\"55\",\"_rn_\":\"55\"},{\"1\":\"1\",\"2\":\"65\",\"_rn_\":\"56\"},{\"1\":\"1\",\"2\":\"33\",\"_rn_\":\"57\"},{\"1\":\"1\",\"2\":\"23\",\"_rn_\":\"58\"},{\"1\":\"1\",\"2\":\"70\",\"_rn_\":\"59\"},{\"1\":\"1\",\"2\":\"56\",\"_rn_\":\"60\"},{\"1\":\"1\",\"2\":\"62\",\"_rn_\":\"61\"},{\"1\":\"1\",\"2\":\"51\",\"_rn_\":\"62\"},{\"1\":\"1\",\"2\":\"48\",\"_rn_\":\"63\"},{\"1\":\"1\",\"2\":\"59\",\"_rn_\":\"64\"},{\"1\":\"1\",\"2\":\"40\",\"_rn_\":\"65\"},{\"1\":\"1\",\"2\":\"35\",\"_rn_\":\"66\"},{\"1\":\"1\",\"2\":\"33\",\"_rn_\":\"67\"},{\"1\":\"1\",\"2\":\"26\",\"_rn_\":\"68\"},{\"1\":\"1\",\"2\":\"61\",\"_rn_\":\"69\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nprint(anova(fit.age))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: sbp\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nage        1 14951.3 14951.3  121.27 < 2.2e-16 ***\nResiduals 67  8260.5   123.3                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n#### Additive Effect Model (Age + Sex)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Parallelism: H0: beta3=0 (Sex has additive effect)\nfit.agePLUSsex <- lm(sbp ~ age + sex, data = sbpdata)\n\n## Ensure sex is a factor for labeling/colors\nsbpdata$sex <- factor(sbpdata$sex)\n\n## Fit (additive: parallelism)\nfit.agePLUSsex <- lm(sbp ~ age + sex, data = sbpdata)\n\n## X-range and palette\nages <- seq(min(sbpdata$age, na.rm = TRUE),\n            max(sbpdata$age, na.rm = TRUE),\n            length.out = 200)\nlev  <- levels(sbpdata$sex)\ncols <- setNames(c(\"steelblue3\", \"tomato3\", \"darkorchid3\")[seq_along(lev)], lev)\n\n## Scatter with colored points by sex\nplot(sbp ~ age, data = sbpdata,\n     col = cols[sbpdata$sex], pch = 16,\n     xlab = \"Age\", ylab = \"Systolic BP\")\n\n## Parallel fitted lines: one per sex (same slope, different intercepts)\nfor (sx in lev) {\n  nd <- data.frame(age = ages, sex = factor(sx, levels = lev))\n  yhat <- predict(fit.agePLUSsex, newdata = nd)\n  lines(ages, yhat, col = cols[sx], lwd = 2)\n}\n\n## Legend\nlegend(\"topleft\", legend = lev, col = cols[lev], pch = 16, lwd = 2, bty = \"n\", title = \"Sex\")\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-26-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata.frame(model.matrix(fit.agePLUSsex))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"X.Intercept.\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"age\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"39\",\"3\":\"0\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"45\",\"3\":\"0\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"0\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"65\",\"3\":\"0\",\"_rn_\":\"4\"},{\"1\":\"1\",\"2\":\"46\",\"3\":\"0\",\"_rn_\":\"5\"},{\"1\":\"1\",\"2\":\"67\",\"3\":\"0\",\"_rn_\":\"6\"},{\"1\":\"1\",\"2\":\"42\",\"3\":\"0\",\"_rn_\":\"7\"},{\"1\":\"1\",\"2\":\"67\",\"3\":\"0\",\"_rn_\":\"8\"},{\"1\":\"1\",\"2\":\"56\",\"3\":\"0\",\"_rn_\":\"9\"},{\"1\":\"1\",\"2\":\"64\",\"3\":\"0\",\"_rn_\":\"10\"},{\"1\":\"1\",\"2\":\"56\",\"3\":\"0\",\"_rn_\":\"11\"},{\"1\":\"1\",\"2\":\"59\",\"3\":\"0\",\"_rn_\":\"12\"},{\"1\":\"1\",\"2\":\"34\",\"3\":\"0\",\"_rn_\":\"13\"},{\"1\":\"1\",\"2\":\"42\",\"3\":\"0\",\"_rn_\":\"14\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"0\",\"_rn_\":\"15\"},{\"1\":\"1\",\"2\":\"45\",\"3\":\"0\",\"_rn_\":\"16\"},{\"1\":\"1\",\"2\":\"17\",\"3\":\"0\",\"_rn_\":\"17\"},{\"1\":\"1\",\"2\":\"20\",\"3\":\"0\",\"_rn_\":\"18\"},{\"1\":\"1\",\"2\":\"19\",\"3\":\"0\",\"_rn_\":\"19\"},{\"1\":\"1\",\"2\":\"36\",\"3\":\"0\",\"_rn_\":\"20\"},{\"1\":\"1\",\"2\":\"50\",\"3\":\"0\",\"_rn_\":\"21\"},{\"1\":\"1\",\"2\":\"39\",\"3\":\"0\",\"_rn_\":\"22\"},{\"1\":\"1\",\"2\":\"21\",\"3\":\"0\",\"_rn_\":\"23\"},{\"1\":\"1\",\"2\":\"44\",\"3\":\"0\",\"_rn_\":\"24\"},{\"1\":\"1\",\"2\":\"53\",\"3\":\"0\",\"_rn_\":\"25\"},{\"1\":\"1\",\"2\":\"63\",\"3\":\"0\",\"_rn_\":\"26\"},{\"1\":\"1\",\"2\":\"29\",\"3\":\"0\",\"_rn_\":\"27\"},{\"1\":\"1\",\"2\":\"25\",\"3\":\"0\",\"_rn_\":\"28\"},{\"1\":\"1\",\"2\":\"69\",\"3\":\"0\",\"_rn_\":\"29\"},{\"1\":\"1\",\"2\":\"41\",\"3\":\"1\",\"_rn_\":\"30\"},{\"1\":\"1\",\"2\":\"60\",\"3\":\"1\",\"_rn_\":\"31\"},{\"1\":\"1\",\"2\":\"41\",\"3\":\"1\",\"_rn_\":\"32\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"1\",\"_rn_\":\"33\"},{\"1\":\"1\",\"2\":\"66\",\"3\":\"1\",\"_rn_\":\"34\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"1\",\"_rn_\":\"35\"},{\"1\":\"1\",\"2\":\"68\",\"3\":\"1\",\"_rn_\":\"36\"},{\"1\":\"1\",\"2\":\"43\",\"3\":\"1\",\"_rn_\":\"37\"},{\"1\":\"1\",\"2\":\"68\",\"3\":\"1\",\"_rn_\":\"38\"},{\"1\":\"1\",\"2\":\"57\",\"3\":\"1\",\"_rn_\":\"39\"},{\"1\":\"1\",\"2\":\"65\",\"3\":\"1\",\"_rn_\":\"40\"},{\"1\":\"1\",\"2\":\"57\",\"3\":\"1\",\"_rn_\":\"41\"},{\"1\":\"1\",\"2\":\"61\",\"3\":\"1\",\"_rn_\":\"42\"},{\"1\":\"1\",\"2\":\"36\",\"3\":\"1\",\"_rn_\":\"43\"},{\"1\":\"1\",\"2\":\"44\",\"3\":\"1\",\"_rn_\":\"44\"},{\"1\":\"1\",\"2\":\"50\",\"3\":\"1\",\"_rn_\":\"45\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"1\",\"_rn_\":\"46\"},{\"1\":\"1\",\"2\":\"19\",\"3\":\"1\",\"_rn_\":\"47\"},{\"1\":\"1\",\"2\":\"22\",\"3\":\"1\",\"_rn_\":\"48\"},{\"1\":\"1\",\"2\":\"21\",\"3\":\"1\",\"_rn_\":\"49\"},{\"1\":\"1\",\"2\":\"38\",\"3\":\"1\",\"_rn_\":\"50\"},{\"1\":\"1\",\"2\":\"52\",\"3\":\"1\",\"_rn_\":\"51\"},{\"1\":\"1\",\"2\":\"41\",\"3\":\"1\",\"_rn_\":\"52\"},{\"1\":\"1\",\"2\":\"18\",\"3\":\"1\",\"_rn_\":\"53\"},{\"1\":\"1\",\"2\":\"51\",\"3\":\"1\",\"_rn_\":\"54\"},{\"1\":\"1\",\"2\":\"55\",\"3\":\"1\",\"_rn_\":\"55\"},{\"1\":\"1\",\"2\":\"65\",\"3\":\"1\",\"_rn_\":\"56\"},{\"1\":\"1\",\"2\":\"33\",\"3\":\"1\",\"_rn_\":\"57\"},{\"1\":\"1\",\"2\":\"23\",\"3\":\"1\",\"_rn_\":\"58\"},{\"1\":\"1\",\"2\":\"70\",\"3\":\"1\",\"_rn_\":\"59\"},{\"1\":\"1\",\"2\":\"56\",\"3\":\"1\",\"_rn_\":\"60\"},{\"1\":\"1\",\"2\":\"62\",\"3\":\"1\",\"_rn_\":\"61\"},{\"1\":\"1\",\"2\":\"51\",\"3\":\"1\",\"_rn_\":\"62\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"1\",\"_rn_\":\"63\"},{\"1\":\"1\",\"2\":\"59\",\"3\":\"1\",\"_rn_\":\"64\"},{\"1\":\"1\",\"2\":\"40\",\"3\":\"1\",\"_rn_\":\"65\"},{\"1\":\"1\",\"2\":\"35\",\"3\":\"1\",\"_rn_\":\"66\"},{\"1\":\"1\",\"2\":\"33\",\"3\":\"1\",\"_rn_\":\"67\"},{\"1\":\"1\",\"2\":\"26\",\"3\":\"1\",\"_rn_\":\"68\"},{\"1\":\"1\",\"2\":\"61\",\"3\":\"1\",\"_rn_\":\"69\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nprint(anova(fit.age, fit.agePLUSsex))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: sbp ~ age\nModel 2: sbp ~ age + sex\n  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    \n1     67 8260.5                                  \n2     66 5202.0  1    3058.5 38.805 3.701e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n#### Varying Intercept and Varying Slope Model (Age + Sex + Age:Sex)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Make sure sex is a factor (for colors/legend)\nsbpdata$sex <- factor(sbpdata$sex)\n\n## Fit (interaction: different slopes by sex)\nfit.age.TIMES.sex <- lm(sbp ~ age + sex + age:sex, data = sbpdata)\n\n## Age grid and palette\nages <- seq(min(sbpdata$age, na.rm = TRUE),\n            max(sbpdata$age, na.rm = TRUE),\n            length.out = 200)\nlev  <- levels(sbpdata$sex)\ncols <- setNames(c(\"steelblue3\", \"tomato3\", \"darkorchid3\")[seq_along(lev)], lev)\n\n## Scatter: color points by sex\nplot(sbp ~ age, data = sbpdata,\n     col = cols[sbpdata$sex], pch = 16,\n     xlab = \"Age\", ylab = \"Systolic BP\")\n\n## Fitted lines: one per sex (different slopes allowed)\nfor (sx in lev) {\n  nd <- data.frame(age = ages, sex = factor(sx, levels = lev))\n  yhat <- predict(fit.age.TIMES.sex, newdata = nd)\n  lines(ages, yhat, col = cols[sx], lwd = 2)\n}\n\n## Legend\nlegend(\"topleft\", legend = lev, col = cols[lev], pch = 16, lwd = 2, bty = \"n\", title = \"Sex\")\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-28-1.png){width=576}\n:::\n:::\n\n\n\n\n**Model Matrix and ANOVA**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata.frame(model.matrix(fit.age.TIMES.sex))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"X.Intercept.\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"age\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"age.sex1\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"39\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"45\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"65\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"4\"},{\"1\":\"1\",\"2\":\"46\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"5\"},{\"1\":\"1\",\"2\":\"67\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"6\"},{\"1\":\"1\",\"2\":\"42\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"7\"},{\"1\":\"1\",\"2\":\"67\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"8\"},{\"1\":\"1\",\"2\":\"56\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"9\"},{\"1\":\"1\",\"2\":\"64\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"10\"},{\"1\":\"1\",\"2\":\"56\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"11\"},{\"1\":\"1\",\"2\":\"59\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"12\"},{\"1\":\"1\",\"2\":\"34\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"13\"},{\"1\":\"1\",\"2\":\"42\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"14\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"15\"},{\"1\":\"1\",\"2\":\"45\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"16\"},{\"1\":\"1\",\"2\":\"17\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"17\"},{\"1\":\"1\",\"2\":\"20\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"18\"},{\"1\":\"1\",\"2\":\"19\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"19\"},{\"1\":\"1\",\"2\":\"36\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"20\"},{\"1\":\"1\",\"2\":\"50\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"21\"},{\"1\":\"1\",\"2\":\"39\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"22\"},{\"1\":\"1\",\"2\":\"21\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"23\"},{\"1\":\"1\",\"2\":\"44\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"24\"},{\"1\":\"1\",\"2\":\"53\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"25\"},{\"1\":\"1\",\"2\":\"63\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"26\"},{\"1\":\"1\",\"2\":\"29\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"27\"},{\"1\":\"1\",\"2\":\"25\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"28\"},{\"1\":\"1\",\"2\":\"69\",\"3\":\"0\",\"4\":\"0\",\"_rn_\":\"29\"},{\"1\":\"1\",\"2\":\"41\",\"3\":\"1\",\"4\":\"41\",\"_rn_\":\"30\"},{\"1\":\"1\",\"2\":\"60\",\"3\":\"1\",\"4\":\"60\",\"_rn_\":\"31\"},{\"1\":\"1\",\"2\":\"41\",\"3\":\"1\",\"4\":\"41\",\"_rn_\":\"32\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"1\",\"4\":\"47\",\"_rn_\":\"33\"},{\"1\":\"1\",\"2\":\"66\",\"3\":\"1\",\"4\":\"66\",\"_rn_\":\"34\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"1\",\"4\":\"47\",\"_rn_\":\"35\"},{\"1\":\"1\",\"2\":\"68\",\"3\":\"1\",\"4\":\"68\",\"_rn_\":\"36\"},{\"1\":\"1\",\"2\":\"43\",\"3\":\"1\",\"4\":\"43\",\"_rn_\":\"37\"},{\"1\":\"1\",\"2\":\"68\",\"3\":\"1\",\"4\":\"68\",\"_rn_\":\"38\"},{\"1\":\"1\",\"2\":\"57\",\"3\":\"1\",\"4\":\"57\",\"_rn_\":\"39\"},{\"1\":\"1\",\"2\":\"65\",\"3\":\"1\",\"4\":\"65\",\"_rn_\":\"40\"},{\"1\":\"1\",\"2\":\"57\",\"3\":\"1\",\"4\":\"57\",\"_rn_\":\"41\"},{\"1\":\"1\",\"2\":\"61\",\"3\":\"1\",\"4\":\"61\",\"_rn_\":\"42\"},{\"1\":\"1\",\"2\":\"36\",\"3\":\"1\",\"4\":\"36\",\"_rn_\":\"43\"},{\"1\":\"1\",\"2\":\"44\",\"3\":\"1\",\"4\":\"44\",\"_rn_\":\"44\"},{\"1\":\"1\",\"2\":\"50\",\"3\":\"1\",\"4\":\"50\",\"_rn_\":\"45\"},{\"1\":\"1\",\"2\":\"47\",\"3\":\"1\",\"4\":\"47\",\"_rn_\":\"46\"},{\"1\":\"1\",\"2\":\"19\",\"3\":\"1\",\"4\":\"19\",\"_rn_\":\"47\"},{\"1\":\"1\",\"2\":\"22\",\"3\":\"1\",\"4\":\"22\",\"_rn_\":\"48\"},{\"1\":\"1\",\"2\":\"21\",\"3\":\"1\",\"4\":\"21\",\"_rn_\":\"49\"},{\"1\":\"1\",\"2\":\"38\",\"3\":\"1\",\"4\":\"38\",\"_rn_\":\"50\"},{\"1\":\"1\",\"2\":\"52\",\"3\":\"1\",\"4\":\"52\",\"_rn_\":\"51\"},{\"1\":\"1\",\"2\":\"41\",\"3\":\"1\",\"4\":\"41\",\"_rn_\":\"52\"},{\"1\":\"1\",\"2\":\"18\",\"3\":\"1\",\"4\":\"18\",\"_rn_\":\"53\"},{\"1\":\"1\",\"2\":\"51\",\"3\":\"1\",\"4\":\"51\",\"_rn_\":\"54\"},{\"1\":\"1\",\"2\":\"55\",\"3\":\"1\",\"4\":\"55\",\"_rn_\":\"55\"},{\"1\":\"1\",\"2\":\"65\",\"3\":\"1\",\"4\":\"65\",\"_rn_\":\"56\"},{\"1\":\"1\",\"2\":\"33\",\"3\":\"1\",\"4\":\"33\",\"_rn_\":\"57\"},{\"1\":\"1\",\"2\":\"23\",\"3\":\"1\",\"4\":\"23\",\"_rn_\":\"58\"},{\"1\":\"1\",\"2\":\"70\",\"3\":\"1\",\"4\":\"70\",\"_rn_\":\"59\"},{\"1\":\"1\",\"2\":\"56\",\"3\":\"1\",\"4\":\"56\",\"_rn_\":\"60\"},{\"1\":\"1\",\"2\":\"62\",\"3\":\"1\",\"4\":\"62\",\"_rn_\":\"61\"},{\"1\":\"1\",\"2\":\"51\",\"3\":\"1\",\"4\":\"51\",\"_rn_\":\"62\"},{\"1\":\"1\",\"2\":\"48\",\"3\":\"1\",\"4\":\"48\",\"_rn_\":\"63\"},{\"1\":\"1\",\"2\":\"59\",\"3\":\"1\",\"4\":\"59\",\"_rn_\":\"64\"},{\"1\":\"1\",\"2\":\"40\",\"3\":\"1\",\"4\":\"40\",\"_rn_\":\"65\"},{\"1\":\"1\",\"2\":\"35\",\"3\":\"1\",\"4\":\"35\",\"_rn_\":\"66\"},{\"1\":\"1\",\"2\":\"33\",\"3\":\"1\",\"4\":\"33\",\"_rn_\":\"67\"},{\"1\":\"1\",\"2\":\"26\",\"3\":\"1\",\"4\":\"26\",\"_rn_\":\"68\"},{\"1\":\"1\",\"2\":\"61\",\"3\":\"1\",\"4\":\"61\",\"_rn_\":\"69\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsummary(fit.age.TIMES.sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sbp ~ age + sex + age:sex, data = sbpdata)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-20.647  -3.410   1.254   4.314  21.153 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 97.07708    5.17046  18.775  < 2e-16 ***\nage          0.94932    0.10864   8.738 1.43e-12 ***\nsex1        12.96144    7.01172   1.849   0.0691 .  \nage:sex1     0.01203    0.14519   0.083   0.9342    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.946 on 65 degrees of freedom\nMultiple R-squared:  0.7759,\tAdjusted R-squared:  0.7656 \nF-statistic: 75.02 on 3 and 65 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(anova(fit.age,fit.agePLUSsex,fit.age.TIMES.sex))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: sbp ~ age\nModel 2: sbp ~ age + sex\nModel 3: sbp ~ age + sex + age:sex\n  Res.Df    RSS Df Sum of Sq       F    Pr(>F)    \n1     67 8260.5                                   \n2     66 5202.0  1   3058.52 38.2210 4.692e-08 ***\n3     65 5201.4  1      0.55  0.0069    0.9342    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n#### Varying Slope, Equal Intercept Model (Age + Age:Sex)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Make sure sex is a factor (for colors/legend)\nsbpdata$sex <- factor(sbpdata$sex)\n\n## Fit (interaction: different slopes by sex)\nfit.equal.intercept <- lm(sbp ~ age + age:sex, data = sbpdata)\n\n\n## Age grid and palette\nages <- seq(min(sbpdata$age, na.rm = TRUE),\n            max(sbpdata$age, na.rm = TRUE),\n            length.out = 200)\nlev  <- levels(sbpdata$sex)\ncols <- setNames(c(\"steelblue3\", \"tomato3\", \"darkorchid3\")[seq_along(lev)], lev)\n\n## Scatter: color points by sex\nplot(sbp ~ age, data = sbpdata,\n     col = cols[sbpdata$sex], pch = 16,\n     xlab = \"Age\", ylab = \"Systolic BP\")\n\n## Fitted lines: one per sex (different slopes allowed)\nfor (sx in lev) {\n  nd <- data.frame(age = ages, sex = factor(sx, levels = lev))\n  yhat <- predict(fit.equal.intercept, newdata = nd)\n  lines(ages, yhat, col = cols[sx], lwd = 2)\n}\n\n## Legend\nlegend(\"topleft\", legend = lev, col = cols[lev], pch = 16, lwd = 2, bty = \"n\", title = \"Sex\")\n```\n\n::: {.cell-output-display}\n![](mlr_files/figure-html/unnamed-chunk-30-1.png){width=576}\n:::\n:::\n\n\n\n\n### Orders of Terms Matters in ANOVA and Warnings in Interpreting t-test Tables\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit.int <- lm(sbp ~ 1, data = sbpdata)\nfit.sex <- lm(sbp ~ sex, data = sbpdata)\n\nprint(anova(fit.int,fit.age,fit.agePLUSsex, fit.age.TIMES.sex))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: sbp ~ 1\nModel 2: sbp ~ age\nModel 3: sbp ~ age + sex\nModel 4: sbp ~ age + sex + age:sex\n  Res.Df     RSS Df Sum of Sq        F    Pr(>F)    \n1     68 23211.8                                    \n2     67  8260.5  1   14951.3 186.8390 < 2.2e-16 ***\n3     66  5202.0  1    3058.5  38.2210 4.692e-08 ***\n4     65  5201.4  1       0.5   0.0069    0.9342    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(anova(fit.int,fit.age,fit.equal.intercept, fit.age.TIMES.sex))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: sbp ~ 1\nModel 2: sbp ~ age\nModel 3: sbp ~ age + age:sex\nModel 4: sbp ~ age + sex + age:sex\n  Res.Df     RSS Df Sum of Sq        F    Pr(>F)    \n1     68 23211.8                                    \n2     67  8260.5  1   14951.3 186.8390 < 2.2e-16 ***\n3     66  5474.9  1    2785.6  34.8107 1.437e-07 ***\n4     65  5201.4  1     273.4   3.4171   0.06907 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(anova(fit.int,fit.sex,fit.agePLUSsex, fit.age.TIMES.sex))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: sbp ~ 1\nModel 2: sbp ~ sex\nModel 3: sbp ~ age + sex\nModel 4: sbp ~ age + sex + age:sex\n  Res.Df     RSS Df Sum of Sq        F    Pr(>F)    \n1     68 23211.8                                    \n2     67 19282.5  1    3929.2  49.1017 1.684e-09 ***\n3     66  5202.0  1   14080.6 175.9583 < 2.2e-16 ***\n4     65  5201.4  1       0.5   0.0069    0.9342    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(fit.age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sbp ~ age, data = sbpdata)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-26.782  -7.632   1.968   8.201  22.651 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 103.34905    4.33190   23.86   <2e-16 ***\nage           0.98333    0.08929   11.01   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.1 on 67 degrees of freedom\nMultiple R-squared:  0.6441,\tAdjusted R-squared:  0.6388 \nF-statistic: 121.3 on 1 and 67 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(fit.equal.intercept)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sbp ~ age + age:sex, data = sbpdata)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-21.6338  -4.3067   0.9922   4.9819  20.2753 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 104.12501    3.55578  29.283  < 2e-16 ***\nage           0.80908    0.07918  10.219 3.14e-15 ***\nage:sex1      0.26705    0.04608   5.795 2.09e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 9.108 on 66 degrees of freedom\nMultiple R-squared:  0.7641,\tAdjusted R-squared:  0.757 \nF-statistic: 106.9 on 2 and 66 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(fit.agePLUSsex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sbp ~ age + sex, data = sbpdata)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-20.705  -3.299   1.248   4.325  21.160 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 96.77353    3.62085  26.727  < 2e-16 ***\nage          0.95606    0.07153  13.366  < 2e-16 ***\nsex1        13.51345    2.16932   6.229  3.7e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.878 on 66 degrees of freedom\nMultiple R-squared:  0.7759,\tAdjusted R-squared:  0.7691 \nF-statistic: 114.2 on 2 and 66 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(fit.age.TIMES.sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = sbp ~ age + sex + age:sex, data = sbpdata)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-20.647  -3.410   1.254   4.314  21.153 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 97.07708    5.17046  18.775  < 2e-16 ***\nage          0.94932    0.10864   8.738 1.43e-12 ***\nsex1        12.96144    7.01172   1.849   0.0691 .  \nage:sex1     0.01203    0.14519   0.083   0.9342    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.946 on 65 degrees of freedom\nMultiple R-squared:  0.7759,\tAdjusted R-squared:  0.7656 \nF-statistic: 75.02 on 3 and 65 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n## Model Building\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(olsrr)\n## Note: Update this path to your local file location\nwine <- read.csv(\"wine.csv\")\n\nmodel.wine <- lm(quality ~ ., data = wine)\n```\n:::\n\n\n\n\n### All Possible Regression\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nols_step_best_subset(model.wine)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Best Subsets Regression             \n-------------------------------------------------\nModel Index    Predictors\n-------------------------------------------------\n     1         flavor                             \n     2         flavor oakiness                    \n     3         aroma flavor oakiness              \n     4         clarity aroma flavor oakiness      \n     5         clarity aroma body flavor oakiness \n-------------------------------------------------\n\n                                                  Subsets Regression Summary                                                   \n-------------------------------------------------------------------------------------------------------------------------------\n                       Adj.        Pred                                                                                         \nModel    R-Square    R-Square    R-Square     C(p)       AIC        SBIC        SBC        MSEP       FPE       HSP       APC  \n-------------------------------------------------------------------------------------------------------------------------------\n  1        0.6242      0.6137      0.5868    9.0436    130.0214    21.6859    134.9341    61.4102    1.7010    0.0462    0.4176 \n  2        0.6611      0.6417      0.6058    6.8132    128.0901    20.1242    134.6404    57.0033    1.6171    0.0441    0.3970 \n  3        0.7038      0.6776      0.6379    3.9278    124.9781    18.0702    133.1661    51.3383    1.4906    0.0409    0.3659 \n  4        0.7147      0.6801      0.6102    4.6747    125.5480    19.2854    135.3736    50.9872    1.5143    0.0418    0.3717 \n  5        0.7206      0.6769       0.587    6.0000    126.7552    21.0956    138.2183    51.5452    1.5649    0.0436    0.3842 \n-------------------------------------------------------------------------------------------------------------------------------\nAIC: Akaike Information Criteria \n SBIC: Sawa's Bayesian Information Criteria \n SBC: Schwarz Bayesian Criteria \n MSEP: Estimated error of prediction, assuming multivariate normality \n FPE: Final Prediction Error \n HSP: Hocking's Sp \n APC: Amemiya Prediction Criteria \n```\n\n\n:::\n:::\n\n\n\n\n### Automated Stepwise Procedures\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Backward Elimination (alpha_out = 0.1)\nols_step_backward_p(model.wine, p_val = 0.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                             Stepwise Summary                             \n------------------------------------------------------------------------\nStep    Variable        AIC        SBC       SBIC       R2       Adj. R2 \n------------------------------------------------------------------------\n 0      Full Model    126.755    138.218    21.096    0.72060    0.67694 \n 1      body          125.548    135.374    19.285    0.71471    0.68013 \n 2      clarity       124.978    133.166    18.070    0.70377    0.67763 \n------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                          \n---------------------------------------------------------------\nR                       0.839       RMSE                 1.098 \nR-Squared               0.704       MSE                  1.207 \nAdj. R-Squared          0.678       Coef. Var            9.338 \nPred R-Squared          0.638       AIC                124.978 \nMAE                     0.868       SBC                133.166 \n---------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                               ANOVA                                \n-------------------------------------------------------------------\n               Sum of                                              \n              Squares        DF    Mean Square      F         Sig. \n-------------------------------------------------------------------\nRegression    108.935         3         36.312    26.925    0.0000 \nResidual       45.853        34          1.349                     \nTotal         154.788        37                                    \n-------------------------------------------------------------------\n\n                                  Parameter Estimates                                    \n----------------------------------------------------------------------------------------\n      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper \n----------------------------------------------------------------------------------------\n(Intercept)     6.467         1.333                  4.852    0.000     3.759     9.176 \n      aroma     0.580         0.262        0.307     2.213    0.034     0.047     1.113 \n     flavor     1.200         0.275        0.603     4.364    0.000     0.641     1.758 \n   oakiness    -0.602         0.264       -0.217    -2.278    0.029    -1.140    -0.065 \n----------------------------------------------------------------------------------------\n```\n\n\n:::\n\n```{.r .cell-code}\n## Forward Selection (alpha_in = 0.1)\nols_step_forward_p(model.wine, p_val = 0.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                             Stepwise Summary                             \n------------------------------------------------------------------------\nStep    Variable        AIC        SBC       SBIC       R2       Adj. R2 \n------------------------------------------------------------------------\n 0      Base Model    165.209    168.484    55.141    0.00000    0.00000 \n 1      flavor        130.021    134.934    21.686    0.62417    0.61373 \n 2      oakiness      128.090    134.640    20.124    0.66111    0.64175 \n 3      aroma         124.978    133.166    18.070    0.70377    0.67763 \n------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                          \n---------------------------------------------------------------\nR                       0.839       RMSE                 1.098 \nR-Squared               0.704       MSE                  1.207 \nAdj. R-Squared          0.678       Coef. Var            9.338 \nPred R-Squared          0.638       AIC                124.978 \nMAE                     0.868       SBC                133.166 \n---------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                               ANOVA                                \n-------------------------------------------------------------------\n               Sum of                                              \n              Squares        DF    Mean Square      F         Sig. \n-------------------------------------------------------------------\nRegression    108.935         3         36.312    26.925    0.0000 \nResidual       45.853        34          1.349                     \nTotal         154.788        37                                    \n-------------------------------------------------------------------\n\n                                  Parameter Estimates                                    \n----------------------------------------------------------------------------------------\n      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper \n----------------------------------------------------------------------------------------\n(Intercept)     6.467         1.333                  4.852    0.000     3.759     9.176 \n     flavor     1.200         0.275        0.603     4.364    0.000     0.641     1.758 \n   oakiness    -0.602         0.264       -0.217    -2.278    0.029    -1.140    -0.065 \n      aroma     0.580         0.262        0.307     2.213    0.034     0.047     1.113 \n----------------------------------------------------------------------------------------\n```\n\n\n:::\n\n```{.r .cell-code}\n## Stepwise Regression (alpha_in = 0.1, alpha_out = 0.1)\nols_step_both_p(model.wine, p_enter = 0.1, p_remove = 0.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                              Stepwise Summary                              \n--------------------------------------------------------------------------\nStep    Variable          AIC        SBC       SBIC       R2       Adj. R2 \n--------------------------------------------------------------------------\n 0      Base Model      165.209    168.484    55.141    0.00000    0.00000 \n 1      flavor (+)      130.021    134.934    21.686    0.62417    0.61373 \n 2      oakiness (+)    128.090    134.640    20.124    0.66111    0.64175 \n 3      aroma (+)       124.978    133.166    18.070    0.70377    0.67763 \n--------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                          \n---------------------------------------------------------------\nR                       0.839       RMSE                 1.098 \nR-Squared               0.704       MSE                  1.207 \nAdj. R-Squared          0.678       Coef. Var            9.338 \nPred R-Squared          0.638       AIC                124.978 \nMAE                     0.868       SBC                133.166 \n---------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                               ANOVA                                \n-------------------------------------------------------------------\n               Sum of                                              \n              Squares        DF    Mean Square      F         Sig. \n-------------------------------------------------------------------\nRegression    108.935         3         36.312    26.925    0.0000 \nResidual       45.853        34          1.349                     \nTotal         154.788        37                                    \n-------------------------------------------------------------------\n\n                                  Parameter Estimates                                    \n----------------------------------------------------------------------------------------\n      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper \n----------------------------------------------------------------------------------------\n(Intercept)     6.467         1.333                  4.852    0.000     3.759     9.176 \n     flavor     1.200         0.275        0.603     4.364    0.000     0.641     1.758 \n   oakiness    -0.602         0.264       -0.217    -2.278    0.029    -1.140    -0.065 \n      aroma     0.580         0.262        0.307     2.213    0.034     0.047     1.113 \n----------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n## Multicollinearity\n\n### A Simple Example\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- c(19, 20, 37, 39, 36, 38)\nx1 <- c(4, 4, 7, 7, 7.1, 7.1)\nx2 <- c(16, 16, 49, 49, 50.4, 50.4)\ncor(data.frame(x1, x2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          x1        x2\nx1 1.0000000 0.9999713\nx2 0.9999713 1.0000000\n```\n\n\n:::\n\n```{.r .cell-code}\nfit_multi <- lm(y ~ x1 + x2)\nsummary(fit_multi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x1 + x2)\n\nResiduals:\n   1    2    3    4    5    6 \n-0.5  0.5 -1.0  1.0 -1.0  1.0 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept) -156.056    117.158  -1.332    0.275\nx1            65.444     45.890   1.426    0.249\nx2            -5.389      4.152  -1.298    0.285\n\nResidual standard error: 1.225 on 3 degrees of freedom\nMultiple R-squared:  0.9897,\tAdjusted R-squared:  0.9829 \nF-statistic: 144.3 on 2 and 3 DF,  p-value: 0.001043\n```\n\n\n:::\n\n```{.r .cell-code}\nfit1_multi <- lm(y ~ x1)\nsummary(fit1_multi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x1)\n\nResiduals:\n      1       2       3       4       5       6 \n-0.5260  0.4740 -0.1925  1.8075 -1.7814  0.2186 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -4.0293     2.3332  -1.727    0.159    \nx1            5.8888     0.3762  15.654 9.73e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.325 on 4 degrees of freedom\nMultiple R-squared:  0.9839,\tAdjusted R-squared:  0.9799 \nF-statistic: 245.1 on 1 and 4 DF,  p-value: 9.725e-05\n```\n\n\n:::\n\n```{.r .cell-code}\nols_vif_tol(fit_multi)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Variables\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Tolerance\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"VIF\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"x1\",\"2\":\"5.738191e-05\",\"3\":\"17427.09\"},{\"1\":\"x2\",\"2\":\"5.738191e-05\",\"3\":\"17427.09\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### VIFs in the Wine Quality Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwine.x <- wine[, -ncol(wine)] # Assuming quality is the last column\ncor(wine.x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             clarity     aroma       body      flavor  oakiness\nclarity   1.00000000 0.0619021 -0.3083783 -0.08515993 0.1832147\naroma     0.06190210 1.0000000  0.5489102  0.73656121 0.2016444\nbody     -0.30837826 0.5489102  1.0000000  0.64665917 0.1521059\nflavor   -0.08515993 0.7365612  0.6466592  1.00000000 0.1797605\noakiness  0.18321471 0.2016444  0.1521059  0.17976051 1.0000000\n```\n\n\n:::\n\n```{.r .cell-code}\n## VIF using olsrr (data frame output)\nols_vif_tol(model.wine)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Variables\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Tolerance\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"VIF\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"clarity\",\"2\":\"0.7896462\",\"3\":\"1.266390\"},{\"1\":\"aroma\",\"2\":\"0.4199665\",\"3\":\"2.381143\"},{\"1\":\"body\",\"2\":\"0.4862649\",\"3\":\"2.056492\"},{\"1\":\"flavor\",\"2\":\"0.3728175\",\"3\":\"2.682277\"},{\"1\":\"oakiness\",\"2\":\"0.9118005\",\"3\":\"1.096731\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n### VIFs in the Children Height Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Data: Weight, height and age of children\nwgt <- c(64, 71, 53, 67, 55, 58, 77, 57, 56, 51, 76, 68)\nhgt <- c(57, 59, 49, 62, 51, 50, 55, 48, 42, 42, 61, 57)\nage <- c(8, 10, 6, 11, 8, 7, 10, 9, 10, 6, 12, 9)\n\nfit_age_hgt <- lm(wgt ~ hgt + age, data = child.data)\nols_vif_tol(fit_age_hgt)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Variables\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Tolerance\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"VIF\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"hgt\",\"2\":\"0.6232021\",\"3\":\"1.604616\"},{\"1\":\"age\",\"2\":\"0.6232021\",\"3\":\"1.604616\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}