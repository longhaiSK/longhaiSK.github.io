<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Point Estimation in Multiple Linear Regression – Statistical Theory for Linear Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lec4-qf.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1b3e43c72e8be34557c75123b0b69e0d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d1855ce4d3ca2472244e2456266329f4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link rel="stylesheet" href="resources/mystyles.css">
<script src="resources/num_eq.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lec5-est.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point Estimation in Multiple Linear Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Theory for Linear Models</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec1-vecspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Projection in Vector Space</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec2-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spectral Theory and Generalized Inverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec3-mvn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multivariate Normal Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec4-qf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribution of Quadratic Forms</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lec5-est.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point Estimation in Multiple Linear Regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-models-and-least-square-estimator" id="toc-linear-models-and-least-square-estimator" class="nav-link active" data-scroll-target="#linear-models-and-least-square-estimator"><span class="header-section-number">5.1</span> Linear Models and Least Square Estimator</a>
  <ul>
  <li><a href="#assumptions-in-linear-models" id="toc-assumptions-in-linear-models" class="nav-link" data-scroll-target="#assumptions-in-linear-models"><span class="header-section-number">5.1.1</span> Assumptions in Linear Models</a></li>
  <li><a href="#matrix-formulation" id="toc-matrix-formulation" class="nav-link" data-scroll-target="#matrix-formulation"><span class="header-section-number">5.1.2</span> Matrix Formulation</a></li>
  <li><a href="#least-squares-estimator" id="toc-least-squares-estimator" class="nav-link" data-scroll-target="#least-squares-estimator"><span class="header-section-number">5.1.3</span> Least Squares Estimator</a></li>
  <li><a href="#estimation-example" id="toc-estimation-example" class="nav-link" data-scroll-target="#estimation-example"><span class="header-section-number">5.1.4</span> Estimation Example</a></li>
  <li><a href="#properties-of-the-estimator" id="toc-properties-of-the-estimator" class="nav-link" data-scroll-target="#properties-of-the-estimator"><span class="header-section-number">5.1.5</span> Properties of the Estimator</a></li>
  </ul></li>
  <li><a href="#best-linear-unbiased-estimator-blue" id="toc-best-linear-unbiased-estimator-blue" class="nav-link" data-scroll-target="#best-linear-unbiased-estimator-blue"><span class="header-section-number">5.2</span> Best Linear Unbiased Estimator (BLUE)</a>
  <ul>
  <li><a href="#notes-on-gauss-markov" id="toc-notes-on-gauss-markov" class="nav-link" data-scroll-target="#notes-on-gauss-markov"><span class="header-section-number">5.2.1</span> Notes on Gauss-Markov</a>
  <ul class="collapse">
  <li><a href="#limitations-restriction-to-unbiased-estimators" id="toc-limitations-restriction-to-unbiased-estimators" class="nav-link" data-scroll-target="#limitations-restriction-to-unbiased-estimators"><span class="header-section-number">5.2.1.1</span> Limitations: Restriction to Unbiased Estimators</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimator-of-error-variance" id="toc-estimator-of-error-variance" class="nav-link" data-scroll-target="#estimator-of-error-variance"><span class="header-section-number">5.3</span> Estimator of Error Variance</a>
  <ul>
  <li><a href="#unbiasedness-of-s2" id="toc-unbiasedness-of-s2" class="nav-link" data-scroll-target="#unbiasedness-of-s2"><span class="header-section-number">5.3.1</span> Unbiasedness of <span class="math inline">\(s^2\)</span></a></li>
  </ul></li>
  <li><a href="#distributions-under-normality" id="toc-distributions-under-normality" class="nav-link" data-scroll-target="#distributions-under-normality"><span class="header-section-number">5.4</span> Distributions under Normality</a></li>
  <li><a href="#maximum-likelihood-estimator-mle" id="toc-maximum-likelihood-estimator-mle" class="nav-link" data-scroll-target="#maximum-likelihood-estimator-mle"><span class="header-section-number">5.5</span> Maximum Likelihood Estimator (MLE)</a></li>
  <li><a href="#linear-models-in-centered-form" id="toc-linear-models-in-centered-form" class="nav-link" data-scroll-target="#linear-models-in-centered-form"><span class="header-section-number">5.6</span> Linear Models in Centered Form</a></li>
  <li><a href="#linear-models-in-centered-form-1" id="toc-linear-models-in-centered-form-1" class="nav-link" data-scroll-target="#linear-models-in-centered-form-1"><span class="header-section-number">5.7</span> Linear Models in Centered Form</a>
  <ul>
  <li><a href="#matrix-formulation-1" id="toc-matrix-formulation-1" class="nav-link" data-scroll-target="#matrix-formulation-1"><span class="header-section-number">5.7.1</span> Matrix Formulation</a></li>
  <li><a href="#estimation-in-centered-form" id="toc-estimation-in-centered-form" class="nav-link" data-scroll-target="#estimation-in-centered-form"><span class="header-section-number">5.7.2</span> Estimation in Centered Form</a></li>
  </ul></li>
  <li><a href="#sum-of-squares-decomposition" id="toc-sum-of-squares-decomposition" class="nav-link" data-scroll-target="#sum-of-squares-decomposition"><span class="header-section-number">5.8</span> Sum of Squares Decomposition</a>
  <ul>
  <li><a href="#geometric-decomposition-of-y" id="toc-geometric-decomposition-of-y" class="nav-link" data-scroll-target="#geometric-decomposition-of-y"><span class="header-section-number">5.8.1</span> Geometric Decomposition of <span class="math inline">\(y\)</span></a></li>
  </ul></li>
  <li><a href="#coefficient-of-determination-r2" id="toc-coefficient-of-determination-r2" class="nav-link" data-scroll-target="#coefficient-of-determination-r2"><span class="header-section-number">5.9</span> Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</a>
  <ul>
  <li><a href="#adjusted-r2-r2_a" id="toc-adjusted-r2-r2_a" class="nav-link" data-scroll-target="#adjusted-r2-r2_a"><span class="header-section-number">5.9.1</span> Adjusted <span class="math inline">\(R^2\)</span> (<span class="math inline">\(R^2_a\)</span>)</a></li>
  <li><a href="#expected-value-of-r2" id="toc-expected-value-of-r2" class="nav-link" data-scroll-target="#expected-value-of-r2"><span class="header-section-number">5.9.2</span> Expected Value of <span class="math inline">\(R^2\)</span></a></li>
  </ul></li>
  <li><a href="#underfitting-and-overfitting" id="toc-underfitting-and-overfitting" class="nav-link" data-scroll-target="#underfitting-and-overfitting"><span class="header-section-number">5.10</span> Underfitting and Overfitting</a>
  <ul>
  <li><a href="#underfitting" id="toc-underfitting" class="nav-link" data-scroll-target="#underfitting"><span class="header-section-number">5.10.1</span> Underfitting</a></li>
  <li><a href="#overfitting" id="toc-overfitting" class="nav-link" data-scroll-target="#overfitting"><span class="header-section-number">5.10.2</span> Overfitting</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.10.3</span> Summary</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point Estimation in Multiple Linear Regression</span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<section id="linear-models-and-least-square-estimator" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="linear-models-and-least-square-estimator"><span class="header-section-number">5.1</span> Linear Models and Least Square Estimator</h2>
<section id="assumptions-in-linear-models" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="assumptions-in-linear-models"><span class="header-section-number">5.1.1</span> Assumptions in Linear Models</h3>
<p>Suppose that on a random sample of <span class="math inline">\(n\)</span> units (patients, animals, trees, etc.) we observe a response variable <span class="math inline">\(Y\)</span> and explanatory variables <span class="math inline">\(X_{1},...,X_{k}\)</span>. Our data are then <span class="math inline">\((y_{i},x_{i1},...,x_{ik})\)</span>, <span class="math inline">\(i=1,...,n\)</span>, or in vector/matrix form <span class="math inline">\(y, x_{1},...,x_{k}\)</span> where <span class="math inline">\(y=(y_{1},...,y_{n})\)</span> and <span class="math inline">\(x_{j}=(x_{1j},...,x_{nj})^{T}\)</span> or <span class="math inline">\(y, X\)</span> where <span class="math inline">\(X=(x_{1},...,x_{k})\)</span>.</p>
<p>Either by design or by conditioning on their observed values, <span class="math inline">\(x_{1},...,x_{k}\)</span> are regarded as vectors of known constants. The linear model in its classical form makes the following assumptions:</p>
<div id="def-assumptions" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.1 (Assumptions A1-A5)</strong></span> <strong>A1. (Additive Error)</strong> <span class="math inline">\(y=\mu+e\)</span> where <span class="math inline">\(e=(e_{1},...,e_{n})^{T}\)</span> is an unobserved random vector with <span class="math inline">\(E(e)=0\)</span>. This implies that <span class="math inline">\(\mu=E(y)\)</span> is the unknown mean of <span class="math inline">\(y\)</span>.</p>
<p><strong>A2. (Linearity)</strong> <span class="math inline">\(\mu=\beta_{1}x_{1}+\cdot\cdot\cdot+\beta_{k}x_{k}=X\beta\)</span> where <span class="math inline">\(\beta_{1},...,\beta_{k}\)</span> are unknown parameters. This assumption says that <span class="math inline">\(E(y)=\mu\in\text{Col}(X)\)</span> (lies in the column space of <span class="math inline">\(X\)</span>); i.e., it is a linear combination of explanatory vectors <span class="math inline">\(x_{1},...,x_{k}\)</span> with coefficients the unknown parameters in <span class="math inline">\(\beta=(\beta_{1},...,\beta_{k})^{T}\)</span>. Note that it is linear in <span class="math inline">\(\beta_{1},...,\beta_{k}\)</span>, not necessarily in the <span class="math inline">\(x\)</span>’s.</p>
<p><strong>A3. (Independence)</strong> <span class="math inline">\(e_{1},...,e_{n}\)</span> are independent random variables (and therefore so are <span class="math inline">\(y_{1},...,y_{n})\)</span>.</p>
<p><strong>A4. (Homoscedasticity)</strong> <span class="math inline">\(e_{1},...,e_{n}\)</span> all have the same variance <span class="math inline">\(\sigma^{2}\)</span>; that is, <span class="math inline">\(\text{Var}(e_{1})=\cdot\cdot\cdot=\text{Var}(e_{n})=\sigma^{2}\)</span> which implies <span class="math inline">\(\text{Var}(y_{1})=\cdot\cdot\cdot=\text{Var}(y_{n})=\sigma^{2}\)</span>.</p>
<p><strong>A5. (Normality)</strong> <span class="math inline">\(e\sim N_{n}(0,\sigma^{2}I_{n})\)</span>.</p>
</div>
</section>
<section id="matrix-formulation" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="matrix-formulation"><span class="header-section-number">5.1.2</span> Matrix Formulation</h3>
<p>The model can be written algebraically as: <span class="math display">\[y_{i}=\beta_{0}+\beta_{1}x_{i1}+\beta_{2}x_{i2}+\cdot\cdot\cdot+\beta_{k}x_{ik}, \quad i=1,...,n\]</span></p>
<p>Or in matrix notation: <span class="math display">\[
\begin{pmatrix}
y_{1}\\
y_{2}\\
\vdots\\
y_{n}
\end{pmatrix}
=
\begin{pmatrix}
1 &amp; x_{11} &amp; x_{12} &amp; \cdot\cdot\cdot &amp; x_{1k}\\
1 &amp; x_{21} &amp; x_{22} &amp; \cdot\cdot\cdot &amp; x_{2k}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
1 &amp; x_{n1} &amp; x_{n2} &amp; \cdot\cdot\cdot &amp; x_{nk}
\end{pmatrix}
\begin{pmatrix}
\beta_{0}\\
\beta_{1}\\
\vdots\\
\beta_{k}
\end{pmatrix}
+
\begin{pmatrix}
e_{1}\\
e_{2}\\
\vdots\\
e_{n}
\end{pmatrix}
\]</span></p>
<p>This is expressed compactly as: <span class="math display">\[y=X\beta+e\]</span> where <span class="math inline">\(X\)</span> is the design matrix, and <span class="math inline">\(e \sim N_n(0, \sigma^2 I)\)</span>. Alternatively: <span class="math display">\[y=\beta_{0}j_{n}+\beta_{1}x_{1}+\cdot\cdot\cdot+\beta_{k}x_{k}+e\]</span></p>
<p>Taken together, all five assumptions can be stated more succinctly as: <span class="math display">\[y\sim N_{n}(X\beta,\sigma^{2}I)\]</span> with the mean vector <span class="math inline">\(\mu_{y}=X\beta\in \text{Col}(X)\)</span>.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A Note on Coefficients
</div>
</div>
<div class="callout-body-container callout-body">
<p>The effect of a parameter depends upon what other explanatory variables are present in the model. For example, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> in the model: <span class="math display">\[y=\beta_{0}j_{n}+\beta_{1}x_{1}+\beta_{2}x_{2}+e\]</span> will typically be different than <span class="math inline">\(\beta_{0}^{*}\)</span> and <span class="math inline">\(\beta_{1}^{*}\)</span> in the model: <span class="math display">\[y=\beta_{0}^{*}j_{n}+\beta_{1}^{*}x_{1}+e^{*}\]</span> In this context, <span class="math inline">\(\beta_0^*\)</span> and <span class="math inline">\(\beta_1^*\)</span> are the population-projected coefficients of the full model, that is, <span class="math inline">\(\beta_0^*\)</span> and <span class="math inline">\(\beta_1^*\)</span> are the parameters that can best approximate the full model.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will first consider the case that <span class="math inline">\(\text{rank}(X)=k+1\)</span>.</p>
</div>
</div>
</section>
<section id="least-squares-estimator" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="least-squares-estimator"><span class="header-section-number">5.1.3</span> Least Squares Estimator</h3>
<div id="def-least-squares" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.2 (Least Squares Estimator)</strong></span> The <strong>Least Squares Estimator (LSE)</strong> of <span class="math inline">\(\beta\)</span>, denoted as <span class="math inline">\(\hat{\beta}\)</span>, is the vector that minimizes the Sum of Squared Errors (SSE), which measures the discrepancy between the observed responses <span class="math inline">\(y\)</span> and the fitted values <span class="math inline">\(X\hat{\beta}\)</span>. <span class="math display">\[
Q(\beta) = \sum_{i=1}^n (y_i - x_i^T \beta)^2 = (y - X\beta)'(y - X\beta)
\]</span> Solving the normal equations <span class="math inline">\((X'X)\hat{\beta} = X'y\)</span> yields the closed-form solution (assuming <span class="math inline">\(X\)</span> has full rank): <span class="math display">\[
\hat{\beta} = (X'X)^{-1}X'y
\]</span></p>
</div>
</section>
<section id="estimation-example" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="estimation-example"><span class="header-section-number">5.1.4</span> Estimation Example</h3>
<div id="exm-7-3-1a" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.1 (Computation of <span class="math inline">\(\hat \beta\)</span>)</strong></span> We use the data in <span class="quarto-unresolved-ref">?tbl-7-1</span> to illustrate the computation of <span class="math inline">\(\hat{\beta}\)</span> using the normal equations.</p>
<p>Given the data matrices, we compute the cross-product matrices:</p>
<p><span class="math display">\[
X^{\prime}X = \begin{pmatrix}
12 &amp; 52 &amp; 102\\
52 &amp; 395 &amp; 536\\
102 &amp; 536 &amp; 1004
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
X^{\prime}y = \begin{pmatrix}
90\\
482\\
872
\end{pmatrix}
\]</span></p>
<p>The inverse of the cross-product matrix is: <span class="math display">\[
(X^{\prime}X)^{-1} = \begin{pmatrix}
.97476 &amp; .24290 &amp; -.22871\\
.24290 &amp; .16207 &amp; -.11120\\
-.22871 &amp; -.11120 &amp; .08360
\end{pmatrix}
\]</span></p>
<p>Solving for the estimator: <span class="math display">\[
\hat{\beta} = (X^{\prime}X)^{-1}X^{\prime}y = \begin{pmatrix}
5.3754\\
3.0118\\
-1.2855
\end{pmatrix}
\]</span></p>
</div>
</section>
<section id="properties-of-the-estimator" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="properties-of-the-estimator"><span class="header-section-number">5.1.5</span> Properties of the Estimator</h3>
<div id="thm-unbiased" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.1 (Unbiasedness of <span class="math inline">\(\hat \beta\)</span>)</strong></span> If <span class="math inline">\(E(y)=X\beta\)</span>, then <span class="math inline">\(\hat{\beta}\)</span> is an unbiased estimator for <span class="math inline">\(\beta\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
E(\hat{\beta}) &amp;= E[(X^{\prime}X)^{-1}X^{\prime}y] \\
&amp;= (X^{\prime}X)^{-1}X^{\prime}E(y) \quad \text{[using linearity of expectation]} \\
&amp;= (X^{\prime}X)^{-1}X^{\prime}X\beta \\
&amp;= \beta
\end{aligned}
\]</span></p>
</div>
<div id="thm-covariance" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.2 (Variance of <span class="math inline">\(\hat \beta\)</span>)</strong></span> If <span class="math inline">\(\text{Var}(y)=\sigma^{2}I\)</span>, the covariance matrix for <span class="math inline">\(\hat{\beta}\)</span> is given by <span class="math inline">\(\sigma^{2}(X^{\prime}X)^{-1}\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
\text{Var}(\hat{\beta}) &amp;= \text{Var}[(X^{\prime}X)^{-1}X^{\prime}y] \\
&amp;= (X^{\prime}X)^{-1}X^{\prime}\text{Var}(y)[(X^{\prime}X)^{-1}X^{\prime}]^{\prime} \quad \text{[using } \text{Var}(Ay) = A \text{Var}(y) A'] \\
&amp;= (X^{\prime}X)^{-1}X^{\prime}(\sigma^{2}I)X(X^{\prime}X)^{-1} \\
&amp;= \sigma^{2}(X^{\prime}X)^{-1}X^{\prime}X(X^{\prime}X)^{-1} \\
&amp;= \sigma^{2}(X^{\prime}X)^{-1}
\end{aligned}
\]</span></p>
</div>
<p><strong>Note:</strong> These theorems require no assumption of normality.</p>
</section>
</section>
<section id="best-linear-unbiased-estimator-blue" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="best-linear-unbiased-estimator-blue"><span class="header-section-number">5.2</span> Best Linear Unbiased Estimator (BLUE)</h2>
<div id="thm-gauss-markov" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.3 (Gauss-Markov Theorem)</strong></span> If <span class="math inline">\(E(y)=X\beta\)</span> and <span class="math inline">\(\text{Var}(y)=\sigma^{2}I\)</span>, the least-squares estimators <span class="math inline">\(\hat{\beta}_{j}, j=0,1,...,k\)</span> have minimum variance among all linear unbiased estimators.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We consider a linear estimator <span class="math inline">\(Ay\)</span> of <span class="math inline">\(\beta\)</span> and seek the matrix <span class="math inline">\(A\)</span> for which <span class="math inline">\(Ay\)</span> is a minimum variance unbiased estimator.</p>
<p><strong>1. Unbiasedness Condition:</strong> In order for <span class="math inline">\(Ay\)</span> to be an unbiased estimator of <span class="math inline">\(\beta\)</span>, we must have <span class="math inline">\(E(Ay)=\beta\)</span>. Using the assumption <span class="math inline">\(E(y)=X\beta\)</span>, this is expressed as: <span class="math display">\[E(Ay) = A E(y) = AX\beta = \beta\]</span> which implies the condition <span class="math inline">\(AX=I_{k+1}\)</span> since the relationship must hold for any <span class="math inline">\(\beta\)</span>.</p>
<p><strong>2. Minimizing Variance:</strong> The covariance matrix for the estimator <span class="math inline">\(Ay\)</span> is: <span class="math display">\[\text{Var}(Ay) = A \text{Var}(y) A' = A(\sigma^2 I) A' = \sigma^2 AA'\]</span> We need to choose <span class="math inline">\(A\)</span> (subject to <span class="math inline">\(AX=I\)</span>) so that the diagonal elements of <span class="math inline">\(AA'\)</span> are minimized.</p>
<p>To relate <span class="math inline">\(Ay\)</span> to <span class="math inline">\(\hat{\beta}=(X'X)^{-1}X'y\)</span>, we define <span class="math inline">\(\hat{A} = (X'X)^{-1}X'\)</span> and write <span class="math inline">\(A = (A - \hat{A}) + \hat{A}\)</span>. Then: <span class="math display">\[AA' = [(A - \hat{A}) + \hat{A}] [(A - \hat{A}) + \hat{A}]'\]</span> Expanding this, the cross terms vanish because <span class="math inline">\((A - \hat{A})\hat{A}' = A\hat{A}' - \hat{A}\hat{A}'\)</span>. Note that <span class="math inline">\(\hat{A}\hat{A}' = (X'X)^{-1}X'X(X'X)^{-1} = (X'X)^{-1}\)</span>. Also, <span class="math inline">\(A\hat{A}' = A X (X'X)^{-1} = I (X'X)^{-1} = (X'X)^{-1}\)</span> (since <span class="math inline">\(AX=I\)</span>). Thus, <span class="math inline">\((A - \hat{A})\hat{A}' = 0\)</span>.</p>
<p>The expansion simplifies to: <span class="math display">\[AA' = (A - \hat{A})(A - \hat{A})' + \hat{A}\hat{A}'\]</span> The matrix <span class="math inline">\((A - \hat{A})(A - \hat{A})'\)</span> is positive semidefinite, meaning its diagonal elements are non-negative. To minimize the diagonal of <span class="math inline">\(AA'\)</span>, we must set <span class="math inline">\(A - \hat{A} = 0\)</span>, which implies <span class="math inline">\(A = \hat{A}\)</span>.</p>
<p>Thus, the minimum variance estimator is: <span class="math display">\[Ay = (X'X)^{-1}X'y = \hat{\beta}\]</span></p>
</div>
<section id="notes-on-gauss-markov" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="notes-on-gauss-markov"><span class="header-section-number">5.2.1</span> Notes on Gauss-Markov</h3>
<ol type="1">
<li><p><strong>Distributional Generality:</strong> The remarkable feature of the Gauss-Markov theorem is that it holds for <em>any</em> distribution of <span class="math inline">\(y\)</span>; normality is not required. The only assumptions used are linearity (<span class="math inline">\(E(y)=X\beta\)</span>) and homoscedasticity (<span class="math inline">\(\text{Var}(y)=\sigma^2 I\)</span>).</p></li>
<li><p><strong>Extension to All Linear Combinations:</strong> The theorem extends beyond just the parameter vector <span class="math inline">\(\beta\)</span> to any linear combination of the parameters.</p></li>
</ol>
<div id="cor-linear-combo" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 5.1 (BLUE for All Linear Combinations)</strong></span> If <span class="math inline">\(E(y)=X\beta\)</span> and <span class="math inline">\(\text{Var}(y)=\sigma^{2}I\)</span>, the best linear unbiased estimator of the scalar <span class="math inline">\(a'\beta\)</span> is <span class="math inline">\(a'\hat{\beta}\)</span>, where <span class="math inline">\(\hat{\beta}\)</span> is the least-squares estimator.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(\tilde{\beta} = Ay\)</span> be any other linear unbiased estimator of <span class="math inline">\(\beta\)</span>. The variance of the linear combination <span class="math inline">\(a'\tilde{\beta}\)</span> is: <span class="math display">\[
\frac{1}{\sigma^2}\text{Var}(a'\tilde{\beta}) = \frac{1}{\sigma^2}\text{Var}(a'Ay) = a'AA'a
\]</span> From the proof of the Gauss-Markov theorem, we established that <span class="math inline">\(AA' = (A-\hat{A})(A-\hat{A})' + (X'X)^{-1}\)</span> where <span class="math inline">\(\hat{A} = (X'X)^{-1}X'\)</span>. Substituting this into the variance equation: <span class="math display">\[
a'AA'a = a'(A-\hat{A})(A-\hat{A})'a + a'(X'X)^{-1}a
\]</span> The term <span class="math inline">\(a'(A-\hat{A})(A-\hat{A})'a\)</span> is a quadratic form with a positive semidefinite matrix, so it is always non-negative. Therefore: <span class="math display">\[
a'AA'a \ge a'(X'X)^{-1}a = \frac{1}{\sigma^2}\text{Var}(a'\hat{\beta})
\]</span> The variance is minimized when <span class="math inline">\(A=\hat{A}\)</span> (specifically when the first term is zero), proving that <span class="math inline">\(a'\hat{\beta}\)</span> has the minimum variance among all linear unbiased estimators.</p>
</div>
<ol start="3" type="1">
<li><strong>Scaling Invariance:</strong> The predictions made by the model are invariant to the scaling of the explanatory variables.</li>
</ol>
<div id="thm-scaling" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.4 (Scaling Explanatory Variables)</strong></span> If <span class="math inline">\(x=(1,x_{1},...,x_{k})'\)</span> and <span class="math inline">\(z=(1,c_{1}x_{1},...,c_{k}x_{k})'\)</span>, then the fitted values are identical: <span class="math inline">\(\hat{y} = \hat{\beta}'x = \hat{\beta}_{z}'z\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(D = \text{diag}(1, c_1, ..., c_k)\)</span> such that the design matrix is transformed to <span class="math inline">\(Z = XD\)</span>. The LSE for the transformed data is: <span class="math display">\[
\begin{aligned}
\hat{\beta}_z &amp;= (Z'Z)^{-1}Z'y = [(XD)'(XD)]^{-1}(XD)'y \\
&amp;= D^{-1}(X'X)^{-1}(D')^{-1}D'X'y \\
&amp;= D^{-1}(X'X)^{-1}X'y = D^{-1}\hat{\beta}
\end{aligned}
\]</span> . Then, the prediction is: <span class="math display">\[
\hat{\beta}_z' z = (D^{-1}\hat{\beta})' (Dx) = \hat{\beta}' (D^{-1})' D x = \hat{\beta}'x
\]</span> .</p>
</div>
<section id="limitations-restriction-to-unbiased-estimators" class="level4" data-number="5.2.1.1">
<h4 data-number="5.2.1.1" class="anchored" data-anchor-id="limitations-restriction-to-unbiased-estimators"><span class="header-section-number">5.2.1.1</span> Limitations: Restriction to Unbiased Estimators</h4>
<p>It is crucial to recognize that the Gauss-Markov theorem only guarantees optimality within the class of <strong>linear</strong> and <strong>unbiased</strong> estimators.</p>
<ul>
<li><strong>Assumption Sensitivity:</strong> If the assumptions of linearity (<span class="math inline">\(E(y)=X\beta\)</span>) and homoscedasticity (<span class="math inline">\(\text{Var}(y)=\sigma^2 I\)</span>) do not hold, <span class="math inline">\(\hat{\beta}\)</span> may be biased or may have a larger variance than other estimators.</li>
<li><strong>Unbiasedness Constraint:</strong> The theorem does not compare <span class="math inline">\(\hat{\beta}\)</span> to biased estimators. It is possible for a biased estimator (e.g., shrinkage estimators) to have a smaller Mean Squared Error (MSE) than the BLUE by accepting some bias to significantly reduce variance. The LSE is only “best” (minimum variance) among those estimators that satisfy the unbiasedness constraint.</li>
</ul>
</section>
</section>
</section>
<section id="estimator-of-error-variance" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="estimator-of-error-variance"><span class="header-section-number">5.3</span> Estimator of Error Variance</h2>
<p>We estimate <span class="math inline">\(\sigma^{2}\)</span> by the residual mean square:</p>
<div id="def-s2" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.3 (Residual Variance Estimator)</strong></span> <span class="math display">\[s^{2} = \frac{1}{n-k-1} \sum_{i=1}^{n}(y_{i}-x_{i}'\hat{\beta})^{2} = \frac{\text{SSE}}{n-k-1}\]</span> where <span class="math inline">\(\text{SSE} = (y-X\hat{\beta})'(y-X\hat{\beta})\)</span>.</p>
</div>
<p>Alternatively, SSE can be written as: <span class="math display">\[\text{SSE} = y'y - \hat{\beta}'X'y\]</span> This is often useful for computation (<span class="math inline">\(y'y\)</span> is the total sum of squares of the raw data).</p>
<section id="unbiasedness-of-s2" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="unbiasedness-of-s2"><span class="header-section-number">5.3.1</span> Unbiasedness of <span class="math inline">\(s^2\)</span></h3>
<div id="thm-unbiased-s2" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.5 (Unbiasedness of s-squared)</strong></span> If <span class="math inline">\(s^{2}\)</span> is defined as above, and if <span class="math inline">\(E(y)=X\beta\)</span> and <span class="math inline">\(\text{Var}(y)=\sigma^{2}I\)</span>, then <span class="math inline">\(E(s^{2})=\sigma^{2}\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We use the Hat Matrix <span class="math inline">\(H = X(X'X)^{-1}X'\)</span>, which projects <span class="math inline">\(y\)</span> onto <span class="math inline">\(\text{Col}(X)\)</span>. Thus, <span class="math inline">\(\hat{y} = Hy\)</span>. The residuals are <span class="math inline">\(y - \hat{y} = (I - H)y\)</span>. The Sum of Squared Errors is: <span class="math display">\[\text{SSE} = \|(I-H)y\|^2 = y'(I-H)'(I-H)y\]</span> Since <span class="math inline">\(H\)</span> is symmetric and idempotent, <span class="math inline">\((I-H)\)</span> is also symmetric and idempotent. Thus: <span class="math display">\[\text{SSE} = y'(I-H)y\]</span></p>
<p>To find the expectation, we use the trace trick for quadratic forms: <span class="math inline">\(E[y'Ay] = \text{tr}(A\text{Var}(y)) + E[y]'A E[y]\)</span>. <span class="math display">\[
\begin{aligned}
E(\text{SSE}) &amp;= E[y'(I-H)y] \\
&amp;= \text{tr}((I-H)\sigma^2 I) + (X\beta)'(I-H)(X\beta) \\
&amp;= \sigma^2 \text{tr}(I-H) + \beta'X'(I-H)X\beta
\end{aligned}
\]</span> <strong>Trace Term:</strong> <span class="math inline">\(\text{tr}(I_n - H) = \text{tr}(I_n) - \text{tr}(H) = n - (k+1)\)</span>, since <span class="math inline">\(\text{tr}(H) = \text{tr}(X(X'X)^{-1}X') = \text{tr}((X'X)^{-1}X'X) = \text{tr}(I_{k+1}) = k+1\)</span>.</p>
<p><strong>Non-centrality Term:</strong> Since <span class="math inline">\(HX = X\)</span>, we have <span class="math inline">\((I-H)X = 0\)</span>. Therefore, the second term vanishes: <span class="math inline">\(\beta'X'(I-H)X\beta = 0\)</span>.</p>
<p>Combining these: <span class="math display">\[E(\text{SSE}) = \sigma^2(n - k - 1)\]</span> Dividing by the degrees of freedom <span class="math inline">\((n-k-1)\)</span>, we get <span class="math inline">\(E(s^2) = \sigma^2\)</span>.</p>
</div>
</section>
</section>
<section id="distributions-under-normality" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="distributions-under-normality"><span class="header-section-number">5.4</span> Distributions under Normality</h2>
<p>If we add Assumption A5 (<span class="math inline">\(y \sim N_n(X\beta, \sigma^2 I)\)</span>), we can derive the exact sampling distributions.</p>
<div id="cor-cov-beta" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 5.2 (Estimated Covariance of Beta)</strong></span> An unbiased estimator of <span class="math inline">\(\text{Cov}(\hat{\beta})\)</span> is given by: <span class="math display">\[\widehat{\text{Cov}}(\hat{\beta}) = s^{2}(X'X)^{-1}\]</span></p>
</div>
<div id="thm-sampling-dist" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.6 (Sampling Distributions)</strong></span> Under assumptions A1-A5:</p>
<ol type="1">
<li><span class="math inline">\(\hat{\beta} \sim N_{k+1}(\beta, \sigma^{2}(X'X)^{-1})\)</span>.</li>
<li><span class="math inline">\((n-k-1)s^{2}/\sigma^{2} \sim \chi^{2}(n-k-1)\)</span>.</li>
<li><span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(s^{2}\)</span> are independent.</li>
</ol>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><strong>Part (i):</strong> Since <span class="math inline">\(\hat{\beta} = (X'X)^{-1}X'y\)</span> is a linear transformation of the normal vector <span class="math inline">\(y\)</span>, it is also normally distributed. We already established its mean and variance in <a href="#thm-unbiased" class="quarto-xref">Theorem&nbsp;<span>5.1</span></a> and <a href="#thm-covariance" class="quarto-xref">Theorem&nbsp;<span>5.2</span></a>.</p>
<p><strong>Part (ii):</strong> We showed <span class="math inline">\(\text{SSE} = y'(I-H)y\)</span>. Since <span class="math inline">\((I-H)\)</span> is idempotent with rank <span class="math inline">\(n-k-1\)</span>, and <span class="math inline">\((I-H)X\beta = 0\)</span>, by the theory of quadratic forms in normal variables, <span class="math inline">\(\text{SSE}/\sigma^2 \sim \chi^2(n-k-1)\)</span>.</p>
<p><strong>Part (iii):</strong> <span class="math inline">\(\hat{\beta}\)</span> depends on <span class="math inline">\(Hy\)</span> (or <span class="math inline">\(X'y\)</span>), while <span class="math inline">\(s^2\)</span> depends on <span class="math inline">\((I-H)y\)</span>. Since <span class="math inline">\(H(I-H) = H - H^2 = 0\)</span>, the linear forms defining the estimator and the residuals are orthogonal. For normal vectors, zero covariance implies independence.</p>
</div>
</section>
<section id="maximum-likelihood-estimator-mle" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="maximum-likelihood-estimator-mle"><span class="header-section-number">5.5</span> Maximum Likelihood Estimator (MLE)</h2>
<div id="thm-mle" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.7 (MLE for Linear Regression)</strong></span> If <span class="math inline">\(y \sim N_n(X\beta, \sigma^2 I)\)</span>, the Maximum Likelihood Estimators are: <span class="math display">\[
\hat{\beta}_{\text{MLE}} = (X'X)^{-1}X'y
\]</span> <span class="math display">\[
\hat{\sigma}^2_{\text{MLE}} = \frac{1}{n}(y - X\hat{\beta})'(y - X\hat{\beta}) = \frac{\text{SSE}}{n}
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>The log-likelihood function is: <span class="math display">\[ \ln L(\beta, \sigma^2) = -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\sigma^2) - \frac{1}{2\sigma^2}(y - X\beta)'(y - X\beta) \]</span> Maximizing this with respect to <span class="math inline">\(\beta\)</span> is equivalent to minimizing the quadratic term <span class="math inline">\((y - X\beta)'(y - X\beta)\)</span>, which yields the Least Squares Estimator. Differentiating with respect to <span class="math inline">\(\sigma^2\)</span> and setting to zero yields <span class="math inline">\(\hat{\sigma}^2 = \text{SSE}/n\)</span>.</p>
</div>
<p><strong>Note:</strong> The MLE for <span class="math inline">\(\sigma^2\)</span> is biased (denominator <span class="math inline">\(n\)</span>), whereas <span class="math inline">\(s^2\)</span> is unbiased (denominator <span class="math inline">\(n-k-1\)</span>).</p>
</section>
<section id="linear-models-in-centered-form" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="linear-models-in-centered-form"><span class="header-section-number">5.6</span> Linear Models in Centered Form</h2>
<p>The regression model can be written in a centered form by subtracting the means of the explanatory variables: <span class="math display">\[y_{i}=\alpha+\beta_{1}(x_{i1}-\overline{x}_{1})+\beta_{2}(x_{i2}-\overline{x}_{2})+\cdot\cdot\cdot+\beta_{k}(x_{ik}-\overline{x}_{k})+e_{i}\]</span> for <span class="math inline">\(i=1,...,n\)</span>, where the intercept term is adjusted: <span class="math display">\[\alpha=\beta_{0}+\beta_{1}\overline{x}_{1}+\beta_{2}\overline{x}_{2}+\cdot\cdot\cdot+\beta_{k}\overline{x}_{k}\]</span> and <span class="math inline">\(\overline{x}_{j}=\frac{1}{n}\sum_{i=1}^{n}x_{ij}\)</span>.</p>
</section>
<section id="linear-models-in-centered-form-1" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="linear-models-in-centered-form-1"><span class="header-section-number">5.7</span> Linear Models in Centered Form</h2>
<p>The regression model can be written in a centered form by subtracting the means of the explanatory variables: <span class="math display">\[y_{i}=\alpha+\beta_{1}(x_{i1}-\overline{x}_{1})+\beta_{2}(x_{i2}-\overline{x}_{2})+\cdot\cdot\cdot+\beta_{k}(x_{ik}-\overline{x}_{k})+e_{i}\]</span> for <span class="math inline">\(i=1,...,n\)</span>, where the intercept term is adjusted: <span class="math display">\[\alpha=\beta_{0}+\beta_{1}\overline{x}_{1}+\beta_{2}\overline{x}_{2}+\cdot\cdot\cdot+\beta_{k}\overline{x}_{k}\]</span> and <span class="math inline">\(\overline{x}_{j}=\frac{1}{n}\sum_{i=1}^{n}x_{ij}\)</span>.</p>
<section id="matrix-formulation-1" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="matrix-formulation-1"><span class="header-section-number">5.7.1</span> Matrix Formulation</h3>
<p>In matrix form, the equivalence between the original model and the centered model is: <span class="math display">\[y = X\beta + e = (j_n, X_c)\begin{pmatrix} \alpha \\ \beta_{1} \end{pmatrix} + e\]</span> where <span class="math inline">\(\beta_{1}=(\beta_{1},...,\beta_{k})^{T}\)</span> represents the slope coefficients, and <span class="math inline">\(X_c\)</span> is the centered design matrix: <span class="math display">\[X_c = (I - P_{j_n})X_1\]</span> Here, <span class="math inline">\(X_1\)</span> consists of the original columns of <span class="math inline">\(X\)</span> excluding the intercept column.</p>
<p>To see the structure of <span class="math inline">\(X_c\)</span>, we first calculate the projection of the data onto the intercept space, <span class="math inline">\(P_{j_n}X_1\)</span>: <span class="math display">\[
\begin{aligned}
P_{j_n}X_1 &amp;= \frac{1}{n}j_n j_n' X_1 \\
&amp;= \begin{pmatrix} 1/n &amp; 1/n &amp; \cdots &amp; 1/n \\ 1/n &amp; 1/n &amp; \cdots &amp; 1/n \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1/n &amp; 1/n &amp; \cdots &amp; 1/n \end{pmatrix} \begin{pmatrix} x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1k} \\ x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2k} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nk} \end{pmatrix} \\
&amp;= \begin{pmatrix} \bar{x}_1 &amp; \bar{x}_2 &amp; \cdots &amp; \bar{x}_k \\ \bar{x}_1 &amp; \bar{x}_2 &amp; \cdots &amp; \bar{x}_k \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \bar{x}_1 &amp; \bar{x}_2 &amp; \cdots &amp; \bar{x}_k \end{pmatrix}
\end{aligned}
\]</span> This results in a matrix where every row is the vector of column means. Subtracting this from <span class="math inline">\(X_1\)</span> gives <span class="math inline">\(X_c\)</span>: <span class="math display">\[
\begin{aligned}
X_c &amp;= X_1 - P_{j_n}X_1 \\
&amp;= \begin{pmatrix} x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1k} \\ x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2k} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nk} \end{pmatrix} - \begin{pmatrix} \bar{x}_1 &amp; \bar{x}_2 &amp; \cdots &amp; \bar{x}_k \\ \bar{x}_1 &amp; \bar{x}_2 &amp; \cdots &amp; \bar{x}_k \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \bar{x}_1 &amp; \bar{x}_2 &amp; \cdots &amp; \bar{x}_k \end{pmatrix} \\
&amp;= \begin{pmatrix} x_{11} - \bar{x}_1 &amp; x_{12} - \bar{x}_2 &amp; \cdots &amp; x_{1k} - \bar{x}_k \\ x_{21} - \bar{x}_1 &amp; x_{22} - \bar{x}_2 &amp; \cdots &amp; x_{2k} - \bar{x}_k \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ x_{n1} - \bar{x}_1 &amp; x_{n2} - \bar{x}_2 &amp; \cdots &amp; x_{nk} - \bar{x}_k \end{pmatrix}
\end{aligned}
\]</span></p>
</section>
<section id="estimation-in-centered-form" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="estimation-in-centered-form"><span class="header-section-number">5.7.2</span> Estimation in Centered Form</h3>
<p>Because the column space of the intercept <span class="math inline">\(j_n\)</span> is orthogonal to the columns of <span class="math inline">\(X_c\)</span> (since columns of <span class="math inline">\(X_c\)</span> sum to zero), the cross-product matrix becomes block diagonal: <span class="math display">\[
\begin{pmatrix} j_n' \\ X_c' \end{pmatrix} (j_n, X_c) = \begin{pmatrix} j_n'j_n &amp; j_n'X_c \\ X_c'j_n &amp; X_c'X_c \end{pmatrix} = \begin{pmatrix} n &amp; 0 \\ 0 &amp; X_c'X_c \end{pmatrix}
\]</span></p>
<div id="thm-centered-estimators" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.8 (Centered Estimators)</strong></span> The least squares estimators for the centered parameters are: <span class="math display">\[
\begin{pmatrix} \hat{\alpha} \\ \hat{\beta}_{1} \end{pmatrix} = \begin{pmatrix} n &amp; 0 \\ 0 &amp; X_c'X_c \end{pmatrix}^{-1} \begin{pmatrix} j_n'y \\ X_c'y \end{pmatrix} = \begin{pmatrix} \bar{y} \\ (X_c'X_c)^{-1}X_c'y \end{pmatrix}
\]</span> Thus:</p>
<ol type="1">
<li><span class="math inline">\(\hat{\alpha} = \bar{y}\)</span> (The sample mean of <span class="math inline">\(y\)</span>).</li>
<li><span class="math inline">\(\hat{\beta}_{1} = S_{xx}^{-1}S_{xy}\)</span>, using the sample covariance notations.</li>
</ol>
</div>
<p>Recovering the original intercept: <span class="math display">\[ \hat{\beta}_0 = \hat{\alpha} - \hat{\beta}_1 \bar{x}_1 - \dots - \hat{\beta}_k \bar{x}_k = \bar{y} - \hat{\beta}_{1}'\bar{x} \]</span></p>
</section>
</section>
<section id="sum-of-squares-decomposition" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="sum-of-squares-decomposition"><span class="header-section-number">5.8</span> Sum of Squares Decomposition</h2>
<p>We partition the total variation based on the orthogonal subspaces.</p>
<div id="def-ss-components" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.4 (Sum of Squares Components)</strong></span> The total variation is decomposed as <span class="math inline">\(\text{SST} = \text{SSR} + \text{SSE}\)</span>.</p>
<ol type="1">
<li><p><strong>Total Sum of Squares (SST):</strong> The squared length of the centered response vector. <span class="math display">\[\text{SST} = \|y - \bar{y}j_n\|^2 = \|(I - P_{j_n})y\|^2\]</span></p></li>
<li><p><strong>Regression Sum of Squares (SSR):</strong> The variation explained by the regressors <span class="math inline">\(X_c\)</span>. <span class="math display">\[\text{SSR} = \|\hat{y} - \bar{y}j_n\|^2 = \|P_{X_c}y\|^2 = \hat{\beta}_1' X_c' X_c \hat{\beta}_1\]</span></p></li>
<li><p><strong>Sum of Squared Errors (SSE):</strong> The residual variation. <span class="math display">\[\text{SSE} = \|y - \hat{y}\|^2 = \|(I - P_{X})y\|^2\]</span></p></li>
</ol>
</div>
<section id="geometric-decomposition-of-y" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="geometric-decomposition-of-y"><span class="header-section-number">5.8.1</span> Geometric Decomposition of <span class="math inline">\(y\)</span></h3>
<p>We partition the total variation in <span class="math inline">\(y\)</span> based on the orthogonal subspaces.</p>
<ol type="1">
<li><strong>Space of the Mean:</strong> <span class="math inline">\(L(j_n)\)</span>, spanned by the intercept vector <span class="math inline">\(j_n\)</span>.</li>
<li><strong>Space of the Regressors:</strong> <span class="math inline">\(L(X_c)\)</span>, spanned by the centered predictors <span class="math inline">\(X_c\)</span>.</li>
<li><strong>Error Space:</strong> <span class="math inline">\(\text{Col}(X)^\perp\)</span>, orthogonal to the model space.</li>
</ol>
<p>The vector <span class="math inline">\(y\)</span> can be decomposed into three orthogonal components: <span class="math display">\[y = \bar{y}j_n + P_{X_c}y + (y - \hat{y})\]</span> Visually, this corresponds to projecting the vector <span class="math inline">\(y\)</span> onto three orthogonal axes.</p>
<p><strong>Interactive Visualization:</strong></p>
<p>We generate a cloud of 100 observations of <span class="math inline">\(y\)</span> from <span class="math inline">\(N(\mu, \sigma=1)\)</span> where <span class="math inline">\(\mu = (3,3,3)\)</span>, and project them onto the three axes representing these subspaces.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Generate Data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>) <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 100 points from trivariate normal</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Setup the Plot</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize with the original data to set the scene</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> df, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">z =</span> <span class="sc">~</span>z)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Draw the Original Data Points (The Cloud)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Using add_trace(type='scatter3d') explicitly to ensure visibility</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">opacity =</span> <span class="fl">0.8</span>), <span class="co"># High opacity to be visible</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'y (Data Cloud)'</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Draw Projections onto the 3 Axes</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Projection onto L(jn) -&gt; (x, 0, 0)</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="at">z =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">symbol =</span> <span class="st">'circle'</span>, <span class="at">opacity =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Proj onto L(jn)'</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Projection onto L(Xc) -&gt; (0, y, 0)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">z =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n),</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'green'</span>, <span class="at">symbol =</span> <span class="st">'circle'</span>, <span class="at">opacity =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Proj onto L(Xc)'</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Projection onto Col(X)^perp -&gt; (0, 0, z)</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="at">y =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="at">z =</span> <span class="sc">~</span>z,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">symbol =</span> <span class="st">'circle'</span>, <span class="at">opacity =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Proj onto Col(X)^perp'</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Draw the Mean Vector (mu) and its Projections</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean Vector: Origin to (3,3,3)</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, mu[<span class="dv">1</span>]), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, mu[<span class="dv">2</span>]), <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>, mu[<span class="dv">3</span>]),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">width =</span> <span class="dv">6</span>),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Mean Vector (mu)'</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Mu on L(jn): Origin to (3,0,0)</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, mu[<span class="dv">1</span>]), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">4</span>),</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Mu on L(jn)'</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Mu on L(Xc): Origin to (0,3,0)</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, mu[<span class="dv">2</span>]), <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'green'</span>, <span class="at">width =</span> <span class="dv">4</span>),</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Mu on L(Xc)'</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Mu on Col(X)^perp: Origin to (0,0,3)</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter3d'</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>, mu[<span class="dv">3</span>]),</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'red'</span>, <span class="at">width =</span> <span class="dv">4</span>),</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">'Mu on Col(X)^perp'</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Layout</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"L(j_n)"</span>),</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"L(X_c)"</span>),</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Col(X)^perp"</span>),</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">camera =</span> <span class="fu">list</span>(<span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fl">1.6</span>, <span class="at">y =</span> <span class="fl">1.6</span>, <span class="at">z =</span> <span class="fl">1.6</span>))</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Geometric Decomposition: Data Cloud &amp; Projections"</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-geometry-3d-projections" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-geometry-3d-projections-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-bbbdcf888a2a729dbcc9" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-bbbdcf888a2a729dbcc9">{"x":{"visdat":{"97de79e8daf0":["function () ","plotlyVisDat"]},"cur_data":"97de79e8daf0","attrs":{"97de79e8daf0":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":4,"color":"black","opacity":0.80000000000000004},"name":"y (Data Cloud)","inherit":true},"97de79e8daf0.1":{"x":{},"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":3,"color":"blue","symbol":"circle","opacity":0.5},"name":"Proj onto L(jn)","inherit":true},"97de79e8daf0.2":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":{},"z":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":3,"color":"green","symbol":"circle","opacity":0.5},"name":"Proj onto L(Xc)","inherit":true},"97de79e8daf0.3":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":3,"color":"red","symbol":"circle","opacity":0.5},"name":"Proj onto Col(X)^perp","inherit":true},"97de79e8daf0.4":{"x":[0,3],"y":[0,3],"z":[0,3],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"lines","line":{"color":"black","width":6},"name":"Mean Vector (mu)","inherit":true},"97de79e8daf0.5":{"x":[0,3],"y":[0,0],"z":[0,0],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"lines","line":{"color":"blue","width":4},"name":"Mu on L(jn)","inherit":true},"97de79e8daf0.6":{"x":[0,0],"y":[0,3],"z":[0,0],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"lines","line":{"color":"green","width":4},"name":"Mu on L(Xc)","inherit":true},"97de79e8daf0.7":{"x":[0,0],"y":[0,0],"z":[0,3],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"lines","line":{"color":"red","width":4},"name":"Mu on Col(X)^perp","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"L(j_n)"},"yaxis":{"title":"L(X_c)"},"zaxis":{"title":"Col(X)^perp"},"camera":{"eye":{"x":1.6000000000000001,"y":1.6000000000000001,"z":1.6000000000000001}}},"title":"Geometric Decomposition: Data Cloud & Projections","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5.1988103488837201,4.3124129764335102,2.7348549433036471,3.5431940592320892,2.5856600520811401,2.5237531053844218,2.2113971621497575,2.4053827325404891,4.6509074673366904,2.9459718749145596,3.119245236427584,3.2436874295990918,4.2324758784853378,2.48393616905522,2.0074928496079627,4.6756969324031896,2.5588367830947147,2.2769340300601262,1.7637268811167071,1.7152842776822035,2.4260265207020133,3.6179858171665282,4.1098481389297188,3.7075883538355878,2.6363427029047477,3.0597499373846007,2.2954035363199301,2.2827818384259899,3.8846504989769199,1.9844074213964555,4.9552939654924639,2.9096804060341483,3.2145388266292163,2.2614722952604267,2.4256113102367305,1.6829838676947582,2.8170746116272727,3.4189824049244639,3.32430434416138,2.2184635129452488,2.2113780291459983,2.4978012816571393,4.4960606698463508,1.862696379334255,2.8209484056198018,4.9023618216789266,2.8990251146711916,1.6401592961786062,2.3352305647259377,3.4854599789048781,2.6243971283302265,2.438123636450217,2.6560827658715409,3.0904966471392212,4.5985087711458261,2.911434887861116,4.080799496151517,3.6307541156505665,2.8863601044938592,1.4670979971094018,2.4788826824474799,2.5101295468615255,3.0471544327615274,4.3001986776668204,5.2930789738310935,4.5475810589837691,2.8668490356710556,1.2434726044423627,2.6112201359282565,3.0892072230732945,3.845013004067436,3.9625279684842711,3.6843094294164644,1.6047256502005327,3.8496430456333552,2.5534427835727778,3.1748027001612558,3.0745511771737344,3.4281667649705057,3.0246749828261401,1.3325249024143371,3.7364959647734421,3.386026568349676,2.7343483747217778,3.1181445110466806,3.1340386453684634,3.2210194685610021,4.6408461659774858,2.7809496210665241,3.1680653838846573,4.168383873069093,4.0541810233769189,4.1452631103803572,2.422531998940443,5.0024827302928294,3.0667008709301831,4.8668518447068623,1.6490973139692886,3.0209835863542374,4.2499145709692154],"y":[2.2895934363006991,3.2568837091565297,2.7533081215376263,2.652457400602267,2.0483814327349843,2.9549722751910799,2.2150955305429241,1.3320580634118633,2.6197734797122374,3.9189966090607662,2.4246530373916082,3.6079643222250333,1.382117291710836,2.9444380344754606,3.5194072039434623,3.3011533621667146,3.1056761941489435,2.3592939916946234,2.1502956539664178,1.9758712093950868,3.1176465971001259,2.0525253858151977,2.5094425562993314,2.7439078078017527,4.8438620052322072,2.3480500983045416,3.2353865722848569,3.077960849563711,2.0381433658698711,2.9286919138764014,4.4445508584233488,3.4515040530792147,3.0412329219929397,2.577503167660375,0.94675277845948447,4.1313372134141755,1.539359929075178,3.7399475108773346,4.9091035692174838,1.5561068390282007,3.7017843353747111,2.7378025105975321,1.4278558408545121,1.4853323462182486,1.3984638264254066,2.4690934778296971,1.5382444150041001,3.6879167729758278,5.1001089405256721,1.7129695239648208,3.7877388474751781,3.7690422410009101,3.3322025789501177,1.9916233917229922,2.8805473933693415,2.7196046648297534,3.5629895332204797,2.6275612438961709,3.9769733866856205,2.6254191422329862,4.0527114655793319,1.9508229933339341,1.7398447552418879,6.2410399349424051,2.5831424118395683,3.2982275915407153,3.6365696740338485,2.5162193742912566,3.5168620443136094,3.3689645273850859,2.7846194923583063,3.0652930335253155,2.9659327462615361,5.1284518990161807,2.2586639037271716,1.9040037329253361,3.0377883991710788,3.310480749443137,3.4365234789101828,2.5416346672888945,1.936673866028809,4.2631851760894897,2.6503496120464454,2.1344871373466257,2.7637204310589034,2.8028241056514478,4.1099202897136404,3.0847372921971963,3.7540537851845217,2.500707982827739,3.2144453095816012,2.6753140885091655,3.0945835281735716,2.1046366420224585,1.6891984666720281,4.9972133847479663,3.6007088236724174,1.7487286383750562,2.3888340833195794,1.8145199154026894],"z":[2.4395243534477875,2.76982251051672,4.5587083141491238,3.0705083914245761,3.129287735160946,4.7150649868832808,3.4609162059892022,1.7349387653934663,2.313147148106474,2.554338029900042,4.224081797439462,3.3598138270573639,3.4007714505940521,3.1106827159451198,2.444158865245925,4.7869131368030784,3.4978504782292394,1.0333828433703618,3.7013559015636854,2.527208592272066,1.9321762940131548,2.7820250853417048,1.9739955516927603,2.2711087707088602,2.3749607321507433,1.3133066892575866,3.8377870444945246,3.1533731178365154,1.8618630629880524,4.2538149210699263,3.4264642214768135,2.7049285170077288,3.8951256610450224,3.8781334875330424,3.8215810816374871,3.6886402541000911,3.5539176535375887,2.9380882894232783,2.6940373362600831,2.6195289989876174,2.3052930210794873,2.7920827219804014,1.7346036484317355,5.1689559653385126,4.2079619983049907,1.8768914167966504,2.5971151647009241,2.533344646376781,3.7799651183363179,2.9166309335281708,3.2533185139947549,2.9714532446512969,2.9571295427086839,4.3686022840144574,2.7742290143407322,4.5164706044295393,1.4512471957697788,3.5846137496360688,3.123854243844614,3.2159415687439727,3.3796394827598819,2.4976765468906978,2.66679261633058,1.9814246168929115,1.9282087735244227,3.3035286414042582,3.4482097786294261,3.0530042267305042,3.9222674678797373,5.0500846856271444,2.5089688339434648,0.69083112435918714,4.0057385244622568,2.2907992374176076,2.311991383532642,4.0255713696966993,2.7152269929489914,1.7792822877454646,3.1813034797491504,2.8611086375609553,3.0057641858998871,3.3852804011263307,2.6293399682075904,3.6443765485188333,2.7795134381812492,3.3317819639156969,4.0968390131493475,3.435181490833803,2.6740684144687732,4.1488076184510945,3.9935038559621194,3.5483969595080698,3.2387317351114411,2.3720939239606285,4.3606524485300078,2.3997404128528732,5.187332993016577,4.5326106261851891,2.7642996408995231,1.9735790996932194],"type":"scatter3d","mode":"markers","marker":{"color":"black","size":4,"opacity":0.80000000000000004,"line":{"color":"rgba(31,119,180,1)"}},"name":"y (Data Cloud)","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[5.1988103488837201,4.3124129764335102,2.7348549433036471,3.5431940592320892,2.5856600520811401,2.5237531053844218,2.2113971621497575,2.4053827325404891,4.6509074673366904,2.9459718749145596,3.119245236427584,3.2436874295990918,4.2324758784853378,2.48393616905522,2.0074928496079627,4.6756969324031896,2.5588367830947147,2.2769340300601262,1.7637268811167071,1.7152842776822035,2.4260265207020133,3.6179858171665282,4.1098481389297188,3.7075883538355878,2.6363427029047477,3.0597499373846007,2.2954035363199301,2.2827818384259899,3.8846504989769199,1.9844074213964555,4.9552939654924639,2.9096804060341483,3.2145388266292163,2.2614722952604267,2.4256113102367305,1.6829838676947582,2.8170746116272727,3.4189824049244639,3.32430434416138,2.2184635129452488,2.2113780291459983,2.4978012816571393,4.4960606698463508,1.862696379334255,2.8209484056198018,4.9023618216789266,2.8990251146711916,1.6401592961786062,2.3352305647259377,3.4854599789048781,2.6243971283302265,2.438123636450217,2.6560827658715409,3.0904966471392212,4.5985087711458261,2.911434887861116,4.080799496151517,3.6307541156505665,2.8863601044938592,1.4670979971094018,2.4788826824474799,2.5101295468615255,3.0471544327615274,4.3001986776668204,5.2930789738310935,4.5475810589837691,2.8668490356710556,1.2434726044423627,2.6112201359282565,3.0892072230732945,3.845013004067436,3.9625279684842711,3.6843094294164644,1.6047256502005327,3.8496430456333552,2.5534427835727778,3.1748027001612558,3.0745511771737344,3.4281667649705057,3.0246749828261401,1.3325249024143371,3.7364959647734421,3.386026568349676,2.7343483747217778,3.1181445110466806,3.1340386453684634,3.2210194685610021,4.6408461659774858,2.7809496210665241,3.1680653838846573,4.168383873069093,4.0541810233769189,4.1452631103803572,2.422531998940443,5.0024827302928294,3.0667008709301831,4.8668518447068623,1.6490973139692886,3.0209835863542374,4.2499145709692154],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":3,"symbol":"circle","opacity":0.5,"line":{"color":"rgba(255,127,14,1)"}},"name":"Proj onto L(jn)","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[2.2895934363006991,3.2568837091565297,2.7533081215376263,2.652457400602267,2.0483814327349843,2.9549722751910799,2.2150955305429241,1.3320580634118633,2.6197734797122374,3.9189966090607662,2.4246530373916082,3.6079643222250333,1.382117291710836,2.9444380344754606,3.5194072039434623,3.3011533621667146,3.1056761941489435,2.3592939916946234,2.1502956539664178,1.9758712093950868,3.1176465971001259,2.0525253858151977,2.5094425562993314,2.7439078078017527,4.8438620052322072,2.3480500983045416,3.2353865722848569,3.077960849563711,2.0381433658698711,2.9286919138764014,4.4445508584233488,3.4515040530792147,3.0412329219929397,2.577503167660375,0.94675277845948447,4.1313372134141755,1.539359929075178,3.7399475108773346,4.9091035692174838,1.5561068390282007,3.7017843353747111,2.7378025105975321,1.4278558408545121,1.4853323462182486,1.3984638264254066,2.4690934778296971,1.5382444150041001,3.6879167729758278,5.1001089405256721,1.7129695239648208,3.7877388474751781,3.7690422410009101,3.3322025789501177,1.9916233917229922,2.8805473933693415,2.7196046648297534,3.5629895332204797,2.6275612438961709,3.9769733866856205,2.6254191422329862,4.0527114655793319,1.9508229933339341,1.7398447552418879,6.2410399349424051,2.5831424118395683,3.2982275915407153,3.6365696740338485,2.5162193742912566,3.5168620443136094,3.3689645273850859,2.7846194923583063,3.0652930335253155,2.9659327462615361,5.1284518990161807,2.2586639037271716,1.9040037329253361,3.0377883991710788,3.310480749443137,3.4365234789101828,2.5416346672888945,1.936673866028809,4.2631851760894897,2.6503496120464454,2.1344871373466257,2.7637204310589034,2.8028241056514478,4.1099202897136404,3.0847372921971963,3.7540537851845217,2.500707982827739,3.2144453095816012,2.6753140885091655,3.0945835281735716,2.1046366420224585,1.6891984666720281,4.9972133847479663,3.6007088236724174,1.7487286383750562,2.3888340833195794,1.8145199154026894],"z":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter3d","mode":"markers","marker":{"color":"green","size":3,"symbol":"circle","opacity":0.5,"line":{"color":"rgba(44,160,44,1)"}},"name":"Proj onto L(Xc)","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":[2.4395243534477875,2.76982251051672,4.5587083141491238,3.0705083914245761,3.129287735160946,4.7150649868832808,3.4609162059892022,1.7349387653934663,2.313147148106474,2.554338029900042,4.224081797439462,3.3598138270573639,3.4007714505940521,3.1106827159451198,2.444158865245925,4.7869131368030784,3.4978504782292394,1.0333828433703618,3.7013559015636854,2.527208592272066,1.9321762940131548,2.7820250853417048,1.9739955516927603,2.2711087707088602,2.3749607321507433,1.3133066892575866,3.8377870444945246,3.1533731178365154,1.8618630629880524,4.2538149210699263,3.4264642214768135,2.7049285170077288,3.8951256610450224,3.8781334875330424,3.8215810816374871,3.6886402541000911,3.5539176535375887,2.9380882894232783,2.6940373362600831,2.6195289989876174,2.3052930210794873,2.7920827219804014,1.7346036484317355,5.1689559653385126,4.2079619983049907,1.8768914167966504,2.5971151647009241,2.533344646376781,3.7799651183363179,2.9166309335281708,3.2533185139947549,2.9714532446512969,2.9571295427086839,4.3686022840144574,2.7742290143407322,4.5164706044295393,1.4512471957697788,3.5846137496360688,3.123854243844614,3.2159415687439727,3.3796394827598819,2.4976765468906978,2.66679261633058,1.9814246168929115,1.9282087735244227,3.3035286414042582,3.4482097786294261,3.0530042267305042,3.9222674678797373,5.0500846856271444,2.5089688339434648,0.69083112435918714,4.0057385244622568,2.2907992374176076,2.311991383532642,4.0255713696966993,2.7152269929489914,1.7792822877454646,3.1813034797491504,2.8611086375609553,3.0057641858998871,3.3852804011263307,2.6293399682075904,3.6443765485188333,2.7795134381812492,3.3317819639156969,4.0968390131493475,3.435181490833803,2.6740684144687732,4.1488076184510945,3.9935038559621194,3.5483969595080698,3.2387317351114411,2.3720939239606285,4.3606524485300078,2.3997404128528732,5.187332993016577,4.5326106261851891,2.7642996408995231,1.9735790996932194],"type":"scatter3d","mode":"markers","marker":{"color":"red","size":3,"symbol":"circle","opacity":0.5,"line":{"color":"rgba(214,39,40,1)"}},"name":"Proj onto Col(X)^perp","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,3],"y":[0,3],"z":[0,3],"type":"scatter3d","mode":"lines","line":{"color":"black","width":6},"name":"Mean Vector (mu)","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,3],"y":[0,0],"z":[0,0],"type":"scatter3d","mode":"lines","line":{"color":"blue","width":4},"name":"Mu on L(jn)","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,0],"y":[0,3],"z":[0,0],"type":"scatter3d","mode":"lines","line":{"color":"green","width":4},"name":"Mu on L(Xc)","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,3],"type":"scatter3d","mode":"lines","line":{"color":"red","width":4},"name":"Mu on Col(X)^perp","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-geometry-3d-projections-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Geometric Decomposition: Data Cloud (Black) &amp; Projections (Colored)
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="coefficient-of-determination-r2" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="coefficient-of-determination-r2"><span class="header-section-number">5.9</span> Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</h2>
<p>The <span class="math inline">\(R^2\)</span> statistic measures the proportion of total variation explained by the regression model.</p>
<div id="def-r2" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.5 (R-Squared)</strong></span> <span class="math display">\[R^2 = \frac{\text{SSR}}{\text{SST}} = 1 - \frac{\text{SSE}}{\text{SST}}\]</span> Since <span class="math inline">\(0 \le \text{SSE} \le \text{SST}\)</span>, it follows that <span class="math inline">\(0 \le R^2 \le 1\)</span>.</p>
</div>
<p>In terms of the centered coefficients: <span class="math display">\[R^2 = \frac{\hat{\beta}_1' X_c' X_c \hat{\beta}_1}{\sum (y_i - \bar{y})^2}\]</span></p>
<section id="adjusted-r2-r2_a" class="level3" data-number="5.9.1">
<h3 data-number="5.9.1" class="anchored" data-anchor-id="adjusted-r2-r2_a"><span class="header-section-number">5.9.1</span> Adjusted <span class="math inline">\(R^2\)</span> (<span class="math inline">\(R^2_a\)</span>)</h3>
<p>Standard <span class="math inline">\(R^2\)</span> always increases (or stays the same) as predictors are added, regardless of their value. The Adjusted <span class="math inline">\(R^2\)</span> penalizes for model complexity.</p>
<div id="def-adj-r2" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.6 (Adjusted R-Squared)</strong></span> <span class="math display">\[R^2_a = 1 - \frac{\text{SSE} / (n - k - 1)}{\text{SST} / (n - 1)} = 1 - \frac{\text{MSE}}{s_y^2}\]</span> Relationship to <span class="math inline">\(R^2\)</span>: <span class="math display">\[R^2_a = 1 - (1 - R^2) \frac{n-1}{n-k-1}\]</span></p>
</div>
</section>
<section id="expected-value-of-r2" class="level3" data-number="5.9.2">
<h3 data-number="5.9.2" class="anchored" data-anchor-id="expected-value-of-r2"><span class="header-section-number">5.9.2</span> Expected Value of <span class="math inline">\(R^2\)</span></h3>
<p>If the true slope coefficients are zero (<span class="math inline">\(\beta_1 = \dots = \beta_k = 0\)</span>), the expected value of <span class="math inline">\(R^2\)</span> is not zero due to mathematical constraints.</p>
<div id="thm-r2-beta" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.9 (Exact Distribution of R-Squared)</strong></span> Under the null hypothesis where all slope coefficients are zero, <span class="math inline">\(R^2\)</span> follows a Beta distribution: <span class="math display">\[R^2 \sim \text{Beta}\left(\frac{k}{2}, \frac{n-k-1}{2}\right)\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Recall that <span class="math inline">\(R^2 = \frac{\text{SSR}}{\text{SSR} + \text{SSE}}\)</span>. Under the null hypothesis:</p>
<ol type="1">
<li><span class="math inline">\(\text{SSR}/\sigma^2 \sim \chi^2(k)\)</span>.</li>
<li><span class="math inline">\(\text{SSE}/\sigma^2 \sim \chi^2(n-k-1)\)</span>.</li>
<li><span class="math inline">\(\text{SSR}\)</span> and <span class="math inline">\(\text{SSE}\)</span> are independent.</li>
</ol>
<p>By the definition of the Beta distribution, if <span class="math inline">\(X \sim \chi^2(u)\)</span> and <span class="math inline">\(Y \sim \chi^2(v)\)</span> are independent, then the ratio <span class="math inline">\(\frac{X}{X+Y}\)</span> follows a <span class="math inline">\(\text{Beta}(\frac{u}{2}, \frac{v}{2})\)</span> distribution.</p>
</div>
<p><strong>Derivation of the Expected Value:</strong></p>
<p>Using the properties of the Beta distribution, the mean is given by <span class="math inline">\(E[R^2] = \frac{\alpha}{\alpha + \beta}\)</span>. Substituting the degrees of freedom <span class="math inline">\(\alpha = k/2\)</span> and <span class="math inline">\(\beta = (n-k-1)/2\)</span>:</p>
<p><span class="math display">\[
E[R^2] = \frac{k/2}{k/2 + (n-k-1)/2} = \frac{k}{n-1}
\]</span></p>
<p>Thus, even when there is no relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(X\)</span>, the expected <span class="math inline">\(R^2\)</span> is approximately <span class="math inline">\(k/(n-1)\)</span> rather than 0.</p>
<p>However, for the Adjusted <span class="math inline">\(R^2\)</span>, under the null hypothesis: <span class="math display">\[E[R^2_a] \approx 1 - \frac{\sigma^2}{\sigma^2} = 0\]</span></p>
<p>This property makes <span class="math inline">\(R^2_a\)</span> a more appropriate metric for comparing models with different numbers of predictors, as it accounts for “overfitting” by penalizing the degrees of freedom consumed by the model.</p>
</section>
</section>
<section id="underfitting-and-overfitting" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="underfitting-and-overfitting"><span class="header-section-number">5.10</span> Underfitting and Overfitting</h2>
<p>We consider the effects of omitting explanatory variables that should be included (underfitting) and including variables that should be excluded (overfitting).</p>
<p>Suppose the true model is: <span class="math display">\[y = X\beta + e = \begin{pmatrix} X_1 &amp; X_2 \end{pmatrix} \begin{pmatrix} \beta_1 \\ \beta_2 \end{pmatrix} + e = X_1\beta_1 + X_2\beta_2 + e \quad (\dagger)\]</span> where <span class="math inline">\(\text{Var}(e) = \sigma^2 I\)</span>.</p>
<ul>
<li><strong>Underfitting:</strong> Leaving out <span class="math inline">\(X_2\beta_2\)</span> when <span class="math inline">\(\beta_2 \neq 0\)</span>.</li>
<li><strong>Overfitting:</strong> Including <span class="math inline">\(X_2\beta_2\)</span> when <span class="math inline">\(\beta_2 = 0\)</span>.</li>
</ul>
<section id="underfitting" class="level3" data-number="5.10.1">
<h3 data-number="5.10.1" class="anchored" data-anchor-id="underfitting"><span class="header-section-number">5.10.1</span> Underfitting</h3>
<p>Suppose model <span class="math inline">\((\dagger)\)</span> holds, but we fit the reduced model: <span class="math display">\[y = X_1\beta_1^* + e^*\]</span> The OLS estimator for this reduced model is <span class="math inline">\(\hat{\beta}_1^* = (X_1^T X_1)^{-1}X_1^T y\)</span>.</p>
<div id="thm-underfitting" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.10 (Bias and Variance under Underfitting)</strong></span> If we fit the reduced model when the full model <span class="math inline">\((\dagger)\)</span> is true:</p>
<ol type="1">
<li><strong>Bias:</strong> <span class="math inline">\(E(\hat{\beta}_1^*) = \beta_1 + A\beta_2\)</span>, where <span class="math inline">\(A = (X_1^T X_1)^{-1}X_1^T X_2\)</span> is the alias matrix.</li>
<li><strong>Variance:</strong> <span class="math inline">\(\text{Var}(\hat{\beta}_1^*) = \sigma^2(X_1^T X_1)^{-1}\)</span>.</li>
</ol>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><strong>Part (i):</strong> <span class="math display">\[
\begin{aligned}
E(\hat{\beta}_1^*) &amp;= E[(X_1^T X_1)^{-1}X_1^T y] \\
&amp;= (X_1^T X_1)^{-1}X_1^T E(y) \\
&amp;= (X_1^T X_1)^{-1}X_1^T (X_1\beta_1 + X_2\beta_2) \\
&amp;= (X_1^T X_1)^{-1}X_1^T X_1\beta_1 + (X_1^T X_1)^{-1}X_1^T X_2\beta_2 \\
&amp;= \beta_1 + A\beta_2
\end{aligned}
\]</span> Thus, <span class="math inline">\(\hat{\beta}_1^*\)</span> is biased unless <span class="math inline">\(\beta_2 = 0\)</span> or <span class="math inline">\(X_1^T X_2 = 0\)</span> (orthogonal design).</p>
<p><strong>Part (ii):</strong> <span class="math display">\[
\begin{aligned}
\text{Var}(\hat{\beta}_1^*) &amp;= \text{Var}[(X_1^T X_1)^{-1}X_1^T y] \\
&amp;= (X_1^T X_1)^{-1}X_1^T [\sigma^2 I] X_1 (X_1^T X_1)^{-1} \\
&amp;= \sigma^2 (X_1^T X_1)^{-1}
\end{aligned}
\]</span> .</p>
</div>
</section>
<section id="overfitting" class="level3" data-number="5.10.2">
<h3 data-number="5.10.2" class="anchored" data-anchor-id="overfitting"><span class="header-section-number">5.10.2</span> Overfitting</h3>
<p>Suppose the reduced model <span class="math inline">\(y = X_1\beta_1^* + e\)</span> is true (i.e., <span class="math inline">\(\beta_2 = 0\)</span>), but we fit the full model <span class="math inline">\((\dagger)\)</span>. Since the full model includes the true model as a special case, the estimator <span class="math inline">\(\hat{\beta}\)</span> from the full model remains unbiased.</p>
<p>However, fitting the extraneous variables affects the variance.</p>
<div id="thm-overfitting" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5.11 (Variance Comparison)</strong></span> Let <span class="math inline">\(\hat{\beta}_1\)</span> be the estimator from the full model and <span class="math inline">\(\hat{\beta}_1^*\)</span> be the estimator from the reduced model. Then: <span class="math display">\[ \text{Var}(\hat{\beta}_1) - \text{Var}(\hat{\beta}_1^*) = \sigma^2 A B^{-1} A^T \]</span> where <span class="math inline">\(A = (X_1^T X_1)^{-1}X_1^T X_2\)</span> and <span class="math inline">\(B = X_2^T X_2 - X_2^T X_1 A\)</span>. Since <span class="math inline">\(A B^{-1} A^T\)</span> is positive semidefinite, <span class="math inline">\(\text{Var}(\hat{\beta}_1) \ge \text{Var}(\hat{\beta}_1^*)\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Using the inverse of a partitioned matrix, the top-left block of <span class="math inline">\((X^T X)^{-1}\)</span> corresponding to <span class="math inline">\(\beta_1\)</span> is: <span class="math display">\[ H^{11} = (X_1^T X_1)^{-1} + (X_1^T X_1)^{-1} X_1^T X_2 B^{-1} X_2^T X_1 (X_1^T X_1)^{-1} \]</span> Since <span class="math inline">\(\text{Var}(\hat{\beta}_1) = \sigma^2 H^{11}\)</span> and <span class="math inline">\(\text{Var}(\hat{\beta}_1^*) = \sigma^2 (X_1^T X_1)^{-1}\)</span>, the difference is the second term: <span class="math display">\[ \text{Var}(\hat{\beta}_1) - \text{Var}(\hat{\beta}_1^*) = \sigma^2 A B^{-1} A^T \]</span> .</p>
</div>
</section>
<section id="summary" class="level3" data-number="5.10.3">
<h3 data-number="5.10.3" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.10.3</span> Summary</h3>
<ol type="1">
<li><strong>Underfitting:</strong> Reduces variance but introduces bias (unless variables are orthogonal).</li>
<li><strong>Overfitting:</strong> Keeps estimators unbiased but increases variance.</li>
</ol>
<p>The goal of model selection is to balance these two errors, adhering to the principle of <strong>Occam’s Razor</strong>: “entities should not be multiplied beyond necessity”.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="./lec4-qf.html" class="pagination-link" aria-label="Distribution of Quadratic Forms">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribution of Quadratic Forms</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>