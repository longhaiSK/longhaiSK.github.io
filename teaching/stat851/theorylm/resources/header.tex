
% --- Fix Horizontal Rules (---) ---
% Save the original \rule command so we can still use it later
\let\oldrule\rule

% Redefine \rule to check if it's the specific one generated by Pandoc for '---'
\renewcommand{\rule}[2]{%
  % Check: Is the requested width exactly 50% of the line width?
  % (Pandoc converts markdown '---' to \rule{0.5\linewidth} by default)
  \ifdim#1=0.5\linewidth
    \hrule % If yes, replace it with a full-width horizontal rule
  \else
    \oldrule{#1}{#2} % If no, draw the rule exactly as requested originally
  \fi
}

% --- Force Equation Numbering ---
% Redefine standard display math \[ ... \] to use the numbered 'equation' environment
% This ensures $$...$$ in Markdown gets numbered in the PDF
\renewcommand{\[}{\begin{equation}}
\renewcommand{\]}{\end{equation}}

\usepackage[most]{tcolorbox}

% --- Color Definitions ---
% Theorem group (Theorem, Lemma, Corollary, Proposition)
\definecolor{thm-bg}{HTML}{F0F7FF}
\definecolor{thm-frame}{HTML}{CFE2FF}

% Definition
\definecolor{def-bg}{HTML}{F0FFF4}
\definecolor{def-frame}{HTML}{BADBCC}

% Example
\definecolor{ex-bg}{HTML}{FFFBF0}
\definecolor{ex-frame}{HTML}{FFEEBB}

% Proof
\definecolor{proof-bg}{HTML}{E2E3E5}
\definecolor{proof-frame}{HTML}{E2E3E5}

% Solution
\definecolor{sol-bg}{HTML}{F9F2F4}
\definecolor{sol-frame}{HTML}{D9534F}

% --- Box Environments ---

% Theorem
\tcolorboxenvironment{theorem}{
  colback=thm-bg,
  colframe=thm-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

\tcolorboxenvironment{algorithm}{
  colback=thm-bg,
  colframe=thm-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}


% Lemma
\tcolorboxenvironment{lemma}{
  colback=thm-bg,
  colframe=thm-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

% Corollary
\tcolorboxenvironment{corollary}{
  colback=thm-bg,
  colframe=thm-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

% Proposition
\tcolorboxenvironment{proposition}{
  colback=thm-bg,
  colframe=thm-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

% Definition
\tcolorboxenvironment{definition}{
  colback=def-bg,
  colframe=def-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

% Example
\tcolorboxenvironment{example}{
  colback=ex-bg,
  colframe=ex-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

% Proof
\tcolorboxenvironment{proof}{
  colback=proof-bg,
  colframe=proof-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}

% Solution
\tcolorboxenvironment{sol}{
  colback=sol-bg,
  colframe=sol-frame,
  boxrule=0pt,
  sharp corners,
  left=5pt, right=5pt,
  top=5pt, bottom=5pt,
  breakable
}
