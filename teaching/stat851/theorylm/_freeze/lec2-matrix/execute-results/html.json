{
  "hash": "faa174270be6fad41af671f4136c3d9c",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: \n  pdf: default\n  html: default\n---\n\n\n\n\n\n\n\n\n# Matrix Algebra\n\n\n\nThis chapter covers a review of matrix algebra concepts essential for linear models, including eigenvalues, spectral decomposition, singular value decomposition.\n\n\n\n## Eigenvalues and Eigenvectors\n\n::: {#def-eigen name=\"Eigenvalues and Eigenvectors\"}\n\nFor a square matrix $A$ ($n \\times n$), a scalar $\\lambda$ is an **eigenvalue** and a non-zero vector $x$ is the corresponding **eigenvector** if:\n\n$$\nAx = \\lambda x \\iff (A - \\lambda I_n)x = 0\n$$\n\nThe eigenvalues are found by solving the characteristic equation:\n$$\n|A - \\lambda I_n| = 0\n$$\n:::\n\n## Spectral Theory for Symmetric Matrices\n\n\n### Spectral Decomposition\n\nFor symmetric matrices, we have a powerful decomposition theorem.\n\n::: {#thm-spectral}\n### Spectral Decomposition\n\nIf $A$ is a symmetric $n \\times n$ matrix, all its eigenvalues $\\lambda_1, \\dots, \\lambda_n$ are real. Furthermore, there exists an orthogonal matrix $Q$ such that:\n\n$$\nA = Q \\Lambda Q' = \\sum_{i=1}^n \\lambda_i q_i q_i'\n$$\n\nwhere:\n\n* $\\Lambda = \\text{diag}(\\lambda_1, \\dots, \\lambda_n)$ contains the eigenvalues.\n* $Q = (q_1, \\dots, q_n)$ contains the corresponding orthonormal eigenvectors ($q_i'q_j = \\delta_{ij}$).\n:::\n\n**Explantion**: \nThis allows us to view the transformation $Ax$ as a rotation ($Q'$), a scaling ($\\Lambda$), and a rotation back ($Q$). For a symmetric matrix $A$, we can write the spectral decomposition as a product of the eigenvector matrix $Q$ and eigenvalue matrix $\\Lambda$:\n\n$$\n\\begin{aligned}\nA &= Q \\Lambda Q' \\\\\n  &= \\begin{pmatrix} q_1 & q_2 & \\cdots & q_n \\end{pmatrix} \n     \\begin{pmatrix} \\lambda_1 & 0 & \\cdots & 0 \\\\ 0 & \\lambda_2 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & \\lambda_n \\end{pmatrix} \n     \\begin{pmatrix} q_1' \\\\ q_2' \\\\ \\vdots \\\\ q_n' \\end{pmatrix} \\\\\n  &= \\begin{pmatrix} \\lambda_1 q_1 & \\lambda_2 q_2 & \\cdots & \\lambda_n q_n \\end{pmatrix} \n     \\begin{pmatrix} q_1' \\\\ q_2' \\\\ \\vdots \\\\ q_n' \\end{pmatrix} \\\\\n  &= \\lambda_1 q_1 q_1' + \\lambda_2 q_2 q_2' + \\cdots + \\lambda_n q_n q_n' \\\\\n  &= \\sum_{i=1}^n \\lambda_i q_i q_i'\n\\end{aligned}\n$$\n\nwhere the eigenvectors $q_i$ satisfy the orthogonality conditions:\n$$\nq_i' q_j = \\begin{cases} 1 & \\text{if } i=j \\\\ 0 & \\text{if } i \\ne j \\end{cases}\n$$\nAnd $Q$ is an orthogonal matrix: $Q'Q = Q Q' = I_n$.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(gridExtra) # For arranging plots side-by-side\n\n# --- 1. SETUP ---\n\n# Define a symmetric matrix that stretches and rotates\n# A = [ 3  1 ]\n#     [ 1  2 ]\nA <- matrix(c(3, 1, 1, 2), nrow = 2)\n\n# Get eigen decomposition\neig <- eigen(A)\nQ <- eig$vectors\nvals <- eig$values\n\n# --- 2. CREATE VECTORS (The \"Before\" state) ---\n\n# a. Specific vectors of interest\nv_e1 <- c(1, 0)\nv_e2 <- c(0, 1)\nv_q1 <- Q[,1] # Major eigenvector (associated with largest eigenvalue)\nv_q2 <- Q[,2] # Minor eigenvector\n\n# b. Filler vectors on the unit circle\n# Using angles that likely won't exactly overlap with the specific ones above\nangles_filler <- seq(pi/6, 2*pi, length.out = 7)[1:6]\nfillers <- lapply(angles_filler, function(th) c(cos(th), sin(th)))\n\n# c. Combine into a data frame\n# We label the types for coloring later\ndf_vecs <- data.frame(\n  x_orig = c(v_e1[1], v_e2[1], v_q1[1], v_q2[1], sapply(fillers, `[`, 1)),\n  y_orig = c(v_e1[2], v_e2[2], v_q1[2], v_q2[2], sapply(fillers, `[`, 2)),\n  type = c(\"Standard Axis\", \"Standard Axis\", \"Eigenvector\", \"Eigenvector\", \n           rep(\"Filler\", 6))\n)\n\n# --- 3. CALCULATE TRANSFORMATION (The \"After\" state) ---\n\n# Apply A to the original vectors: b = Ax\norig_matrix <- as.matrix(df_vecs[, c(\"x_orig\", \"y_orig\")])\ntrans_matrix <- t(A %*% t(orig_matrix))\n\ndf_vecs$x_trans <- trans_matrix[,1]\ndf_vecs$y_trans <- trans_matrix[,2]\n\n# Calculate slopes for eigenvector guidelines in Plot 2\nslope_q1 <- Q[2,1] / Q[1,1]\nslope_q2 <- Q[2,2] / Q[1,2]\n\n# Define colors for consistency\nmy_colors <- c(\"Standard Axis\" = \"#00ba38\", # Green\n               \"Eigenvector\" = \"#f8766d\",   # Red\n               \"Filler\" = \"#619cff\")        # Blue\n\n# --- 4. PLOTTING ---\n\n# Common theme settings\ncommon_theme <- theme_minimal() +\n  theme(\n    panel.grid.major = element_line(color = \"gray90\"),\n    panel.grid.minor = element_blank(),\n    legend.position = \"bottom\",\n    plot.title = element_text(hjust = 0.5, face=\"bold\")\n  )\n\n# Determine plot limits to keep scales identical\nmax_lim <- max(abs(c(df_vecs$x_trans, df_vecs$y_trans))) * 1.1\nxlims <- c(-max_lim, max_lim)\nylims <- c(-max_lim, max_lim)\n\n\n# ---- Plot 1: Before Transformation (Unit Circle) ----\np1 <- ggplot(df_vecs) +\n  # Background unit circle\n  annotate(\"path\",\n           x = cos(seq(0, 2*pi, length.out=100)),\n           y = sin(seq(0, 2*pi, length.out=100)),\n           color = \"gray70\", linetype = \"dotted\") +\n  # The vectors\n  geom_segment(aes(x=0, y=0, xend=x_orig, yend=y_orig, color=type), \n               arrow = arrow(length = unit(0.3, \"cm\")), size=1) +\n  scale_color_manual(values = my_colors) +\n  coord_fixed(xlim = xlims, ylim = ylims) +\n  labs(title = \"1. Before Transformation (x)\", \n       x = \"x1\", y = \"x2\") +\n  common_theme\n\n# ---- Plot 2: After Transformation (Oval) ----\np2 <- ggplot(df_vecs) +\n  # Background oval (transforming the dense circle path from p1)\n  annotate(\"path\",\n           x = (A %*% rbind(cos(seq(0,2*pi,100)), sin(seq(0,2*pi,100))))[1,],\n           y = (A %*% rbind(cos(seq(0,2*pi,100)), sin(seq(0,2*pi,100))))[2,],\n           color = \"gray70\", linetype = \"dotted\") +\n  \n  # Add INVARIANT LINES (dashed lines along original eigenvector directions)\n  geom_abline(intercept = 0, slope = slope_q1, linetype=\"dashed\", color=\"gray50\") +\n  geom_abline(intercept = 0, slope = slope_q2, linetype=\"dashed\", color=\"gray50\") +\n  \n  # The transformed vectors\n  geom_segment(aes(x=0, y=0, xend=x_trans, yend=y_trans, color=type), \n               arrow = arrow(length = unit(0.3, \"cm\")), size=1.2) +\n  scale_color_manual(values = my_colors) +\n  coord_fixed(xlim = xlims, ylim = ylims) +\n  labs(title = \"2. After Transformation (b = Ax)\", \n       x = \"b1\", y = \"b2\") +\n  common_theme\n\n# Arrange side-by-side\ngrid.arrange(p1, p2, ncol=2)\n```\n\n::: {.cell-output-display}\n![](lec2-matrix_files/figure-html/unnamed-chunk-1-1.png){width=576}\n:::\n:::\n\n\n\n\n\n\n\n\n### Quadratic Form\n:::{#def-quadratic-form}\n\nA **quadratic form** in $n$ variables $x_1, x_2, \\dots, x_n$ is a scalar function defined by a symmetric matrix $A$:\n$$\nQ(x) = x'Ax = \\sum_{i=1}^n \\sum_{j=1}^n a_{ij} x_i x_j\n$$\n:::\n\n### Positive and Non-Negative Definite Matrices\n\n:::{#def-pos-def name=\"Positive and Non-Negative Definite Matrices\"}\n\nA symmetric matrix $A$ is **positive definite (p.d.)** if:\n$$\nx'Ax > 0 \\quad \\forall x \\ne 0\n$$\nIt is **non-negative definite (n.n.d.)** if:\n$$\nx'Ax \\ge 0 \\quad \\forall x\n$$\n:::\n\n:::{#thm-nnd-properties name=\"Properties of Definite Matrices\"}\n\nLet $A$ be a symmetric $n \\times n$ matrix with eigenvalues $\\lambda_1, \\dots, \\lambda_n$.\n\n1.  **Eigenvalue Characterization:**\n    * $A$ is p.d. $\\iff$ all $\\lambda_i > 0$.\n    * $A$ is n.n.d. $\\iff$ all $\\lambda_i \\ge 0$.\n\n2.  **Determinant and Inverse:**\n    * If $A$ is p.d., then $|A| > 0$ and $A^{-1}$ exists.\n    * If $A$ is n.n.d. and singular, then $|A| = 0$ (at least one $\\lambda_i = 0$).\n\n3.  **Gram Matrices ($B'B$):**\n    Let $B$ be an $n \\times p$ matrix.\n\n    * If $\\text{rank}(B) = p$, then $B'B$ is p.d.\n    * If $\\text{rank}(B) < p$, then $B'B$ is n.n.d.\n:::\n\n### Properties of Symmetric Matrices\n:::{#thm-symmetric-properties name=\"Properties of Symmetric Matrices\"}\nLet $A$ be a symmetric matrix with spectral decomposition $A = Q \\Lambda Q'$. The following properties hold:\n\n1.  **Trace:** $\\text{tr}(A) = \\sum \\lambda_i$.\n2.  **Determinant:** $|A| = \\prod \\lambda_i$.\n3.  **Singularity:** $A$ is singular if and only if at least one $\\lambda_i = 0$.\n4.  **Inverse:** If $A$ is non-singular ($\\lambda_i \\ne 0$), then $A^{-1} = Q \\Lambda^{-1} Q'$.\n5.  **Powers:** $A^k = Q \\Lambda^k Q'$.\n    * *Square Root:* $A^{1/2} = Q \\Lambda^{1/2} Q'$ (if $\\lambda_i \\ge 0$).\n6.  **Spectral Representation of Quadratic Forms:** The quadratic form $x'Ax$ can be diagonalized using the eigenvectors of $A$:\n    $$\n    x'Ax = x' Q \\Lambda Q' x = y' \\Lambda y = \\sum_{i=1}^n \\lambda_i y_i^2\n    $$\n    where $y = Q'x$ represents a rotation of the coordinate system.\n:::\n\n### Spectral Representation of Projection Matrices \n\nWe revisit projection matrices in the context of eigenvalues.\n\n::: {#thm-proj-eigen name=\"Eigenvalues of Projection Matrices\"}\n\nA symmetric matrix $P$ is a projection matrix (idempotent, $P^2=P$) if and only if its eigenvalues are either 0 or 1.\n\n$$\nP^2 x = \\lambda^2 x \\quad \\text{and} \\quad Px = \\lambda x \\implies \\lambda^2 = \\lambda \\implies \\lambda \\in \\{0, 1\\}\n$$\n:::\n\nFor a projection matrix $P$:\n\n* If $x \\in \\text{Col}(P)$, $Px = x$ (Eigenvalue 1).\n* If $x \\perp \\text{Col}(P)$, $Px = 0$ (Eigenvalue 0).\n* $\\text{rank}(P) = \\text{tr}(P) = \\sum \\lambda_i$ (Count of 1s).\n\n::: {#exm-trace-P}\nFor $P = \\frac{1}{n} J_n J_n'$, the rank is $\\text{tr}(P) = 1$.\n:::\n\n\n## Singular Value Decomposition (SVD)\n\n:::{#thm-svd name=\"Singular Value Decomposition (SVD)\"}\n\nLet $X$ be an $n \\times p$ matrix with rank $r \\le \\min(n, p)$. $X$ can be decomposed into the product of three matrices:\n\n$$\nX = U \\mathbf{D} V'\n$$\n\n**1. Partitioned Matrix Form**\n\n$$\nX = \\underset{n \\times n}{(U_1, U_2)}\n\\begin{pmatrix}\n\\Lambda_r & O_{r \\times (p-r)} \\\\\nO_{(n-r) \\times r} & O_{(n-r) \\times (p-r)}\n\\end{pmatrix}\n\\underset{p \\times p}{\n\\begin{pmatrix}\nV_1' \\\\\nV_2'\n\\end{pmatrix}\n}\n$$\n\n**2. Detailed Matrix Form**\n\nExpanding the diagonal matrix explicitly:\n\n$$\nX = \\underset{n \\times n}{(u_1, \\dots, u_n)}\n\\left(\n\\begin{array}{cccc|c}\n\\lambda_1 & 0 & \\dots & 0 &  \\\\\n0 & \\lambda_2 & \\dots & 0 & O_{12} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots &  \\\\\n0 & 0 & \\dots & \\lambda_r &  \\\\\n\\hline\n & O_{21} & & & O_{22}\n\\end{array}\n\\right)\n\\underset{p \\times p}{\n\\begin{pmatrix}\nv_1' \\\\\n\\vdots \\\\\nv_p'\n\\end{pmatrix}\n}\n$$\n\n**3. Reduced Form**\n\n$$\nX = U_1 \\Lambda_r V_1' = \\sum_{i=1}^r \\lambda_i u_i v_i'\n$$\n\n**Properties:**\n\n1.  **Singular Values ($\\Lambda_r$):** $\\Lambda_r = \\text{diag}(\\lambda_1, \\dots, \\lambda_r)$ contains the singular values ($\\lambda_i > 0$), which are the square roots of the non-zero eigenvalues of $X'X$.\n2.  **Orthogonality:**\n    * $U$ is $n \\times n$ orthogonal ($U'U = I_n$).\n    * $V$ is $p \\times p$ orthogonal ($V'V = I_p$).\n:::\n\n#### Connection to Gram Matrices\n\nThe matrices $U$ and $V$ provide the basis vectors (eigenvectors) for the Gram matrices of $X$.\n\n1.  **Right Singular Vectors ($V$):**\n    The columns of $V$ are the eigenvectors of the Gram matrix $X'X$.\n    $$\n    X'X = (U \\Lambda V')' (U \\Lambda V') = V \\Lambda U' U \\Lambda V' = V \\Lambda^2 V'\n    $$\n\n    * The eigenvalues of $X'X$ are the squared singular values $\\lambda_i^2$.\n\n2.  **Left Singular Vectors ($U$):**\n    The columns of $U$ are the eigenvectors of the Gram matrix $XX'$.\n    $$\n    XX' = (U \\Lambda V') (U \\Lambda V')' = U \\Lambda V' V \\Lambda U' = U \\Lambda^2 U'\n    $$\n\n    * The eigenvalues of $XX'$ are also $\\lambda_i^2$ (for non-zero values).\n\n#### Numerical Example\n\nConsider the matrix $X = \\begin{pmatrix} 1 & 1 \\\\ 2 & 2 \\end{pmatrix}$.\n\n1.  **Compute $X'X$ and find $V$:**\n    $$\n    X'X = \\begin{pmatrix} 1 & 2 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 2 & 2 \\end{pmatrix} = \\begin{pmatrix} 5 & 5 \\\\ 5 & 5 \\end{pmatrix}\n    $$\n\n    * Eigenvalues of $X'X$: Trace is 10, Determinant is 0. Thus, $\\mu_1 = 10, \\mu_2 = 0$.\n    * **Singular Values:** $\\lambda_1 = \\sqrt{10}, \\lambda_2 = 0$.\n    * Eigenvector for $\\mu_1=10$: Normalized $v_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n    * Eigenvector for $\\mu_2=0$: Normalized $v_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n    * Therefore, $V = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$.\n\n2.  **Compute $XX'$ and find $U$:**\n    $$\n    XX' = \\begin{pmatrix} 1 & 1 \\\\ 2 & 2 \\end{pmatrix} \\begin{pmatrix} 1 & 2 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} 2 & 4 \\\\ 4 & 8 \\end{pmatrix}\n    $$\n\n    * Eigenvalues are again 10 and 0.\n    * Eigenvector for $\\mu_1=10$: Normalized $u_1 = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$.\n    * Eigenvector for $\\mu_2=0$: Normalized $u_2 = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$.\n    * Therefore, $U = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & 2 \\\\ 2 & -1 \\end{pmatrix}$.\n\n3.  **Verification:**\n    $$\n    X = \\sqrt{10} u_1 v_1' = \\sqrt{10} \\begin{pmatrix} \\frac{1}{\\sqrt{5}} \\\\ \\frac{2}{\\sqrt{5}} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 2 & 2 \\end{pmatrix}\n    $$\n\n## Cholesky Decomposition\n\nA symmetric matrix $A$ has a Cholesky decomposition if and only if it is **non-negative definite** (i.e., $x'Ax \\ge 0$ for all $x$).\n\n$$\nA = B'B\n$$\n\nwhere $B$ is an **upper triangular** matrix with non-negative diagonal entries.\n\n### Matrix Representation of the Algorithm\n\nTo derive the algorithm, we equate the elements of $A$ with the product of the lower triangular matrix $B'$ and the upper triangular matrix $B$.\n\nFor a $3 \\times 3$ matrix, this looks like:\n\n$$\n\\underbrace{\\begin{pmatrix}\na_{11} & a_{12} & a_{13} \\\\\na_{21} & a_{22} & a_{23} \\\\\na_{31} & a_{32} & a_{33}\n\\end{pmatrix}}_{A}\n=\n\\underbrace{\\begin{pmatrix}\nb_{11} & 0 & 0 \\\\\nb_{12} & b_{22} & 0 \\\\\nb_{13} & b_{23} & b_{33}\n\\end{pmatrix}}_{B'}\n\\underbrace{\\begin{pmatrix}\nb_{11} & b_{12} & b_{13} \\\\\n0 & b_{22} & b_{23} \\\\\n0 & 0 & b_{33}\n\\end{pmatrix}}_{B}\n$$\n\nMultiplying the matrices on the right yields the system of equations:\n\n$$\nA = \\begin{pmatrix}\n\\mathbf{b_{11}^2} & b_{11}b_{12} & b_{11}b_{13} \\\\\nb_{12}b_{11} & \\mathbf{b_{12}^2 + b_{22}^2} & b_{12}b_{13} + b_{22}b_{23} \\\\\nb_{13}b_{11} & b_{13}b_{12} + b_{23}b_{22} & \\mathbf{b_{13}^2 + b_{23}^2 + b_{33}^2}\n\\end{pmatrix}\n$$\n\nBy solving for the bolded diagonal terms and substituting known values from previous rows, we get the recursive algorithm.\n\n### The Algorithm\n\n1.  **Row 1:** Solve for $b_{11}$ using $a_{11}$, then solve the rest of the row ($b_{1j}$) by division.\n    * $b_{11} = \\sqrt{a_{11}}$\n    * $b_{1j} = a_{1j}/b_{11}$\n\n2.  **Row 2:** Solve for $b_{22}$ using $a_{22}$ and the known $b_{12}$, then solve $b_{2j}$.\n    * $b_{22} = \\sqrt{a_{22} - b_{12}^2}$\n    * $b_{2j} = (a_{2j} - b_{12}b_{1j}) / b_{22}$\n\n3.  **Row 3:** Solve for $b_{33}$ using $a_{33}$ and the known $b_{13}, b_{23}$.\n    * $b_{33} = \\sqrt{a_{33} - b_{13}^2 - b_{23}^2}$\n\n### Numerical Example\n\nConsider the positive definite matrix $A$:\n$$\nA = \\begin{pmatrix}\n4 & 2 & -2 \\\\\n2 & 10 & 2 \\\\\n-2 & 2 & 6\n\\end{pmatrix}\n$$\n\nWe find $B$ such that $A = B'B$:\n\n1.  **First Row of B ($b_{11}, b_{12}, b_{13}$):**\n    * $b_{11} = \\sqrt{4} = 2$\n    * $b_{12} = 2 / 2 = 1$\n    * $b_{13} = -2 / 2 = -1$\n\n2.  **Second Row of B ($b_{22}, b_{23}$):**\n    * $b_{22} = \\sqrt{10 - (1)^2} = \\sqrt{9} = 3$\n    * $b_{23} = (2 - (1)(-1)) / 3 = 3/3 = 1$\n\n3.  **Third Row of B ($b_{33}$):**\n    * $b_{33} = \\sqrt{6 - (-1)^2 - (1)^2} = \\sqrt{4} = 2$\n\n**Result:**\n$$\nB = \\begin{pmatrix}\n2 & 1 & -1 \\\\\n0 & 3 & 1 \\\\\n0 & 0 & 2\n\\end{pmatrix}\n$$\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}